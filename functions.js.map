{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://excel-custom-functions/./src/functions/URLFetchApp.ts","webpack://excel-custom-functions/./src/functions/gdrive-functions.ts","webpack://excel-custom-functions/./src/functions/sas.ts","webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/webpack/runtime/define property getters","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions/./src/functions/functions.ts"],"sourcesContent":["export class UrlFetchApp {\r\n    static async fetch(url, options = undefined) {\r\n        try {\r\n          /*if(options == null || !options) {\r\n            options = { \r\n              \"headers\": {\r\n                \"referer\": \"https://alphaapi.sasonline.in\"\r\n              },\r\n              \"mode\": \"no-cors\",\r\n              \"method\": \"GET\"\r\n            }\r\n          }*/\r\n          const response = options ? await fetch(url, options) : await fetch(url);\r\n          /*if (!response.ok) {\r\n            throw new Error(`Response status: ${response.status}`);\r\n          }*/\r\n          const json = await response.json();\r\n          console.log(json);\r\n          return json;\r\n        } catch (error) {\r\n          console.error(error.message);\r\n        }\r\n      }\r\n    static getParameterByName(name, url = window.location.href) {\r\n        name = name.replace(/[\\[\\]]/g, '\\\\$&');\r\n        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\r\n            results = regex.exec(url);\r\n        if (!results) return null;\r\n        if (!results[2]) return '';\r\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n    }\r\n}","function Run() {\r\n  //https://www.nseindia.com/api/option-chain-indices?symbol=NIFTY\r\n  //var url = \"https://www.nseindia.com/api/option-chain-indices?symbol=BANKNIFTY\";\r\n  //var refererUrl = \"https://www.nseindia.com/get-quotes/derivatives?symbol=NIFTY\"\r\n  //GetOptionChainData(url, refererUrl)\r\n\r\n}\r\n\r\nfunction onlyUnique(value, index, array) {\r\n  return array.indexOf(value) === index;\r\n}\r\n\r\nexport function flattenJson(data: (number|string|boolean)[]) {\r\n  var result: (number|string|boolean)[][] = [];\r\n  if (!Array.isArray(data) || data.length === 0) {\r\n    return result;//\"Input data is not a valid non-empty array\";\r\n  }\r\n  // Getting the union of all keys in the data array objects to ensure we cover all fields\r\n  var headersToRemove = []\r\n  let setOfHeaders = new Set(data.flatMap(item => {\r\n    var tempHeaders = Object.keys(item);\r\n    var additionalHeaders = []\r\n    tempHeaders.forEach(key => {\r\n      if (item[key] != null && item[key] != undefined && typeof (item[key]) == \"object\" && !Array.isArray(item[key]))\r\n        var setOfSubKeys = Object.keys(item[key])\r\n      if (setOfSubKeys != undefined) {\r\n        headersToRemove.push(key)\r\n        additionalHeaders.push(...setOfSubKeys.flatMap(subItem => [key + \".\" + subItem]))\r\n      }\r\n    });\r\n    tempHeaders.push(...additionalHeaders)\r\n    return tempHeaders;\r\n  }));\r\n  var headers: (string)[] = [];\r\n  setOfHeaders.forEach((header) => headers.push(header));\r\n\r\n  var uniqueHeadersToRemove = headersToRemove.filter(onlyUnique);\r\n  headers = headers.filter((val) => uniqueHeadersToRemove.indexOf(val) == -1 && !val.endsWith(\"?\"))\r\n  result.push(headers);\r\n  data.forEach(function (row) {\r\n    if (Array.isArray(row))\r\n      result.push(row)\r\n    else {\r\n      var rowData: (number|string|boolean)[] = [];\r\n      headers.forEach(function (header) {\r\n        var val = row[header]\r\n        rowData.push(val === undefined ? \"\" : val)\r\n      });\r\n      result.push(rowData);\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n\r\nexport function flattenJsonObj(obj) {\r\n  var result: (string | number | boolean)[][] = [];\r\n  if (Array.isArray(obj) || obj.length > 0) {\r\n    return result;//\"Array is not allowed\";\r\n  }\r\n  // Getting the union of all keys in the data array objects to ensure we cover all fields\r\n  var headers = [...Object.keys(obj)];\r\n\r\n  result.push(headers);\r\n\r\n  var rowData = [];\r\n  headers.forEach(function (header) {\r\n    if (Array.isArray(obj[header]) && obj[header].length > 0)\r\n      rowData.push(obj[header] === undefined ? \"\" : obj[header].join(\", \"));\r\n    else\r\n      rowData.push(obj[header] === undefined ? \"\" : obj[header]);\r\n  });\r\n  result.push(rowData);\r\n\r\n  return result;\r\n}\r\n\r\n/* ==================================================\r\n  The cumulative Normal distribution function: */\r\n\r\nfunction xlfNormSDist(x) {\r\n\r\n  // constants\r\n  var a = 0.2316419;\r\n  var a1 = 0.31938153;\r\n  var a2 = -0.356563782;\r\n  var a3 = 1.781477937;\r\n  var a4 = -1.821255978;\r\n  var a5 = 1.330274429;\r\n\r\n  if (x < 0.0)\r\n    return 1 - xlfNormSDist(-x);\r\n  else\r\n    var k = 1.0 / (1.0 + a * x);\r\n  return 1.0 - Math.exp(-x * x / 2.0) / Math.sqrt(2 * Math.PI) * k\r\n    * (a1 + k * (a2 + k * (a3 + k * (a4 + k * a5))));\r\n}\r\n\r\n\r\n/* ================================================== */\r\n/* The Normal distribution probability density function (PDF)\r\n   for the specified mean and specified standard deviation: */\r\nfunction xlfNormalPDF1a(x, mu, sigma) {\r\n  var num = Math.exp(-Math.pow((x - mu), 2) / (2 * Math.pow(sigma, 2)))\r\n  var denom = sigma * Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\nfunction xlfNormalPDF1b(x, mu, sigma) {\r\n  var num = Math.exp(- 1 / 2 * Math.pow((x - mu) / sigma, 2))\r\n  var denom = sigma * Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\n/* ================================================== */\r\n/* The Normal distribution probability density function (PDF)\r\n   for the standard normal distribution: */\r\nfunction xlfNormalSdistPDF(x) {\r\n  var num = Math.exp(-1 / 2 * x * x)\r\n  var denom = Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\nfunction d1(UP, SP, T, r, V, D) {\r\n  return (Math.log(UP / SP) + (r - D + 0.5 * V ^ 2) * T) / (V * (Math.sqrt(T)))\r\n}\r\nfunction Nd1(UP, SP, T, r, V, D) {\r\n  return Math.exp(-(d1(UP, SP, T, r, V, D) ^ 2) / 2) / (Math.sqrt(2 * Math.PI))\r\n}\r\nfunction d2(UP, SP, T, r, V, D) {\r\n  return d1(UP, SP, T, r, V, D) - V * Math.sqrt(T)\r\n}\r\nfunction Nd2(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d2(UP, SP, T, r, V, D))\r\n}\r\nfunction CallPrice(UP, SP, T, r, V, D) {\r\n  return Math.exp(-D * T) * UP * xlfNormSDist(d1(UP, SP, T, r, V, D)) - SP * Math.exp(-r * T) * xlfNormSDist(d1(UP, SP, T, r, V, D) - V * Math.sqrt(T))\r\n}\r\nfunction PutPrice(UP, SP, T, r, V, D) {\r\n  return SP * Math.exp(-r * T) * xlfNormSDist(-d2(UP, SP, T, r, V, D)) - Math.exp(-D * T) * UP * xlfNormSDist(-d1(UP, SP, T, r, V, D))\r\n}\r\nfunction CallDelta(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d1(UP, SP, T, r, V, D))\r\n}\r\nfunction PutDelta(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d1(UP, SP, T, r, V, D)) - 1\r\n}\r\nfunction CallTheta(UP, SP, T, r, V, D) {\r\n  var CT = -((UP * V * Nd1(UP, SP, T, r, V, D)) / (2 * Math.sqrt(T)) - r * SP * Math.exp(-r * (T)) * Nd2(UP, SP, T, r, V, D))\r\n  return CT / 365\r\n}\r\nfunction OptionGamma(UP, SP, T, r, V, D) {\r\n  return Nd1(UP, SP, T, r, V, D) / (UP * (V * Math.sqrt(T)))\r\n}\r\nfunction OptionVega(UP, SP, T, r, V, D) {\r\n  return 0.01 * UP * Math.sqrt(T) * Nd1(UP, SP, T, r, V, D)\r\n}\r\nfunction PutTheta(UP, SP, T, r, V, D) {\r\n  var PT = -(UP * V * Nd1(UP, SP, T, r, V, D)) / (2 * Math.sqrt(T)) + r * SP * Math.exp(-r * (T)) * (1 - Nd2(UP, SP, T, r, V, D))\r\n  return PT / 365\r\n}\r\nfunction CallRho(UP, SP, T, r, V, D) {\r\n  return 0.01 * SP * T * Math.exp(-r * T) * xlfNormSDist(d2(UP, SP, T, r, V, D))\r\n}\r\nfunction PutRho(UP, SP, T, r, V, D) {\r\n  return -0.01 * SP * T * Math.exp(-r * T) * (1 - xlfNormSDist(d2(UP, SP, T, r, V, D)))\r\n}\r\nfunction CallIV(UP, SP, T, r, MP, D) {\r\n  let Mx = 5\r\n  let Mn = 0\r\n  while ((Mx - Mn) > 0.0001) {\r\n    if (CallPrice(UP, SP, T, r, (Mx + Mn) / 2, D) > MP)\r\n      Mx = (Mx + Mn) / 2\r\n    else\r\n      Mn = (Mx + Mn) / 2\r\n  }\r\n  return (Mx + Mn) / 2\r\n}\r\nfunction PutIV(UP, SP, T, r, MP, D) {\r\n  let Mx = 5\r\n  let Mn = 0\r\n  while ((Mx - Mn) > 0.0001) {\r\n    if (PutPrice(UP, SP, T, r, (Mx + Mn) / 2, D) > MP)\r\n      Mx = (Mx + Mn) / 2\r\n    else\r\n      Mn = (Mx + Mn) / 2\r\n  }\r\n  return (Mx + Mn) / 2\r\n}","\r\n/**\r\n * {\"exchange\":1,\"instrumentToken\":10576,\"ltp\":28271,\"change\":517,\"ltt\":1726136877,\"lowDpr\":22337,\"highDpr\":33506,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":28271,\"ltq\":50,\"timestamp\":1726166851502,\"topic\":\"CompactMarketDataMessage/1/10576\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26000,\"ltp\":2538890,\"change\":47045,\"ltt\":1726145773,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851504,\"topic\":\"CompactMarketDataMessage/1/26000\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26008,\"ltp\":4315210,\"change\":67885,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851505,\"topic\":\"CompactMarketDataMessage/1/26008\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26009,\"ltp\":5177240,\"change\":76240,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851506,\"topic\":\"CompactMarketDataMessage/1/26009\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26013,\"ltp\":7544635,\"change\":109110,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851509,\"topic\":\"CompactMarketDataMessage/1/26013\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26023,\"ltp\":2342960,\"change\":20920,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851509,\"topic\":\"CompactMarketDataMessage/1/26023\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26037,\"ltp\":2394560,\"change\":36310,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851510,\"topic\":\"CompactMarketDataMessage/1/26037\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26074,\"ltp\":1327525,\"change\":15855,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851511,\"topic\":\"CompactMarketDataMessage/1/26074\"}\r\nsas.ts:218 {\"exchange\":6,\"instrumentToken\":1,\"ltp\":8296271,\"change\":143955,\"ltt\":1726144933,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851511,\"topic\":\"CompactMarketDataMessage/6/1\"}\r\n */\r\nDataView.prototype[\"getString\"] = function (e, t) {\r\n    for (var a = \"number\" == typeof t ? e + t : this.byteLength, n = \"\", r = -1; e < this.byteLength && e < a && 0 != (r = this.getUint8(e++));)\r\n        n += String.fromCharCode(r);\r\n    return n\r\n}\r\nDataView.prototype[\"getInt64\"] = function (e) {\r\n    var t = this.getUint32(e)\r\n        , a = this.getUint32(e + 4)\r\n        , n = Math.pow(2, 32) * t + a;\r\n    return Number.isSafeInteger(n) ? n : (console.warn(n, \"exceeds MAX_SAFE_INTEGER. Precision may be lost\"),\r\n        -1)\r\n}\r\n//Override getBigInt64 as BigInt can not be serialized by JSON.stringify\r\nvar native_getBigInt64 = DataView.prototype.getBigInt64\r\nDataView.prototype.getBigInt64 = function (e) {\r\n    return native_getBigInt64.call(this, e).toString();\r\n}\r\nvar __exchange_codes = {\r\n    'NSE': 1,\r\n    'NFO': 2,\r\n    'CDS': 3,\r\n    'MCX': 4,\r\n    'BSE': 6,\r\n    'BFO': 7\r\n}\r\nvar __exchange_price_multipliers = {\r\n    1: 100,\r\n    2: 100,\r\n    3: 10000000,\r\n    4: 100,\r\n    6: 100,\r\n    7: 100\r\n}\r\nexport function btnCopyToClipboardHandler(containerid) {\r\n    const text = document.getElementById(containerid).innerText;\r\n\r\n    if (navigator.clipboard) {\r\n        navigator.clipboard.writeText(text).then(() => {\r\n            alert('Text copied to clipboard');\r\n        }).catch(err => {\r\n            alert(err);\r\n        });\r\n    } else {\r\n        // Fallback for older browsers that don't support the Clipboard API\r\n        fallbackCopyText(text);\r\n    }\r\n}\r\n\r\n// Fallback function using document.execCommand for older browsers\r\nfunction fallbackCopyText(text) {\r\n    const textArea = document.createElement('textarea');\r\n    textArea.value = text;\r\n    document.body.appendChild(textArea);\r\n    textArea.select();\r\n\r\n    try {\r\n        document.execCommand('copy');\r\n        alert('Text copied to clipboard');\r\n    } catch (err) {\r\n        alert(err);\r\n    }\r\n\r\n    document.body.removeChild(textArea);\r\n}\r\nfunction btnCopyToClipboardHandlerOld(containerid) {\r\n    if (document[\"selection\"]) { // IE\r\n        var range = document.body[\"createTextRange\"]();\r\n        range.moveToElementText(document.getElementById(containerid));\r\n        range.select();\r\n    } else if (window.getSelection) {\r\n        var range = document.createRange();\r\n        range.selectNode(document.getElementById(containerid));\r\n        window.getSelection().removeAllRanges();\r\n        window.getSelection().addRange(range);\r\n        document.execCommand(\"copy\");\r\n    }\r\n    //alert(\"Text has been copied\")\r\n}\r\n\r\nfunction getYYYYMMDD() {\r\n    return (new Date()).toISOString().split('T')[0].replace(\"-\", \"\").replace(\"-\", \"\");\r\n}\r\n\r\nexport function btnSaveToFileClickHandler(containerid) {\r\n    const text = document.getElementById(containerid).innerText;\r\n    const strDate = getYYYYMMDD()\r\n    const blob = new Blob([text], { type: 'text/plain' });\r\n    const url = window.URL.createObjectURL(blob);\r\n\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'SocketData ' + strDate + '.json'; // File name to save as\r\n    a.click();\r\n\r\n    // Clean up\r\n    window.URL.revokeObjectURL(url);\r\n}\r\nasync function btnSaveToFileClickHandlerOld(containerid) {\r\n    var divJson = document.getElementById(containerid)\r\n    var strDate = getYYYYMMDD()\r\n    const options = {\r\n        suggestedName: 'SocketData ' + strDate + '.json',\r\n        types: [\r\n            {\r\n                description: 'Json File',\r\n                accept: {\r\n                    'application/json': ['.json'],\r\n                },\r\n            },\r\n        ],\r\n    };\r\n\r\n    try {\r\n        const fileHandler = await window[\"showSaveFilePicker\"](options);\r\n        const file = await fileHandler.createWritable();\r\n        await file.write(divJson.innerText);\r\n        await file.close();\r\n    } catch (err) {\r\n        if (err.name !== 'AbortError') {\r\n            console.error('Error:', err);\r\n        }\r\n    }\r\n}\r\n\r\nexport function getSymbolJsonToSubscribe(exchange, token): any {\r\n    return { \"a\": \"subscribe\", \"v\": [[exchange, token]], \"m\": \"compact_marketdata\" };\r\n}\r\n\r\nexport function SASSocket(args: { host: string, path: string, loginId: string }) {\r\n    this.args = args;//arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\r\n    //Object(zt.a)(this, e);\r\n    var protocol = \"https:\" === window.location.protocol ? \"wss\" : \"ws\";\r\n    //this.uri = \"wss://alpha.sasonline.in/ws/v1/feeds?login_id=AG187&token=\".concat(token, \"&device=web\");\r\n    //this.uri = \"\".concat(protocol, \"://\").concat(host).concat(path, \"?login_id=\").concat(loginId, \"&token=\").concat(token, \"&device=web\"),\r\n    this.container = document.getElementById(\"divContainer\");\r\n    this.uri = \"\"\r\n    this._socket = null\r\n    this._reconnectionTimeout = 0\r\n    this._lastConnectedTimestamp = Date.now()\r\n    this._topics = {}\r\n    this.Gt = JSON.parse('{\"DetailMarketDataMessage\":{\"mode\":\"marketdata\",\"code\":\"1\"},\"CompactMarketDataMessage\":{\"mode\":\"compact_marketdata\",\"code\":\"2\"},\"SnapquoteDataMessage\":{\"mode\":\"full_snapquote\",\"code\":\"4\"},\"TbtSnapquoteDataMessage\":{\"mode\":\"tbt_full_snapquote\",\"code\":\"14\"},\"SpreadMarketUpdate\":{\"mode\":\"spreaddata\",\"code\":\"5\"},\"MktStatus\":{\"mode\":\"market_status\",\"code\":\"9\"},\"ExchangeMessage\":{\"mode\":\"exchange_messages\",\"code\":\"10\"},\"TbtUpdate\":{\"mode\":\"tbt_full_snapquote\",\"code\":\"14\"},\"ClientAlerts\":{\"mode\":\"updates\",\"code\":\"5002\"},\"AdminMessages\":{\"mode\":\"updates\",\"code\":\"5002\"},\"OrderUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"TradeUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"PositionUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"GreekData\":{\"mode\":\"greekdata\",\"code\":\"15\"}}')\r\n    this.shouldReopenSocket = true\r\n    //Following messages are sent over socket on socket open to feeds socket endpoint\r\n    this.exchanges = [\r\n        { name: \"NSE\", value: 1 },\r\n        { name: \"NFO\", value: 2 },\r\n        { name: \"CDS\", value: 3 },\r\n        { name: \"BSE\", value: 6 },\r\n    ]\r\n    this.instruments = [\r\n        { name: \"NIFTYBEES-EQ\", value: 10576, exchange: 1 },\r\n        { name: \"NIFTY 50\", value: 26000, exchange: 1 },\r\n        { name: \"Nifty IT\", value: 26008, exchange: 1 },\r\n        { name: \"Nifty Bank\", value: 26009, exchange: 1 },\r\n        { name: \"Nifty Next 50\", value: 26013, exchange: 1 },\r\n        { name: \"Nifty Pharma\", value: 26023, exchange: 1 },\r\n        { name: \"Nifty PSU Bank\", value: 26025, exchange: 1 },\r\n        { name: \"NIFTY FIN SERVICE\", value: 26037, exchange: 1 },\r\n        { name: \"NIFTY MID SELECT\", value: 26074, exchange: 1 },\r\n        { name: \"SENSEX\", value: 1, exchange: 6 },\r\n        { name: \"BANKNIFTY24AUGFUT\", value: 35089, exchange: 2 },\r\n        { name: \"FINNIFTY24AUGFUT\", value: 35073, exchange: 2 },\r\n        { name: \"USDINR24AUGFUT\", value: 1237, exchange: 3 },\r\n        { name: \"MIDCPNIFTY24SEPFUT\", value: 38958, exchange: 2 },\r\n        { name: \"BANKNIFTY24AUG51200PE\", value: 48010, exchange: 2 }\r\n    ]\r\n    //this.messages = [\r\n    /* Don't subscribe to exchange messages\r\n    { \"a\": \"subscribe\", \"v\": [1], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [2], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [3], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [6], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [7], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [4], \"m\": \"exchange_messages\" },*/\r\n    /*when m = \"compact_marketdata\" or \"greekdata\" or \"marketdata\", v = [[exchange, instrumentToken]]*/\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 10576]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26000]], \"m\": \"compact_marketdata\" },\r\n    /* { \"a\": \"subscribe\", \"v\": [[1, 26000]], \"m\": \"marketdata\" },\r\n    e.g. response message {\"topic\":\"DetailMarketDataMessage/1/26000\",\"msg\":{\"exchange\":1,\"instrumentToken\":26000,\"lastTradedPrice\":2501775,\"lastTradedTime\":1724764675,\"lastTradedQuantity\":0,\"volume\":0,\"bestBidPrice\":0,\"bestBidQuantity\":0,\"bestAskPrice\":0,\"bestAskQuantity\":0,\"totalBuyQuantity\":0,\"totalSellQuantity\":0,\"averageTradePrice\":0,\"exchangeTimestamp\":1724764675,\"openPrice\":2502480,\"highPrice\":2507310,\"lowPrice\":2497365,\"closePrice\":2501060,\"yearlyHighPrice\":2507830,\"yearlyLowPrice\":1883785,\"lowDPR\":0,\"HighDPR\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0},\"timestamp\":1724775185218},*/\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26008]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26009]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26013]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26023]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26037]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26074]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[6, 1]], \"m\": \"compact_marketdata\" },\r\n    /*{ \"a\": \"subscribe\", \"v\": [[2, 48010]], \"m\": \"compact_marketdata\" },\r\n    { \"a\": \"subscribe\", \"v\": [[2, 48010]], \"m\": \"greekdata\" }\r\n    e.g. response message {\"topic\":\"GreekData/2/48010\",\"msg\":{\"exchange\":2,\"instrumentToken\":48010,\"underlyingToken\":26009,\"exchangeTimestamp\":1724752800,\"delta\":\"516115\",\"gamma\":\"1137\",\"vega\":\"10676518\",\"rho\":\"-727607\",\"theta\":\"-62623489\",\"iv\":\"13094074\",\"ltt\":1724752799,\"ltq\":15,\"ltp\":14775,\"currentOpenInterest\":1651860,\"initialOpenInterest\":1176300},\"timestamp\":1724775185241},*/\r\n    /*{ \"a\": \"unsubscribe\", \"v\": [[1, 26009]], \"m\": \"compact_marketdata\" },\r\n    { \"a\": \"unsubscribe\", \"v\": [[1, 26000]], \"m\": \"compact_marketdata\" },*/\r\n    //]\r\n    this._sendHeartbeat = function () {\r\n        var e = this;\r\n        if (e.HearbeatIntervalID) {\r\n            clearInterval(e.HearbeatIntervalID)\r\n            e.HearbeatIntervalID = undefined\r\n        }\r\n        e.HearbeatIntervalID = setInterval((function () {\r\n            e._socket && e._socket.readyState === WebSocket.OPEN && e._socket.send('{\"a\":\"h\",\"v\":[],\"m\":\"\"}')\r\n        }), 9500)\r\n    }\r\n\r\n    this.subscribe = function (exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback) {\r\n        var topicObj = this.getTopicObj(exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\r\n        var topicName = this.getTopicName(exchangeCode, instrumentToken, subscriptionType);\r\n        this._topics[topicName] = topicObj[topicName];\r\n        if (this.isSocketOpen()) {\r\n            this._socket.send(JSON.stringify(topicObj[topicName][\"message\"]));\r\n        }\r\n        return topicName;\r\n    };\r\n\r\n    this.getTopicName = function (exchangeCode: number, instrumentToken: number, subscriptionType: string) {\r\n        return subscriptionType.concat(\"/\", exchangeCode + \"/\" + instrumentToken);\r\n    }\r\n\r\n    this.getTopicObj = function (exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback) {\r\n        var message = { \"a\": \"subscribe\", \"v\": [[exchangeCode, instrumentToken]], \"m\": \"compact_marketdata\" };\r\n        var topicName = this.getTopicName(exchangeCode, instrumentToken, subscriptionType);\r\n        return { [topicName]: { message: message, subscriptions: [{ callback: callback, subscriptionLocation: subscriptionLocation }] } };\r\n    }\r\n\r\n    this.unsubscribe = function (topicName) {\r\n        var message = this._topics[topicName][\"message\"]\r\n        Object.assign(message, { \"a\": \"unsubscribe\" });\r\n        if (message && this.isSocketOpen()) {\r\n            this._socket.send(JSON.stringify(message));\r\n            delete this._topics[topicName];\r\n        }\r\n    };\r\n\r\n    this.unsubscribeAll = function () {\r\n        Object.keys(this._topics).forEach((topic) => {\r\n            this.unsubscribe(topic);\r\n        });\r\n    };\r\n\r\n    this._sendHeartbeat.bind(this)\r\n    this.windowOnBeforeUnload = function () {\r\n        console.log(\"Unloading\")\r\n        this.closeSocket(false);\r\n        //Keep returnValue true to let user see the message Changes may not be saved...\r\n        //event.returnValue = true;\r\n    }\r\n    this.isSocketOpen = () => this._socket && this._socket.readyState === WebSocket.OPEN\r\n    this.closeSocket = function (shouldReopen) {\r\n        if (this.isSocketOpen()) {\r\n            this.shouldReopenSocket = shouldReopen\r\n            this.unsubscribeAll()\r\n            this._socket.close();\r\n            this._socket = undefined;\r\n            if (this.HearbeatIntervalID) {\r\n                clearInterval(this.HearbeatIntervalID)\r\n                this.HearbeatIntervalID = undefined\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    this.writeToHtml = async function (msg) {\r\n        if (msg.msg) {\r\n            msg.msg.timestamp = Date.now()\r\n            msg.msg.topic = msg?.topic\r\n            if (this.container && msg.msg) {\r\n                //console.log(msg.msg);\r\n                await Excel.run(async (context) => {\r\n                    let sheet = context.workbook.worksheets.getItem(\"Trades\");\r\n                    //let randomResult = context.workbook.functions.randBetween(1, 3000).load(\"value\");\r\n                    let table = sheet.tables.getItem(\"TradesTable\")\r\n                    let tableRange = table.getRange();\r\n                    //console.log((new Date()).toISOString())\r\n                    let foundRange = await findTextInRange(context, msg.msg.instrumentToken, tableRange.getColumn(2), 1)\r\n                    //console.log((new Date()).toISOString())\r\n                    if (foundRange != undefined) {\r\n                        let rowRange = table.rows.getItemAt(foundRange.rowIndex - 1).getRange().getOffsetRange(0, 3).getResizedRange(0, -3 - 5)//Column D to M. Subtract 5 to remove column N to R\r\n                        rowRange.load([\"address\", \"rowCount\", \"columnCount\"]);\r\n                        await context.sync();\r\n                        //console.log(`Found ${msg.msg.instrumentToken} ${foundRange.rowIndex} ${foundRange.address}`);\r\n                        //console.log(`${rowRange.address} ${rowRange.rowCount} ${rowRange.columnCount}`)\r\n                        let newValues = [];\r\n                        msg.msg = __convert_prices(msg.msg, __exchange_price_multipliers[msg.msg['exchange']])\r\n                        newValues.push(...Object.keys(msg.msg))\r\n                        if (newValues.length == rowRange.columnCount) {\r\n                            let newValue = [newValues];\r\n                            //console.log(newValue)\r\n                            rowRange.values = newValue;\r\n                        }\r\n                        await context.sync();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    \r\n    this.connect = function () {\r\n        var e = this;\r\n        return new Promise(((_value, _callback) => {//Check this line with orginal code\r\n            e._socket = new WebSocket(e.uri)\r\n            e._socket.binaryType = \"arraybuffer\"\r\n            e._socket.onopen = function () {\r\n                e._reconnectionTimeout = 0\r\n                Object.values(e._topics).forEach((function (t) {\r\n                    if (t[\"message\"])\r\n                        e._socket.send(JSON.stringify(t[\"message\"]))\r\n                }))\r\n                e._sendHeartbeat();\r\n            }\r\n            e._socket.onmessage = function (t) {\r\n                var a = t.data;\r\n                try {\r\n                    var n = function (e) {\r\n                        var t = new DataView(e), a = {};\r\n                        switch (t.getInt8(0)) {\r\n                            case 15:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        underlyingToken: e.getInt32(6),\r\n                                        exchangeTimestamp: e.getInt32(10),\r\n                                        delta: e.getBigInt64(14),\r\n                                        gamma: e.getBigInt64(22),\r\n                                        vega: e.getBigInt64(30),\r\n                                        rho: e.getBigInt64(38),\r\n                                        theta: e.getBigInt64(46),\r\n                                        iv: e.getBigInt64(54),\r\n                                        ltt: e.getInt32(62),\r\n                                        ltq: e.getInt32(66),\r\n                                        ltp: e.getInt32(70),\r\n                                        currentOpenInterest: e.getInt32(74),\r\n                                        initialOpenInterest: e.getInt32(78)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"GreekData/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 1:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        lastTradedPrice: e.getInt32(6),\r\n                                        lastTradedTime: e.getInt32(10),\r\n                                        lastTradedQuantity: e.getInt32(14),\r\n                                        volume: e.getInt32(18),\r\n                                        bestBidPrice: e.getInt32(22),\r\n                                        bestBidQuantity: e.getInt32(26),\r\n                                        bestAskPrice: e.getInt32(30),\r\n                                        bestAskQuantity: e.getInt32(34),\r\n                                        totalBuyQuantity: e[\"getInt64\"](38),\r\n                                        totalSellQuantity: e[\"getInt64\"](46),\r\n                                        averageTradePrice: e.getInt32(54),\r\n                                        exchangeTimestamp: e.getInt32(58),\r\n                                        openPrice: e.getInt32(62),\r\n                                        highPrice: e.getInt32(66),\r\n                                        lowPrice: e.getInt32(70),\r\n                                        closePrice: e.getInt32(74),\r\n                                        yearlyHighPrice: e.getInt32(78),\r\n                                        yearlyLowPrice: e.getInt32(82),\r\n                                        lowDPR: e.getInt32(86),\r\n                                        HighDPR: e.getInt32(90),\r\n                                        currentOpenInterest: e.getInt32(94),\r\n                                        initialOpenInterest: e.getInt32(98)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"DetailMarketDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 2:\r\n                                return a = function (e) {\r\n                                    return 42 === e.byteLength ? {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        ltp: e.getInt32(6),\r\n                                        change: e.getInt32(10),\r\n                                        ltt: e.getInt32(14),\r\n                                        lowDpr: e.getInt32(18),\r\n                                        highDpr: e.getInt32(22),\r\n                                        currentOpenInterest: e.getInt32(26),\r\n                                        initialOpenInterest: e.getInt32(30),\r\n                                        bidPrice: e.getInt32(34),\r\n                                        askPrice: e.getInt32(38)\r\n                                    } : 46 === e.byteLength ? {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        ltp: e.getInt32(6),\r\n                                        change: e.getInt32(10),\r\n                                        ltt: e.getInt32(14),\r\n                                        lowDpr: e.getInt32(18),\r\n                                        highDpr: e.getInt32(22),\r\n                                        currentOpenInterest: e.getInt32(26),\r\n                                        initialOpenInterest: e.getInt32(30),\r\n                                        bidPrice: e.getInt32(34),\r\n                                        askPrice: e.getInt32(38),\r\n                                        ltq: e.getInt32(42)\r\n                                    } : {\r\n                                        exchange: 0,\r\n                                        instrumentToken: 0,\r\n                                        ltp: 0,\r\n                                        change: 0,\r\n                                        ltt: 0,\r\n                                        lowDpr: 0,\r\n                                        highDpr: 0,\r\n                                        currentOpenInterest: 0,\r\n                                        initialOpenInterest: 0,\r\n                                        bidPrice: 0,\r\n                                        askPrice: 0,\r\n                                        ltq: 0\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"CompactMarketDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 4:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        buyers: [e.getInt32(6), e.getInt32(10), e.getInt32(14), e.getInt32(18), e.getInt32(22)],\r\n                                        bidPrices: [e.getInt32(26), e.getInt32(30), e.getInt32(34), e.getInt32(38), e.getInt32(42)],\r\n                                        bidQtys: [e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58), e.getInt32(62)],\r\n                                        sellers: [e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78), e.getInt32(82)],\r\n                                        askPrices: [e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98), e.getInt32(102)],\r\n                                        askQtys: [e.getInt32(106), e.getInt32(110), e.getInt32(114), e.getInt32(118), e.getInt32(122)],\r\n                                        averageTradePrice: e.getInt32(126),\r\n                                        open: e.getInt32(130),\r\n                                        high: e.getInt32(134),\r\n                                        low: e.getInt32(138),\r\n                                        close: e.getInt32(142),\r\n                                        totalBuyQty: e[\"getInt64\"](146),\r\n                                        totalSellQty: e[\"getInt64\"](154),\r\n                                        volume: e.getInt32(162)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"SnapquoteDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 5:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken1: e.getInt32(2),\r\n                                        instrumentToken2: e.getInt32(6),\r\n                                        exchangeTimestamp: e.getInt32(10),\r\n                                        totalBuyers: e.getInt32(14),\r\n                                        totalSellers: e.getInt32(18),\r\n                                        buyers: [e.getInt32(22), e.getInt32(26), e.getInt32(30), e.getInt32(34), e.getInt32(38)],\r\n                                        bidPrices: [e.getInt32(42), e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58)],\r\n                                        bidQtys: [e.getInt32(62), e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78)],\r\n                                        sellers: [e.getInt32(82), e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98)],\r\n                                        askPrices: [e.getInt32(102), e.getInt32(106), e.getInt32(110), e.getInt32(114), e.getInt32(118)],\r\n                                        askQtys: [e.getInt32(122), e.getInt32(126), e.getInt32(130), e.getInt32(134), e.getInt32(138)],\r\n                                        volume: e.getInt32(142),\r\n                                        totalTradeValue: e[\"getInt64\"](146),\r\n                                        totalBuyQty: e[\"getInt64\"](154),\r\n                                        totalSellQty: e[\"getInt64\"](162),\r\n                                        open: e.getInt32(170),\r\n                                        high: e.getInt32(174),\r\n                                        low: e.getInt32(178),\r\n                                        ltp: e.getInt32(182),\r\n                                        lastTradedPrice: e.getInt32(182),\r\n                                        ltt: e.getInt32(186),\r\n                                        lowDpr: e.getInt32(190),\r\n                                        highDpr: e.getInt32(194),\r\n                                        closePrice: e.getInt32(198),\r\n                                        close: e.getInt32(198),\r\n                                        averageTradePrice: 206 === e.byteLength ? e.getInt32(202) : 0\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"SpreadMarketUpdate/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken1\"], \"-\").concat(a[\"instrumentToken2\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 9:\r\n                                return a = function (e) {\r\n                                    var t = e.getInt8(1)\r\n                                        , a = e.getInt16(2)\r\n                                        , n = e[\"getString\"](4, a)\r\n                                        , r = 4 + a\r\n                                        , i = e.getInt16(r)\r\n                                        , l = r + 2\r\n                                        , c = l + i;\r\n                                    return {\r\n                                        exchange: t,\r\n                                        marketType: n,\r\n                                        message: e[\"getString\"](l, i),\r\n                                        timestamp: e.getInt32(c)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"MktStatus/\".concat(a[\"exchange\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 10:\r\n                                return a = function (e) {\r\n                                    var t = e.getInt8(1), a = e.getInt16(2), n = 4 + a;\r\n                                    return {\r\n                                        exchange: t,\r\n                                        message: e[\"getString\"](4, a),\r\n                                        timestamp: e.getInt32(n)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"ExchangeMessage/\".concat(a[\"exchange\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 11:\r\n                                return {\r\n                                    topic: \"OrderUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 12:\r\n                                return {\r\n                                    topic: \"TradeUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 14:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        lastTradePrice: e.getInt32(14),\r\n                                        lastTradeQuantity: e.getInt32(18),\r\n                                        totalTradeQuantity: e[\"getInt64\"](22),\r\n                                        buyers: [e.getInt32(30), e.getInt32(34), e.getInt32(38), e.getInt32(42), e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58), e.getInt32(62), e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78), e.getInt32(82), e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98), e.getInt32(102), e.getInt32(106)],\r\n                                        bidPrices: [e.getInt32(110), e.getInt32(114), e.getInt32(118), e.getInt32(122), e.getInt32(126), e.getInt32(130), e.getInt32(134), e.getInt32(138), e.getInt32(142), e.getInt32(146), e.getInt32(150), e.getInt32(154), e.getInt32(158), e.getInt32(162), e.getInt32(166), e.getInt32(170), e.getInt32(174), e.getInt32(178), e.getInt32(182), e.getInt32(186)],\r\n                                        bidQtys: [e.getInt32(190), e.getInt32(194), e.getInt32(198), e.getInt32(202), e.getInt32(206), e.getInt32(210), e.getInt32(214), e.getInt32(218), e.getInt32(222), e.getInt32(226), e.getInt32(230), e.getInt32(234), e.getInt32(238), e.getInt32(242), e.getInt32(246), e.getInt32(250), e.getInt32(254), e.getInt32(258), e.getInt32(262), e.getInt32(266)],\r\n                                        sellers: [e.getInt32(270), e.getInt32(274), e.getInt32(278), e.getInt32(282), e.getInt32(286), e.getInt32(290), e.getInt32(294), e.getInt32(298), e.getInt32(302), e.getInt32(306), e.getInt32(310), e.getInt32(314), e.getInt32(318), e.getInt32(322), e.getInt32(326), e.getInt32(330), e.getInt32(334), e.getInt32(338), e.getInt32(342), e.getInt32(346)],\r\n                                        askPrices: [e.getInt32(350), e.getInt32(354), e.getInt32(358), e.getInt32(362), e.getInt32(366), e.getInt32(370), e.getInt32(374), e.getInt32(378), e.getInt32(382), e.getInt32(386), e.getInt32(390), e.getInt32(394), e.getInt32(398), e.getInt32(402), e.getInt32(406), e.getInt32(410), e.getInt32(414), e.getInt32(418), e.getInt32(422), e.getInt32(426)],\r\n                                        askQtys: [e.getInt32(430), e.getInt32(434), e.getInt32(438), e.getInt32(442), e.getInt32(446), e.getInt32(450), e.getInt32(454), e.getInt32(458), e.getInt32(462), e.getInt32(466), e.getInt32(470), e.getInt32(474), e.getInt32(478), e.getInt32(482), e.getInt32(486), e.getInt32(490), e.getInt32(494), e.getInt32(498), e.getInt32(502), e.getInt32(506)],\r\n                                        averageTradePrice: e.getInt32(510),\r\n                                        open: e.getInt32(514),\r\n                                        high: e.getInt32(518),\r\n                                        low: e.getInt32(522),\r\n                                        close: e.getInt32(526),\r\n                                        totalBuyQty: e[\"getInt64\"](530),\r\n                                        totalSellQty: e[\"getInt64\"](538),\r\n                                        volume: e.getInt32(546)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"TbtSnapquoteDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    /***msg: Jt(a)*/\r\n                                };\r\n                            case 50:\r\n                                return {\r\n                                    topic: \"OrderUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 51:\r\n                                return {\r\n                                    topic: \"TradeUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 58:\r\n                                return {\r\n                                    topic: \"PositionUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            default:\r\n                                return {}\r\n                        }\r\n                    }(a)\r\n                    //e.writeToHtml(n);\r\n                    n.msg = __convert_prices(n.msg, __exchange_price_multipliers[n.msg['exchange']])\r\n                    let r = n.topic;\r\n                    ((e._topics[r] || {}).subscriptions || []).forEach((function (subscription) {\r\n                        return (0,\r\n                            subscription.callback)(n)\r\n                    }\r\n                    ))\r\n                } catch (i) {\r\n                    console.log(i)\r\n                }\r\n            }\r\n            e._socket.onclose = function () {\r\n                if (e.shouldReopenSocket) {\r\n                    setTimeout((function () {\r\n                        return e.connect()\r\n                    }\r\n                    ), 1e3)\r\n                }\r\n            }\r\n            e._socket.onerror = function (t) {\r\n                console.log(\"Socket encountered error: \".concat(t.message, \", closing socket\"));\r\n                if (e.isSocketOpen())\r\n                    e._socket.close();\r\n            }\r\n        }))\r\n    }//this.connect.bind(this),\r\n    this.wsHandler = function (e /*messageType, subscriptionLocation, payload*/) {\r\n        var t = this\r\n            , a = e.messageType\r\n            , r = e.subscriptionLocation\r\n            , i = e.payload, Gt = [\"ClientAlerts\", \"OrderUpdate\", \"TradeUpdate\", \"AdminMessage\", \"PositionUpdate\", \"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\", \"MktStatus\", \"ExchangeMessage\"]\r\n            , l = function (e) {\r\n                var t = e.messageType\r\n                    , a = e.payload //exchangeCode and instrumentToken when t=e.messageType is in [\"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\"]\r\n                    , n = void 0 === a ? {} : a;\r\n                if (!(t in Gt))\r\n                    throw \"\".concat(t, \" not supported\");\r\n                if ([\"ClientAlerts\", \"OrderUpdate\", \"TradeUpdate\", \"AdminMessage\", \"PositionUpdate\"].includes(t))\r\n                    return \"\".concat(t);\r\n                if ([\"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\"].includes(t)) {\r\n                    var r = n.exchangeCode\r\n                        , i = n.instrumentToken;\r\n                    if (!r || !i)\r\n                        throw \"missing exchangeCode: \".concat(r, \" or instrumentToken: \").concat(i);\r\n                    return \"\".concat(t, \"/\").concat(r, \"/\").concat(i)\r\n                }\r\n                if ([\"MktStatus\", \"ExchangeMessage\"].includes(t)) {\r\n                    var l = n.exchangeCode;\r\n                    if (!l)\r\n                        throw \"missing exchangeCode: \".concat(l);\r\n                    return \"\".concat(t, \"/\").concat(l)\r\n                }\r\n                throw \"invalid messageType: \".concat(t)\r\n            }({\r\n                messageType: a,\r\n                payload: i\r\n            })\r\n            , c = function (e) {\r\n                var t = e.messageType\r\n                    , a = e.actionType\r\n                    , n = e.payload\r\n                    , r = void 0 === n ? {} : n;\r\n                switch (t) {\r\n                    case \"SpreadMarketUpdate\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"spreaddata\"\r\n                        };\r\n                    case \"DetailMarketDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"marketdata\"\r\n                        };\r\n                    case \"CompactMarketDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"compact_marketdata\"\r\n                        };\r\n                    case \"SnapquoteDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"full_snapquote\"\r\n                        };\r\n                    case \"TbtSnapquoteDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"tbt_full_snapquote\"\r\n                        };\r\n                    case \"OrderUpdate\":\r\n                        return {\r\n                            a: a,\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"updates\"\r\n                        };\r\n                    case \"TradeUpdate\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"updates\"\r\n                        };\r\n                    case \"ExchangeMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [r.exchangeCode],\r\n                            m: \"exchange_messages\"\r\n                        };\r\n                    case \"PositionUpdate\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"position_updates\"\r\n                        };\r\n                    case \"GreekData\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"greekdata\"\r\n                        };\r\n                    default:\r\n                        return {}\r\n                }\r\n            }({\r\n                messageType: a,\r\n                payload: i,\r\n                actionType: \"subscribe\"\r\n            })\r\n            , o = JSON.stringify(Object.assign(c, {\r\n                a: \"subscribe\"\r\n            }))\r\n            , s = JSON.stringify(Object.assign(c, {\r\n                a: \"unsubscribe\"\r\n            }));\r\n        return {\r\n            subscribe: function (e) {\r\n                return new Promise((function (n, i) {\r\n                    t._topics[l] || (t._topics[l] = {\r\n                        subscriptionObj: o,\r\n                        subscriptions: [] //subscriptionLocation, callback\r\n                    }),\r\n                        Boolean(t._topics[l].subscriptions.filter((function (e) {\r\n                            return e.subscriptionLocation === r\r\n                        }\r\n                        )).length) ? i(\"\".concat(a, \" already subscribed from \").concat(r)) : (t._socket && t._socket.readyState === WebSocket.OPEN ? (t._topics[l].subscriptions.length && t._socket.send(s),\r\n                            t._socket.send(o),\r\n                            n(\"subscribed\")) : i(\"socket not connect, \".concat(a, \" will be auto subscribed later\")),\r\n                            t._topics[l].subscriptions.push({\r\n                                subscriptionLocation: r,\r\n                                callback: e\r\n                            }))\r\n                }\r\n                ))\r\n            },\r\n            unsubscribe: function () {\r\n                return new Promise((function (e, n) {\r\n                    var c = (t._topics[l] || []).subscriptions || []\r\n                        , o = c.filter((function (e) {\r\n                            return e.subscriptionLocation !== r\r\n                        }\r\n                        ));\r\n                    var Wt = function (a1, b1, c1) {\r\n                        for (var e, t = arguments.length, a = new Array(t), n = 0; n < t; n++)\r\n                            a[n] = arguments[n];\r\n                        (e = console).log.apply(e, [\"Octopus\"].concat(a))\r\n                    }\r\n                    o.length === c.length ? (Wt(a, r, i),\r\n                        n(\"subscription does not exists\")) : (t._topics[l].subscriptions = o,\r\n                            e(\"unsubscribed\"),\r\n                            0 === o.length && t._socket && t._socket.send(s))\r\n                }\r\n                ))\r\n            }\r\n        }\r\n    }//this.wsHandler.bind(this),\r\n\r\n\r\n    this.initSocket = function (acctoken, symbolDetailsObj) {\r\n        if (this.isSocketOpen())\r\n            this.closeSocket(false)\r\n        this.args.token = acctoken\r\n        this.uri = \"wss://\".concat(this.args.host).concat(this.args.path, \"?login_id=\").concat(this.args.loginId, \"&token=\").concat(this.args.token, \"&device=web\");\r\n        if (symbolDetailsObj)\r\n            Object.assign(this._topics, symbolDetailsObj)\r\n        this.connect()\r\n    }\r\n}\r\n\r\nexport async function findTextInRange(context: Excel.RequestContext, textToFind: string, rangeToSearch: Excel.Range, columnOffset: number) {\r\n    try {\r\n        let foundRange = rangeToSearch.find(textToFind + \"\", { completeMatch: true, matchCase: false, searchDirection: Excel.SearchDirection.forward });\r\n        if (columnOffset && columnOffset > 0)\r\n            foundRange = foundRange.getOffsetRange(0, columnOffset);\r\n        foundRange.load([\"address\", \"rowIndex\"]);\r\n        await context.sync();\r\n        return foundRange;\r\n    } catch (error) {\r\n        // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\r\n        console.error(error);\r\n    }\r\n    return undefined;\r\n}\r\nexport function processNumber(key: string, val: any): any {\r\n    return \r\n}\r\nfunction __convert_prices(dictionary, multiplier) {\r\n    let keysToIgnore = [\"exchange\", \"instrumentToken\", \"timestamp\", \"topic\"];\r\n    let keys = ['ltp', 'best_bid_price', 'best_ask_price', 'atp',\r\n        'open', 'high', 'low', 'close',\r\n        'yearly_high', 'yearly_low', 'lowDpr', 'highDpr',\r\n        'bidPrice', 'askPrice', 'change'\r\n    ];\r\n    keys.forEach((key) => {\r\n        if (key in dictionary)\r\n            dictionary[key] = dictionary[key] / multiplier;\r\n    });\r\n    let multiple_value_keys = ['bid_prices', 'ask_prices']\r\n    multiple_value_keys.forEach((key) => {\r\n        if (key in dictionary) {\r\n            let new_values = [];\r\n            for (let value in dictionary[key])\r\n                new_values.push(parseInt(value) / multiplier);\r\n            dictionary[key] = new_values;\r\n        }\r\n    });\r\n    \r\n    return dictionary;\r\n}\r\n\r\n/*function __convert_instrument(dictionary) {\r\n    if (('exchange' in dictionary) && ('token' in dictionary))\r\n        dictionary['instrument'] = get_instrument_by_token(dictionary['exchange'], dictionary['token'])\r\n    return dictionary;\r\n}*/\r\nexport function convertExchange(exchange) {\r\n    let exchangeCode = parseInt(__exchange_codes[exchange]);\r\n    if (isNaN(exchangeCode))\r\n        return 1;\r\n    return exchangeCode\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","import { flattenJson, flattenJsonObj } from \"./gdrive-functions\";\nimport { convertExchange, SASSocket } from \"./sas\";\nimport { UrlFetchApp } from \"./URLFetchApp\";\n\n/* global clearInterval, console, CustomFunctions, setInterval */\n\n\n/**\n * Provides live stock updates for SAS Online. e.g. ticker(\"NSE\", 26000, \"CompactMarketDataMessage\", \"excel\")\n * @customfunction\n * @param chartUrl URL of Chart Page taken from SAS Online\n * @param exchangeName Name of exchange like NSE, Check __exchange_codes\n * @param instrumentToken Token code of scrip\n * @param subscriptionType Type of subscription like CompactMarketDataMessage\n * @param subscriptionLocation Location of subscription like app-navbar\n */\nexport function ticker(chartUrl: string, exchangeName: string, instrumentToken: number, subscriptionType, subscriptionLocation, invocation: CustomFunctions.StreamingInvocation<number[][]>): void {//CustomFunctions.StreamingInvocation<number[][]>): void {\n  let objName = \"sasObj\";\n  let callback = (msg) => {\n    //let keysToIgnore = [\"exchange\", \"instrumentToken\", \"timestamp\", \"topic\"];\n    //let newValues = [];\n    //Object.keys(msg.msg).forEach((key) => keysToIgnore.indexOf(key) <= -1 ? newValues.push(processNumber(key, msg.msg[key])) : \"\");\n    let retValue = [Object.values(msg?.msg).map((value) => parseFloat(value + \"\"))];\n    invocation.setResult(retValue);\n  };\n  let exchangeCode = convertExchange(exchangeName);\n  let topic = getTopicName(exchangeCode, instrumentToken, subscriptionType);\n  if(window[objName] === void 0)\n    window[objName] = getOrInitialize(chartUrl, objName, exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n  else\n    topic = window[objName].subscribe(exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n\n  invocation.onCanceled = () => {\n    window[objName].unsubscribe(topic);\n  };\n}\n\n\n/**\n * Allows importing json data and flatten it into tabular format\n * @customfunction\n * @param url URL to post/fetch data\n * @param successField Response Json key to check for success response \n * @param successFieldValue Value of Response Json key to check for success response\n * @param flattenArrayPath Array from response JSON to flatten into table\n * @param queryParam URL Query string for which repeated api calls need to be made\n * @param queryParamValues String value, seperated by \";\", of URL Query string for which repeated api calls need to be made\n */\nexport async function ImportJson(url, successField, successFieldValue, flattenArrayPath, queryParam = \"\", queryParamValues = \"\") {\n  //url=\"https://alphaapi.sasonline.in/api/v1/search?\"\n  //successField = \"error.code\", successFieldValue=0, flattenArrayPath=\"result\",queryParam=\"key\", queryParamValues=\"INDIGO\"\n  //url=\"https://alpha.sasonline.in/api/v1/optionchain/NFO?token=26009&num=18&price=49911.2\"\n  //successField = \"error.code\", successFieldValue=0, flattenArrayPath=\"result[0].strikes\"\n  if(queryParam == null || queryParam == \"\") {\n    return GetArrayFromJson(url, successField, successFieldValue, flattenArrayPath);\n  } else {\n    var results: (number|string|boolean)[][] = [];\n    var paramValues = queryParamValues.split(\";\");\n    for(var i = 0; i < paramValues.length; i++) {\n      if(paramValues[i]!=\"\") {\n        var tempResults = await GetArrayFromJson(url + \"&\" + queryParam + \"=\" + paramValues[i], successField, successFieldValue, flattenArrayPath);\n        if(tempResults)\n          results.push(...tempResults);\n      }\n    }\n    return results.slice(1);\n  }\n}\n\n\n\n/**\n * Allows accessing api and flattens returned json data into tabular format\n * @customfunction\n * @param url URL to post/fetch data\n * @param method HttpMethod\n * @param requestBody Body of the request if POST call\n * @param flattenArrayPath Array from response JSON to flatten into table\n * @param flattenObjPath Object key from response JSON to flatten\n * @param authToken Access Token if accessing secured endpoint\n * @param confirmationMessage Message for confirmation\n */\nexport async function WebApiRequest(url, method, requestBody=\"\", flattenArrayPath=\"\", flattenObjPath=\"\", authToken = undefined, confirmationMessage = \"\") {\n  /*url=\"https://alpha.sasonline.in/api/v1/calculator\",\n  method=\"post\",\n  requestBody='[{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"BUY\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4000PE\",\"underlying\":\"11195\",\"token\":\"114138\",\"quantity\":\"300\",\"price\":\"9.85\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"SELL\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4200PE\",\"underlying\":\"11195\",\"token\":\"114142\",\"quantity\":\"300\",\"price\":\"26.7\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"SELL\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4800CE\",\"underlying\":\"11195\",\"token\":\"114153\",\"quantity\":\"300\",\"price\":\"39.2\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"BUY\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG5000CE\",\"underlying\":\"11195\",\"token\":\"114157\",\"quantity\":\"300\",\"price\":\"17\",\"product\":\"0\"}]'\n  flattenArrayPath=\"result?.individual_margin_values\"\n  flattenObjPath = \"result?.combined_margin\"*/\n  /*url=\"https://alphaapi.sasonline.in/api/v1/funds/view?client_id=AG187&type=all\",method=\"get\",flattenArrayPath=\"data?.values\", flattenObjPath=\"\",authToken=\"\"*/\n  /*url=\"https://alphaapi.sasonline.in/api/v1/orders?type=pending&client_id=AG187\",method=\"get\",flattenArrayPath=\"data?.orders\", flattenObjPath=\"\",authToken=\"\"*/\n  /*url=\"https://alpha.sasonline.in/api/v1/contract/NSE?info=scrip&token=11195\",method=\"get\",flattenArrayPath=\"\", flattenObjPath=\"result\",authToken=\"\"*/\n  /*url=\"https://alpha.sasonline.in/api/v1/marketwatches/7ddfa505-983a-4536-97dc-03bb0c8b7404\",method=\"put\",\n  requestBody = '{\"mw_id\":\"7ddfa505-983a-4536-97dc-03bb0c8b7404\",\"exchange\":\"NFO\",\"trading_symbol\":\"BANKNIFTY2481451100CE\",\"token\":54965,\"execution\":\"NORMAL\"}'\n  flattenArrayPath=\"data\", flattenObjPath=\"\",authToken=\"\"*/\n  var results: (string | number | boolean)[][] = [];\n  var options = {\n    'method' : method\n  };\n  if((method == 'post' || method == 'put') && requestBody != \"\") {\n    options['body'] = requestBody;\n    options['headers'] = {\n      \"Accept\": \"application/json, text/plain, *//*\",\n      \"Content-Type\": \"application/json\"\n    }\n  }\n  if(authToken != undefined && authToken != \"\") {\n    options['headers'] = options['headers'] ?? {};\n    options['headers']['Authorization'] = \"Bearer \" + authToken;\n  }\n  let proceedForApiCall = false;\n  \n  if(confirmationMessage == null || confirmationMessage == \"\" || (confirmationMessage != \"\" && proceedForApiCall)) {\n    var responseJson = await UrlFetchApp.fetch(url, options);\n    if(flattenArrayPath!=\"\") {\n      var temp = flattenJson(eval(\"responseJson.\"+flattenArrayPath));\n      if(temp.length > 0)\n        results.push(...temp);\n    }\n\n    if(flattenObjPath!=\"\") {\n      var temp: (string | number | boolean)[][] = flattenJsonObj(eval(\"responseJson\"+flattenObjPath));\n      if(temp.length > 0)\n        results.push(...temp);\n    }\n  }\n  return results;\n}\n\n\nasync function GetArrayFromJson(url, successField, successFieldValue, flattenArrayPath) {\n  var responseJson = await UrlFetchApp.fetch(url);\n  var results: (number|string|boolean)[][] = [];\n  var successFieldEval = eval(\"responseJson\"+successField);\n  if(successFieldEval == successFieldValue) {\n    var flattenArrayPathSplit = flattenArrayPath.split(\";\");\n    for(var i = 0; i < flattenArrayPathSplit.length; i++) {\n      var tempPath = \"responseJson.\"+flattenArrayPathSplit[i];\n      var tempResults = flattenJson(eval(tempPath));\n      if(i>0) {\n        tempResults = tempResults.slice(1,-1);\n      }\n      results.push(...tempResults);\n    }\n    return results;\n  } \n}\n\n\nfunction getTopicName(exchangeCode: number, instrumentToken: number, subscriptionType: string) {\n  return subscriptionType.concat(\"/\", exchangeCode + \"/\" + instrumentToken);\n}\n\nfunction getOrInitialize(chartUrl, objName, exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback): any {\n  if(window[objName] === void 0) {\n    let login_id = UrlFetchApp.getParameterByName(\"login_id\", chartUrl);\n    let login_token = UrlFetchApp.getParameterByName(\"login_token\", chartUrl);\n    window[objName] = new SASSocket({\n      host: \"alpha.sasonline.in\",//window.location.host,\n      path: \"/ws/v1/feeds\",\n      loginId: login_id,//localStorage.getItem(\"login_id\"),\n      //token: localStorage.getItem(\"token\")\n    })\n    let topicObj = window[objName][\"getTopicObj\"](exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n    window[objName][\"initSocket\"](login_token, topicObj)\n    if (window.addEventListener) {\n      window.addEventListener(\"beforeunload\", (event) => window[objName][\"windowOnBeforeUnload\"](event));\n    } else {\n      window.onbeforeunload = (event) => window[objName][\"windowOnBeforeUnload\"](event);\n    }\n  }\n  return window[objName];\n}\n\n\n/**\n * Displays the current time once a second.\n * @customfunction\n * @param invocation Custom function handler\nexport function clock(invocation: CustomFunctions.StreamingInvocation<string>): void {\n  const timer = setInterval(() => {\n    const time = currentTime();\n    invocation.setResult(time);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n\n * @customfunction\n * @param {string} address The address of the cell from which to retrieve the value.\n * @returns The value of the cell at the input address.\n\nexport async function getRangeValue(address) {\n  // Retrieve the context object. \n  const context = new Excel.RequestContext();\n  \n  // Use the context object to access the cell at the input address. \n  const range = context.workbook.worksheets.getActiveWorksheet().getRange(address);\n  range.load(\"values\");\n  await context.sync();\n  \n  // Return the value of the cell at the input address.\n  return range.values[0][0];\n }\n\n/**\n * Returns the current time.\n * @returns String with the current time formatted for the current locale.\n\nexport function currentTime(): string {\n  return new Date().toLocaleTimeString();\n}\n\n/**\n * Increment the cells with a given amount every second. Creates a dynamic spilled array with multiple results\n * @customfunction\n * @param {number} amount The amount to add to the cell value on each increment.\n * @param {CustomFunctions.StreamingInvocation<number[][]>} invocation Parameter to send results to Excel or respond to the user canceling the function. A dynamic array.\n\nexport function increment(amount: number, invocation: CustomFunctions.StreamingInvocation<number[][]>): void {\n  let firstResult = 0;\n  let secondResult = 1;\n  let thirdResult = 2;\n\n  const timer = setInterval(() => {\n    firstResult += amount;\n    secondResult += amount;\n    thirdResult += amount;\n    invocation.setResult([[firstResult], [secondResult], [thirdResult]]);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n/**\n * Writes a message to console.log().\n * @customfunction LOG\n * @param message String to write.\n * @returns String to write.\n\nexport function logMessage(message: string): string {\n  console.log(message);\n\n  return message;\n}\n/**\n * Get text values that spill both right and down.\n * @customfunction\n * @returns {string[][]} A dynamic array with multiple results.\n\nexport function spillRectangle() {\n  return [\n    ['apples', 1, 'pounds'],\n    ['oranges', 3, 'pounds'],\n    ['pears', 5, 'crates']\n  ];\n}\n*/\nCustomFunctions.associate(\"TICKER\", ticker);\nCustomFunctions.associate(\"IMPORTJSON\", ImportJson);\nCustomFunctions.associate(\"WEBAPIREQUEST\", WebApiRequest);"],"names":["UrlFetchApp","fetch","url","options","undefined","response","json","console","log","error","message","getParameterByName","name","window","location","href","replace","results","RegExp","exec","decodeURIComponent","onlyUnique","value","index","array","indexOf","flattenJson","data","result","Array","isArray","length","headersToRemove","setOfHeaders","Set","flatMap","item","tempHeaders","Object","keys","additionalHeaders","forEach","key","setOfSubKeys","push","subItem","headers","header","uniqueHeadersToRemove","filter","val","endsWith","row","rowData","flattenJsonObj","obj","join","DataView","prototype","e","t","a","this","byteLength","n","r","getUint8","String","fromCharCode","getUint32","Math","pow","Number","isSafeInteger","warn","native_getBigInt64","getBigInt64","call","toString","__exchange_codes","__exchange_price_multipliers","SASSocket","args","protocol","container","document","getElementById","uri","_socket","_reconnectionTimeout","_lastConnectedTimestamp","Date","now","_topics","Gt","JSON","parse","shouldReopenSocket","exchanges","instruments","exchange","_sendHeartbeat","HearbeatIntervalID","clearInterval","setInterval","readyState","WebSocket","OPEN","send","subscribe","exchangeCode","instrumentToken","subscriptionType","subscriptionLocation","callback","topicObj","getTopicObj","topicName","getTopicName","isSocketOpen","stringify","concat","subscriptions","unsubscribe","assign","unsubscribeAll","topic","bind","windowOnBeforeUnload","closeSocket","shouldReopen","close","writeToHtml","async","msg","timestamp","Excel","run","table","context","workbook","worksheets","getItem","tables","tableRange","getRange","foundRange","textToFind","rangeToSearch","find","completeMatch","matchCase","searchDirection","SearchDirection","forward","getOffsetRange","load","sync","findTextInRange","getColumn","rowRange","rows","getItemAt","rowIndex","getResizedRange","newValues","__convert_prices","columnCount","newValue","values","connect","Promise","_value","_callback","binaryType","onopen","onmessage","getInt8","getInt32","underlyingToken","exchangeTimestamp","delta","gamma","vega","rho","theta","iv","ltt","ltq","ltp","currentOpenInterest","initialOpenInterest","lastTradedPrice","lastTradedTime","lastTradedQuantity","volume","bestBidPrice","bestBidQuantity","bestAskPrice","bestAskQuantity","totalBuyQuantity","totalSellQuantity","averageTradePrice","openPrice","highPrice","lowPrice","closePrice","yearlyHighPrice","yearlyLowPrice","lowDPR","HighDPR","change","lowDpr","highDpr","bidPrice","askPrice","buyers","bidPrices","bidQtys","sellers","askPrices","askQtys","open","high","low","totalBuyQty","totalSellQty","instrumentToken1","instrumentToken2","totalBuyers","totalSellers","totalTradeValue","getInt16","i","l","c","marketType","lastTradePrice","lastTradeQuantity","totalTradeQuantity","subscription","onclose","setTimeout","onerror","wsHandler","messageType","payload","includes","actionType","v","m","localStorage","o","s","subscriptionObj","Boolean","a1","b1","c1","arguments","apply","Wt","initSocket","acctoken","symbolDetailsObj","token","host","path","loginId","dictionary","multiplier","new_values","parseInt","convertExchange","isNaN","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","ticker","chartUrl","exchangeName","invocation","objName","retValue","map","parseFloat","setResult","getOrInitialize","onCanceled","ImportJson","successField","successFieldValue","flattenArrayPath","queryParam","queryParamValues","GetArrayFromJson","paramValues","split","tempResults","slice","WebApiRequest","method","requestBody","flattenObjPath","authToken","confirmationMessage","proceedForApiCall","responseJson","temp","eval","successFieldEval","flattenArrayPathSplit","tempPath","login_id","login_token","addEventListener","event","onbeforeunload","CustomFunctions","associate"],"sourceRoot":""}