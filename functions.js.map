{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://excel-custom-functions/./src/functions/URLFetchApp.ts","webpack://excel-custom-functions/./src/functions/gdrive-functions.ts","webpack://excel-custom-functions/./src/functions/sas.ts","webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/webpack/runtime/define property getters","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions/./src/functions/functions.ts"],"sourcesContent":["export class UrlFetchApp {\r\n    static async fetch(url, options = undefined) {\r\n        try {\r\n          /*if(options == null || !options) {\r\n            options = { \r\n              \"headers\": {\r\n                \"referer\": \"https://alphaapi.sasonline.in\"\r\n              },\r\n              \"mode\": \"no-cors\",\r\n              \"method\": \"GET\"\r\n            }\r\n          }*/\r\n          const response = options ? await fetch(url, options) : await fetch(url);\r\n          /*if (!response.ok) {\r\n            throw new Error(`Response status: ${response.status}`);\r\n          }*/\r\n          const json = await response.json();\r\n          console.log(json);\r\n          return json;\r\n        } catch (error) {\r\n          console.error(error.message);\r\n        }\r\n      }\r\n    static getParameterByName(name, url = window.location.href) {\r\n        name = name.replace(/[\\[\\]]/g, '\\\\$&');\r\n        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\r\n            results = regex.exec(url);\r\n        if (!results) return null;\r\n        if (!results[2]) return '';\r\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n    }\r\n}","function Run() {\r\n  //https://www.nseindia.com/api/option-chain-indices?symbol=NIFTY\r\n  //var url = \"https://www.nseindia.com/api/option-chain-indices?symbol=BANKNIFTY\";\r\n  //var refererUrl = \"https://www.nseindia.com/get-quotes/derivatives?symbol=NIFTY\"\r\n  //GetOptionChainData(url, refererUrl)\r\n\r\n}\r\n\r\nfunction onlyUnique(value, index, array) {\r\n  return array.indexOf(value) === index;\r\n}\r\n\r\nexport function flattenJson(data: (number|string|boolean)[]) {\r\n  var result: (number|string|boolean)[][] = [];\r\n  if (!Array.isArray(data) || data.length === 0) {\r\n    return result;//\"Input data is not a valid non-empty array\";\r\n  }\r\n  // Getting the union of all keys in the data array objects to ensure we cover all fields\r\n  var headersToRemove = []\r\n  let setOfHeaders = new Set(data.flatMap(item => {\r\n    var tempHeaders = Object.keys(item);\r\n    var additionalHeaders = []\r\n    tempHeaders.forEach(key => {\r\n      if (item[key] != null && item[key] != undefined && typeof (item[key]) == \"object\" && !Array.isArray(item[key]))\r\n        var setOfSubKeys = Object.keys(item[key])\r\n      if (setOfSubKeys != undefined) {\r\n        headersToRemove.push(key)\r\n        additionalHeaders.push(...setOfSubKeys.flatMap(subItem => [key + \".\" + subItem]))\r\n      }\r\n    });\r\n    tempHeaders.push(...additionalHeaders)\r\n    return tempHeaders;\r\n  }));\r\n  var headers: (string)[] = [];\r\n  setOfHeaders.forEach((header) => headers.push(header));\r\n\r\n  var uniqueHeadersToRemove = headersToRemove.filter(onlyUnique);\r\n  headers = headers.filter((val) => uniqueHeadersToRemove.indexOf(val) == -1 && !val.endsWith(\"?\"))\r\n  result.push(headers);\r\n  data.forEach(function (row) {\r\n    if (Array.isArray(row))\r\n      result.push(row)\r\n    else {\r\n      var rowData: (number|string|boolean)[] = [];\r\n      headers.forEach(function (header) {\r\n        var val = eval(\"row.\"+header)\r\n        rowData.push(val === undefined ? \"\" : val)\r\n      });\r\n      result.push(rowData);\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n\r\nexport function flattenJsonObj(obj) {\r\n  var result: (string | number | boolean)[][] = [];\r\n  if (Array.isArray(obj) || obj.length > 0) {\r\n    return result;//\"Array is not allowed\";\r\n  }\r\n  // Getting the union of all keys in the data array objects to ensure we cover all fields\r\n  var headers = [...Object.keys(obj)];\r\n\r\n  result.push(headers);\r\n\r\n  var rowData = [];\r\n  headers.forEach(function (header) {\r\n    var objHeaderVal = eval(\"obj.\"+header)\r\n    if (Array.isArray(objHeaderVal) && objHeaderVal.length > 0)\r\n      rowData.push(objHeaderVal === undefined ? \"\" : objHeaderVal.join(\", \"));\r\n    else\r\n      rowData.push(objHeaderVal === undefined ? \"\" : objHeaderVal);\r\n  });\r\n  result.push(rowData);\r\n\r\n  return result;\r\n}\r\n\r\n/* ==================================================\r\n  The cumulative Normal distribution function: */\r\n\r\nfunction xlfNormSDist(x) {\r\n\r\n  // constants\r\n  var a = 0.2316419;\r\n  var a1 = 0.31938153;\r\n  var a2 = -0.356563782;\r\n  var a3 = 1.781477937;\r\n  var a4 = -1.821255978;\r\n  var a5 = 1.330274429;\r\n\r\n  if (x < 0.0)\r\n    return 1 - xlfNormSDist(-x);\r\n  else\r\n    var k = 1.0 / (1.0 + a * x);\r\n  return 1.0 - Math.exp(-x * x / 2.0) / Math.sqrt(2 * Math.PI) * k\r\n    * (a1 + k * (a2 + k * (a3 + k * (a4 + k * a5))));\r\n}\r\n\r\n\r\n/* ================================================== */\r\n/* The Normal distribution probability density function (PDF)\r\n   for the specified mean and specified standard deviation: */\r\nfunction xlfNormalPDF1a(x, mu, sigma) {\r\n  var num = Math.exp(-Math.pow((x - mu), 2) / (2 * Math.pow(sigma, 2)))\r\n  var denom = sigma * Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\nfunction xlfNormalPDF1b(x, mu, sigma) {\r\n  var num = Math.exp(- 1 / 2 * Math.pow((x - mu) / sigma, 2))\r\n  var denom = sigma * Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\n/* ================================================== */\r\n/* The Normal distribution probability density function (PDF)\r\n   for the standard normal distribution: */\r\nfunction xlfNormalSdistPDF(x) {\r\n  var num = Math.exp(-1 / 2 * x * x)\r\n  var denom = Math.sqrt(2 * Math.PI)\r\n  return num / denom\r\n}\r\n\r\n\r\nfunction d1(UP, SP, T, r, V, D) {\r\n  return (Math.log(UP / SP) + (r - D + 0.5 * V ^ 2) * T) / (V * (Math.sqrt(T)))\r\n}\r\nfunction Nd1(UP, SP, T, r, V, D) {\r\n  return Math.exp(-(d1(UP, SP, T, r, V, D) ^ 2) / 2) / (Math.sqrt(2 * Math.PI))\r\n}\r\nfunction d2(UP, SP, T, r, V, D) {\r\n  return d1(UP, SP, T, r, V, D) - V * Math.sqrt(T)\r\n}\r\nfunction Nd2(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d2(UP, SP, T, r, V, D))\r\n}\r\nfunction CallPrice(UP, SP, T, r, V, D) {\r\n  return Math.exp(-D * T) * UP * xlfNormSDist(d1(UP, SP, T, r, V, D)) - SP * Math.exp(-r * T) * xlfNormSDist(d1(UP, SP, T, r, V, D) - V * Math.sqrt(T))\r\n}\r\nfunction PutPrice(UP, SP, T, r, V, D) {\r\n  return SP * Math.exp(-r * T) * xlfNormSDist(-d2(UP, SP, T, r, V, D)) - Math.exp(-D * T) * UP * xlfNormSDist(-d1(UP, SP, T, r, V, D))\r\n}\r\nfunction CallDelta(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d1(UP, SP, T, r, V, D))\r\n}\r\nfunction PutDelta(UP, SP, T, r, V, D) {\r\n  return xlfNormSDist(d1(UP, SP, T, r, V, D)) - 1\r\n}\r\nfunction CallTheta(UP, SP, T, r, V, D) {\r\n  var CT = -((UP * V * Nd1(UP, SP, T, r, V, D)) / (2 * Math.sqrt(T)) - r * SP * Math.exp(-r * (T)) * Nd2(UP, SP, T, r, V, D))\r\n  return CT / 365\r\n}\r\nfunction OptionGamma(UP, SP, T, r, V, D) {\r\n  return Nd1(UP, SP, T, r, V, D) / (UP * (V * Math.sqrt(T)))\r\n}\r\nfunction OptionVega(UP, SP, T, r, V, D) {\r\n  return 0.01 * UP * Math.sqrt(T) * Nd1(UP, SP, T, r, V, D)\r\n}\r\nfunction PutTheta(UP, SP, T, r, V, D) {\r\n  var PT = -(UP * V * Nd1(UP, SP, T, r, V, D)) / (2 * Math.sqrt(T)) + r * SP * Math.exp(-r * (T)) * (1 - Nd2(UP, SP, T, r, V, D))\r\n  return PT / 365\r\n}\r\nfunction CallRho(UP, SP, T, r, V, D) {\r\n  return 0.01 * SP * T * Math.exp(-r * T) * xlfNormSDist(d2(UP, SP, T, r, V, D))\r\n}\r\nfunction PutRho(UP, SP, T, r, V, D) {\r\n  return -0.01 * SP * T * Math.exp(-r * T) * (1 - xlfNormSDist(d2(UP, SP, T, r, V, D)))\r\n}\r\nfunction CallIV(UP, SP, T, r, MP, D) {\r\n  let Mx = 5\r\n  let Mn = 0\r\n  while ((Mx - Mn) > 0.0001) {\r\n    if (CallPrice(UP, SP, T, r, (Mx + Mn) / 2, D) > MP)\r\n      Mx = (Mx + Mn) / 2\r\n    else\r\n      Mn = (Mx + Mn) / 2\r\n  }\r\n  return (Mx + Mn) / 2\r\n}\r\nfunction PutIV(UP, SP, T, r, MP, D) {\r\n  let Mx = 5\r\n  let Mn = 0\r\n  while ((Mx - Mn) > 0.0001) {\r\n    if (PutPrice(UP, SP, T, r, (Mx + Mn) / 2, D) > MP)\r\n      Mx = (Mx + Mn) / 2\r\n    else\r\n      Mn = (Mx + Mn) / 2\r\n  }\r\n  return (Mx + Mn) / 2\r\n}","\r\n/**\r\n * {\"exchange\":1,\"instrumentToken\":10576,\"ltp\":28271,\"change\":517,\"ltt\":1726136877,\"lowDpr\":22337,\"highDpr\":33506,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":28271,\"ltq\":50,\"timestamp\":1726166851502,\"topic\":\"CompactMarketDataMessage/1/10576\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26000,\"ltp\":2538890,\"change\":47045,\"ltt\":1726145773,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851504,\"topic\":\"CompactMarketDataMessage/1/26000\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26008,\"ltp\":4315210,\"change\":67885,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851505,\"topic\":\"CompactMarketDataMessage/1/26008\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26009,\"ltp\":5177240,\"change\":76240,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851506,\"topic\":\"CompactMarketDataMessage/1/26009\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26013,\"ltp\":7544635,\"change\":109110,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851509,\"topic\":\"CompactMarketDataMessage/1/26013\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26023,\"ltp\":2342960,\"change\":20920,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851509,\"topic\":\"CompactMarketDataMessage/1/26023\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26037,\"ltp\":2394560,\"change\":36310,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851510,\"topic\":\"CompactMarketDataMessage/1/26037\"}\r\nsas.ts:218 {\"exchange\":1,\"instrumentToken\":26074,\"ltp\":1327525,\"change\":15855,\"ltt\":1726145746,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851511,\"topic\":\"CompactMarketDataMessage/1/26074\"}\r\nsas.ts:218 {\"exchange\":6,\"instrumentToken\":1,\"ltp\":8296271,\"change\":143955,\"ltt\":1726144933,\"lowDpr\":0,\"highDpr\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0,\"bidPrice\":0,\"askPrice\":0,\"ltq\":0,\"timestamp\":1726166851511,\"topic\":\"CompactMarketDataMessage/6/1\"}\r\n */\r\nDataView.prototype[\"getString\"] = function (e, t) {\r\n    for (var a = \"number\" == typeof t ? e + t : this.byteLength, n = \"\", r = -1; e < this.byteLength && e < a && 0 != (r = this.getUint8(e++));)\r\n        n += String.fromCharCode(r);\r\n    return n\r\n}\r\nDataView.prototype[\"getInt64\"] = function (e) {\r\n    var t = this.getUint32(e)\r\n        , a = this.getUint32(e + 4)\r\n        , n = Math.pow(2, 32) * t + a;\r\n    return Number.isSafeInteger(n) ? n : (console.warn(n, \"exceeds MAX_SAFE_INTEGER. Precision may be lost\"),\r\n        -1)\r\n}\r\n//Override getBigInt64 as BigInt can not be serialized by JSON.stringify\r\nvar native_getBigInt64 = DataView.prototype.getBigInt64\r\nDataView.prototype.getBigInt64 = function (e) {\r\n    return native_getBigInt64.call(this, e).toString();\r\n}\r\nvar __exchange_codes = {\r\n    'NSE': 1,\r\n    'NFO': 2,\r\n    'CDS': 3,\r\n    'MCX': 4,\r\n    'BSE': 6,\r\n    'BFO': 7\r\n}\r\nvar __exchange_price_multipliers = {\r\n    1: 100,\r\n    2: 100,\r\n    3: 10000000,\r\n    4: 100,\r\n    6: 100,\r\n    7: 100\r\n}\r\nexport function btnCopyToClipboardHandler(containerid) {\r\n    const text = document.getElementById(containerid).innerText;\r\n\r\n    if (navigator.clipboard) {\r\n        navigator.clipboard.writeText(text).then(() => {\r\n            alert('Text copied to clipboard');\r\n        }).catch(err => {\r\n            alert(err);\r\n        });\r\n    } else {\r\n        // Fallback for older browsers that don't support the Clipboard API\r\n        fallbackCopyText(text);\r\n    }\r\n}\r\n\r\n// Fallback function using document.execCommand for older browsers\r\nfunction fallbackCopyText(text) {\r\n    const textArea = document.createElement('textarea');\r\n    textArea.value = text;\r\n    document.body.appendChild(textArea);\r\n    textArea.select();\r\n\r\n    try {\r\n        document.execCommand('copy');\r\n        alert('Text copied to clipboard');\r\n    } catch (err) {\r\n        alert(err);\r\n    }\r\n\r\n    document.body.removeChild(textArea);\r\n}\r\nfunction btnCopyToClipboardHandlerOld(containerid) {\r\n    if (document[\"selection\"]) { // IE\r\n        var range = document.body[\"createTextRange\"]();\r\n        range.moveToElementText(document.getElementById(containerid));\r\n        range.select();\r\n    } else if (window.getSelection) {\r\n        var range = document.createRange();\r\n        range.selectNode(document.getElementById(containerid));\r\n        window.getSelection().removeAllRanges();\r\n        window.getSelection().addRange(range);\r\n        document.execCommand(\"copy\");\r\n    }\r\n    //alert(\"Text has been copied\")\r\n}\r\n\r\nfunction getYYYYMMDD() {\r\n    return (new Date()).toISOString().split('T')[0].replace(\"-\", \"\").replace(\"-\", \"\");\r\n}\r\n\r\nexport function btnSaveToFileClickHandler(containerid) {\r\n    const text = document.getElementById(containerid).innerText;\r\n    const strDate = getYYYYMMDD()\r\n    const blob = new Blob([text], { type: 'text/plain' });\r\n    const url = window.URL.createObjectURL(blob);\r\n\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'SocketData ' + strDate + '.json'; // File name to save as\r\n    a.click();\r\n\r\n    // Clean up\r\n    window.URL.revokeObjectURL(url);\r\n}\r\nasync function btnSaveToFileClickHandlerOld(containerid) {\r\n    var divJson = document.getElementById(containerid)\r\n    var strDate = getYYYYMMDD()\r\n    const options = {\r\n        suggestedName: 'SocketData ' + strDate + '.json',\r\n        types: [\r\n            {\r\n                description: 'Json File',\r\n                accept: {\r\n                    'application/json': ['.json'],\r\n                },\r\n            },\r\n        ],\r\n    };\r\n\r\n    try {\r\n        const fileHandler = await window[\"showSaveFilePicker\"](options);\r\n        const file = await fileHandler.createWritable();\r\n        await file.write(divJson.innerText);\r\n        await file.close();\r\n    } catch (err) {\r\n        if (err.name !== 'AbortError') {\r\n            console.error('Error:', err);\r\n        }\r\n    }\r\n}\r\n\r\nexport function getSymbolJsonToSubscribe(exchange, token): any {\r\n    return { \"a\": \"subscribe\", \"v\": [[exchange, token]], \"m\": \"compact_marketdata\" };\r\n}\r\n\r\nexport function SASSocket(args: { host: string, path: string, loginId: string }) {\r\n    this.args = args;//arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\r\n    //Object(zt.a)(this, e);\r\n    var protocol = \"https:\" === window.location.protocol ? \"wss\" : \"ws\";\r\n    //this.uri = \"wss://alpha.sasonline.in/ws/v1/feeds?login_id=AG187&token=\".concat(token, \"&device=web\");\r\n    //this.uri = \"\".concat(protocol, \"://\").concat(host).concat(path, \"?login_id=\").concat(loginId, \"&token=\").concat(token, \"&device=web\"),\r\n    this.container = document.getElementById(\"divContainer\");\r\n    this.uri = \"\"\r\n    this._socket = null\r\n    this._reconnectionTimeout = 0\r\n    this._lastConnectedTimestamp = Date.now()\r\n    this._topics = {}\r\n    this.Gt = JSON.parse('{\"DetailMarketDataMessage\":{\"mode\":\"marketdata\",\"code\":\"1\"},\"CompactMarketDataMessage\":{\"mode\":\"compact_marketdata\",\"code\":\"2\"},\"SnapquoteDataMessage\":{\"mode\":\"full_snapquote\",\"code\":\"4\"},\"TbtSnapquoteDataMessage\":{\"mode\":\"tbt_full_snapquote\",\"code\":\"14\"},\"SpreadMarketUpdate\":{\"mode\":\"spreaddata\",\"code\":\"5\"},\"MktStatus\":{\"mode\":\"market_status\",\"code\":\"9\"},\"ExchangeMessage\":{\"mode\":\"exchange_messages\",\"code\":\"10\"},\"TbtUpdate\":{\"mode\":\"tbt_full_snapquote\",\"code\":\"14\"},\"ClientAlerts\":{\"mode\":\"updates\",\"code\":\"5002\"},\"AdminMessages\":{\"mode\":\"updates\",\"code\":\"5002\"},\"OrderUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"TradeUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"PositionUpdate\":{\"mode\":\"updates\",\"code\":\"5002\"},\"GreekData\":{\"mode\":\"greekdata\",\"code\":\"15\"}}')\r\n    this.shouldReopenSocket = true\r\n    //Following messages are sent over socket on socket open to feeds socket endpoint\r\n    this.exchanges = [\r\n        { name: \"NSE\", value: 1 },\r\n        { name: \"NFO\", value: 2 },\r\n        { name: \"CDS\", value: 3 },\r\n        { name: \"BSE\", value: 6 },\r\n    ]\r\n    this.instruments = [\r\n        { name: \"NIFTYBEES-EQ\", value: 10576, exchange: 1 },\r\n        { name: \"NIFTY 50\", value: 26000, exchange: 1 },\r\n        { name: \"Nifty IT\", value: 26008, exchange: 1 },\r\n        { name: \"Nifty Bank\", value: 26009, exchange: 1 },\r\n        { name: \"Nifty Next 50\", value: 26013, exchange: 1 },\r\n        { name: \"Nifty Pharma\", value: 26023, exchange: 1 },\r\n        { name: \"Nifty PSU Bank\", value: 26025, exchange: 1 },\r\n        { name: \"NIFTY FIN SERVICE\", value: 26037, exchange: 1 },\r\n        { name: \"NIFTY MID SELECT\", value: 26074, exchange: 1 },\r\n        { name: \"SENSEX\", value: 1, exchange: 6 },\r\n        { name: \"BANKNIFTY24AUGFUT\", value: 35089, exchange: 2 },\r\n        { name: \"FINNIFTY24AUGFUT\", value: 35073, exchange: 2 },\r\n        { name: \"USDINR24AUGFUT\", value: 1237, exchange: 3 },\r\n        { name: \"MIDCPNIFTY24SEPFUT\", value: 38958, exchange: 2 },\r\n        { name: \"BANKNIFTY24AUG51200PE\", value: 48010, exchange: 2 }\r\n    ]\r\n    //this.messages = [\r\n    /* Don't subscribe to exchange messages\r\n    { \"a\": \"subscribe\", \"v\": [1], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [2], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [3], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [6], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [7], \"m\": \"exchange_messages\" },\r\n    { \"a\": \"subscribe\", \"v\": [4], \"m\": \"exchange_messages\" },*/\r\n    /*when m = \"compact_marketdata\" or \"greekdata\" or \"marketdata\", v = [[exchange, instrumentToken]]*/\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 10576]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26000]], \"m\": \"compact_marketdata\" },\r\n    /* { \"a\": \"subscribe\", \"v\": [[1, 26000]], \"m\": \"marketdata\" },\r\n    e.g. response message {\"topic\":\"DetailMarketDataMessage/1/26000\",\"msg\":{\"exchange\":1,\"instrumentToken\":26000,\"lastTradedPrice\":2501775,\"lastTradedTime\":1724764675,\"lastTradedQuantity\":0,\"volume\":0,\"bestBidPrice\":0,\"bestBidQuantity\":0,\"bestAskPrice\":0,\"bestAskQuantity\":0,\"totalBuyQuantity\":0,\"totalSellQuantity\":0,\"averageTradePrice\":0,\"exchangeTimestamp\":1724764675,\"openPrice\":2502480,\"highPrice\":2507310,\"lowPrice\":2497365,\"closePrice\":2501060,\"yearlyHighPrice\":2507830,\"yearlyLowPrice\":1883785,\"lowDPR\":0,\"HighDPR\":0,\"currentOpenInterest\":0,\"initialOpenInterest\":0},\"timestamp\":1724775185218},*/\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26008]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26009]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26013]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26023]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26037]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[1, 26074]], \"m\": \"compact_marketdata\" },\r\n    //{ \"a\": \"subscribe\", \"v\": [[6, 1]], \"m\": \"compact_marketdata\" },\r\n    /*{ \"a\": \"subscribe\", \"v\": [[2, 48010]], \"m\": \"compact_marketdata\" },\r\n    { \"a\": \"subscribe\", \"v\": [[2, 48010]], \"m\": \"greekdata\" }\r\n    e.g. response message {\"topic\":\"GreekData/2/48010\",\"msg\":{\"exchange\":2,\"instrumentToken\":48010,\"underlyingToken\":26009,\"exchangeTimestamp\":1724752800,\"delta\":\"516115\",\"gamma\":\"1137\",\"vega\":\"10676518\",\"rho\":\"-727607\",\"theta\":\"-62623489\",\"iv\":\"13094074\",\"ltt\":1724752799,\"ltq\":15,\"ltp\":14775,\"currentOpenInterest\":1651860,\"initialOpenInterest\":1176300},\"timestamp\":1724775185241},*/\r\n    /*{ \"a\": \"unsubscribe\", \"v\": [[1, 26009]], \"m\": \"compact_marketdata\" },\r\n    { \"a\": \"unsubscribe\", \"v\": [[1, 26000]], \"m\": \"compact_marketdata\" },*/\r\n    //]\r\n    this._sendHeartbeat = function () {\r\n        var e = this;\r\n        if (e.HearbeatIntervalID) {\r\n            clearInterval(e.HearbeatIntervalID)\r\n            e.HearbeatIntervalID = undefined\r\n        }\r\n        e.HearbeatIntervalID = setInterval((function () {\r\n            e._socket && e._socket.readyState === WebSocket.OPEN && e._socket.send('{\"a\":\"h\",\"v\":[],\"m\":\"\"}')\r\n        }), 9500)\r\n    }\r\n\r\n    this.subscribe = function (exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback) {\r\n        var topicObj = this.getTopicObj(exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\r\n        var topicName = this.getTopicName(exchangeCode, instrumentToken, subscriptionType);\r\n        this._topics[topicName] = topicObj[topicName];\r\n        if (this.isSocketOpen()) {\r\n            this._socket.send(JSON.stringify(topicObj[topicName][\"message\"]));\r\n        }\r\n        return topicName;\r\n    };\r\n\r\n    this.getTopicName = function (exchangeCode: number, instrumentToken: number, subscriptionType: string) {\r\n        return subscriptionType.concat(\"/\", exchangeCode + \"/\" + instrumentToken);\r\n    }\r\n\r\n    this.getTopicObj = function (exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback) {\r\n        var message = { \"a\": \"subscribe\", \"v\": [[exchangeCode, instrumentToken]], \"m\": \"compact_marketdata\" };\r\n        var topicName = this.getTopicName(exchangeCode, instrumentToken, subscriptionType);\r\n        return { [topicName]: { message: message, subscriptions: [{ callback: callback, subscriptionLocation: subscriptionLocation }] } };\r\n    }\r\n\r\n    this.unsubscribe = function (topicName) {\r\n        var message = this._topics[topicName][\"message\"]\r\n        Object.assign(message, { \"a\": \"unsubscribe\" });\r\n        if (message && this.isSocketOpen()) {\r\n            this._socket.send(JSON.stringify(message));\r\n            delete this._topics[topicName];\r\n        }\r\n    };\r\n\r\n    this.unsubscribeAll = function () {\r\n        Object.keys(this._topics).forEach((topic) => {\r\n            this.unsubscribe(topic);\r\n        });\r\n    };\r\n\r\n    this._sendHeartbeat.bind(this)\r\n    this.windowOnBeforeUnload = function () {\r\n        console.log(\"Unloading\")\r\n        this.closeSocket(false);\r\n        //Keep returnValue true to let user see the message Changes may not be saved...\r\n        //event.returnValue = true;\r\n    }\r\n    this.isSocketOpen = () => this._socket && this._socket.readyState === WebSocket.OPEN\r\n    this.closeSocket = function (shouldReopen) {\r\n        if (this.isSocketOpen()) {\r\n            this.shouldReopenSocket = shouldReopen\r\n            this.unsubscribeAll()\r\n            this._socket.close();\r\n            this._socket = undefined;\r\n            if (this.HearbeatIntervalID) {\r\n                clearInterval(this.HearbeatIntervalID)\r\n                this.HearbeatIntervalID = undefined\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    this.writeToHtml = async function (msg) {\r\n        if (msg.msg) {\r\n            msg.msg.timestamp = Date.now()\r\n            msg.msg.topic = msg?.topic\r\n            if (this.container && msg.msg) {\r\n                //console.log(msg.msg);\r\n                await Excel.run(async (context) => {\r\n                    let sheet = context.workbook.worksheets.getItem(\"Trades\");\r\n                    //let randomResult = context.workbook.functions.randBetween(1, 3000).load(\"value\");\r\n                    let table = sheet.tables.getItem(\"TradesTable\")\r\n                    let tableRange = table.getRange();\r\n                    //console.log((new Date()).toISOString())\r\n                    let foundRange = await findTextInRange(context, msg.msg.instrumentToken, tableRange.getColumn(2), 1)\r\n                    //console.log((new Date()).toISOString())\r\n                    if (foundRange != undefined) {\r\n                        let rowRange = table.rows.getItemAt(foundRange.rowIndex - 1).getRange().getOffsetRange(0, 3).getResizedRange(0, -3 - 5)//Column D to M. Subtract 5 to remove column N to R\r\n                        rowRange.load([\"address\", \"rowCount\", \"columnCount\"]);\r\n                        await context.sync();\r\n                        //console.log(`Found ${msg.msg.instrumentToken} ${foundRange.rowIndex} ${foundRange.address}`);\r\n                        //console.log(`${rowRange.address} ${rowRange.rowCount} ${rowRange.columnCount}`)\r\n                        let newValues = [];\r\n                        msg.msg = __convert_prices(msg.msg, __exchange_price_multipliers[msg.msg['exchange']])\r\n                        newValues.push(...Object.keys(msg.msg))\r\n                        if (newValues.length == rowRange.columnCount) {\r\n                            let newValue = [newValues];\r\n                            //console.log(newValue)\r\n                            rowRange.values = newValue;\r\n                        }\r\n                        await context.sync();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    \r\n    this.connect = function () {\r\n        var e = this;\r\n        return new Promise(((_value, _callback) => {//Check this line with orginal code\r\n            e._socket = new WebSocket(e.uri)\r\n            e._socket.binaryType = \"arraybuffer\"\r\n            e._socket.onopen = function () {\r\n                e._reconnectionTimeout = 0\r\n                Object.values(e._topics).forEach((function (t) {\r\n                    if (t[\"message\"])\r\n                        e._socket.send(JSON.stringify(t[\"message\"]))\r\n                }))\r\n                e._sendHeartbeat();\r\n            }\r\n            e._socket.onmessage = function (t) {\r\n                var a = t.data;\r\n                try {\r\n                    var n = function (e) {\r\n                        var t = new DataView(e), a = {};\r\n                        switch (t.getInt8(0)) {\r\n                            case 15:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        underlyingToken: e.getInt32(6),\r\n                                        exchangeTimestamp: e.getInt32(10),\r\n                                        delta: e.getBigInt64(14),\r\n                                        gamma: e.getBigInt64(22),\r\n                                        vega: e.getBigInt64(30),\r\n                                        rho: e.getBigInt64(38),\r\n                                        theta: e.getBigInt64(46),\r\n                                        iv: e.getBigInt64(54),\r\n                                        ltt: e.getInt32(62),\r\n                                        ltq: e.getInt32(66),\r\n                                        ltp: e.getInt32(70),\r\n                                        currentOpenInterest: e.getInt32(74),\r\n                                        initialOpenInterest: e.getInt32(78)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"GreekData/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 1:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        lastTradedPrice: e.getInt32(6),\r\n                                        lastTradedTime: e.getInt32(10),\r\n                                        lastTradedQuantity: e.getInt32(14),\r\n                                        volume: e.getInt32(18),\r\n                                        bestBidPrice: e.getInt32(22),\r\n                                        bestBidQuantity: e.getInt32(26),\r\n                                        bestAskPrice: e.getInt32(30),\r\n                                        bestAskQuantity: e.getInt32(34),\r\n                                        totalBuyQuantity: e[\"getInt64\"](38),\r\n                                        totalSellQuantity: e[\"getInt64\"](46),\r\n                                        averageTradePrice: e.getInt32(54),\r\n                                        exchangeTimestamp: e.getInt32(58),\r\n                                        openPrice: e.getInt32(62),\r\n                                        highPrice: e.getInt32(66),\r\n                                        lowPrice: e.getInt32(70),\r\n                                        closePrice: e.getInt32(74),\r\n                                        yearlyHighPrice: e.getInt32(78),\r\n                                        yearlyLowPrice: e.getInt32(82),\r\n                                        lowDPR: e.getInt32(86),\r\n                                        HighDPR: e.getInt32(90),\r\n                                        currentOpenInterest: e.getInt32(94),\r\n                                        initialOpenInterest: e.getInt32(98)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"DetailMarketDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 2:\r\n                                return a = function (e) {\r\n                                    return 42 === e.byteLength ? {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        ltp: e.getInt32(6),\r\n                                        change: e.getInt32(10),\r\n                                        ltt: e.getInt32(14),\r\n                                        lowDpr: e.getInt32(18),\r\n                                        highDpr: e.getInt32(22),\r\n                                        currentOpenInterest: e.getInt32(26),\r\n                                        initialOpenInterest: e.getInt32(30),\r\n                                        bidPrice: e.getInt32(34),\r\n                                        askPrice: e.getInt32(38)\r\n                                    } : 46 === e.byteLength ? {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        ltp: e.getInt32(6),\r\n                                        change: e.getInt32(10),\r\n                                        ltt: e.getInt32(14),\r\n                                        lowDpr: e.getInt32(18),\r\n                                        highDpr: e.getInt32(22),\r\n                                        currentOpenInterest: e.getInt32(26),\r\n                                        initialOpenInterest: e.getInt32(30),\r\n                                        bidPrice: e.getInt32(34),\r\n                                        askPrice: e.getInt32(38),\r\n                                        ltq: e.getInt32(42)\r\n                                    } : {\r\n                                        exchange: 0,\r\n                                        instrumentToken: 0,\r\n                                        ltp: 0,\r\n                                        change: 0,\r\n                                        ltt: 0,\r\n                                        lowDpr: 0,\r\n                                        highDpr: 0,\r\n                                        currentOpenInterest: 0,\r\n                                        initialOpenInterest: 0,\r\n                                        bidPrice: 0,\r\n                                        askPrice: 0,\r\n                                        ltq: 0\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"CompactMarketDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 4:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        buyers: [e.getInt32(6), e.getInt32(10), e.getInt32(14), e.getInt32(18), e.getInt32(22)],\r\n                                        bidPrices: [e.getInt32(26), e.getInt32(30), e.getInt32(34), e.getInt32(38), e.getInt32(42)],\r\n                                        bidQtys: [e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58), e.getInt32(62)],\r\n                                        sellers: [e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78), e.getInt32(82)],\r\n                                        askPrices: [e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98), e.getInt32(102)],\r\n                                        askQtys: [e.getInt32(106), e.getInt32(110), e.getInt32(114), e.getInt32(118), e.getInt32(122)],\r\n                                        averageTradePrice: e.getInt32(126),\r\n                                        open: e.getInt32(130),\r\n                                        high: e.getInt32(134),\r\n                                        low: e.getInt32(138),\r\n                                        close: e.getInt32(142),\r\n                                        totalBuyQty: e[\"getInt64\"](146),\r\n                                        totalSellQty: e[\"getInt64\"](154),\r\n                                        volume: e.getInt32(162)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"SnapquoteDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 5:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken1: e.getInt32(2),\r\n                                        instrumentToken2: e.getInt32(6),\r\n                                        exchangeTimestamp: e.getInt32(10),\r\n                                        totalBuyers: e.getInt32(14),\r\n                                        totalSellers: e.getInt32(18),\r\n                                        buyers: [e.getInt32(22), e.getInt32(26), e.getInt32(30), e.getInt32(34), e.getInt32(38)],\r\n                                        bidPrices: [e.getInt32(42), e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58)],\r\n                                        bidQtys: [e.getInt32(62), e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78)],\r\n                                        sellers: [e.getInt32(82), e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98)],\r\n                                        askPrices: [e.getInt32(102), e.getInt32(106), e.getInt32(110), e.getInt32(114), e.getInt32(118)],\r\n                                        askQtys: [e.getInt32(122), e.getInt32(126), e.getInt32(130), e.getInt32(134), e.getInt32(138)],\r\n                                        volume: e.getInt32(142),\r\n                                        totalTradeValue: e[\"getInt64\"](146),\r\n                                        totalBuyQty: e[\"getInt64\"](154),\r\n                                        totalSellQty: e[\"getInt64\"](162),\r\n                                        open: e.getInt32(170),\r\n                                        high: e.getInt32(174),\r\n                                        low: e.getInt32(178),\r\n                                        ltp: e.getInt32(182),\r\n                                        lastTradedPrice: e.getInt32(182),\r\n                                        ltt: e.getInt32(186),\r\n                                        lowDpr: e.getInt32(190),\r\n                                        highDpr: e.getInt32(194),\r\n                                        closePrice: e.getInt32(198),\r\n                                        close: e.getInt32(198),\r\n                                        averageTradePrice: 206 === e.byteLength ? e.getInt32(202) : 0\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"SpreadMarketUpdate/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken1\"], \"-\").concat(a[\"instrumentToken2\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 9:\r\n                                return a = function (e) {\r\n                                    var t = e.getInt8(1)\r\n                                        , a = e.getInt16(2)\r\n                                        , n = e[\"getString\"](4, a)\r\n                                        , r = 4 + a\r\n                                        , i = e.getInt16(r)\r\n                                        , l = r + 2\r\n                                        , c = l + i;\r\n                                    return {\r\n                                        exchange: t,\r\n                                        marketType: n,\r\n                                        message: e[\"getString\"](l, i),\r\n                                        timestamp: e.getInt32(c)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"MktStatus/\".concat(a[\"exchange\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 10:\r\n                                return a = function (e) {\r\n                                    var t = e.getInt8(1), a = e.getInt16(2), n = 4 + a;\r\n                                    return {\r\n                                        exchange: t,\r\n                                        message: e[\"getString\"](4, a),\r\n                                        timestamp: e.getInt32(n)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"ExchangeMessage/\".concat(a[\"exchange\"]),\r\n                                    msg: a\r\n                                };\r\n                            case 11:\r\n                                return {\r\n                                    topic: \"OrderUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 12:\r\n                                return {\r\n                                    topic: \"TradeUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 14:\r\n                                return a = function (e) {\r\n                                    return {\r\n                                        exchange: e.getInt8(1),\r\n                                        instrumentToken: e.getInt32(2),\r\n                                        lastTradePrice: e.getInt32(14),\r\n                                        lastTradeQuantity: e.getInt32(18),\r\n                                        totalTradeQuantity: e[\"getInt64\"](22),\r\n                                        buyers: [e.getInt32(30), e.getInt32(34), e.getInt32(38), e.getInt32(42), e.getInt32(46), e.getInt32(50), e.getInt32(54), e.getInt32(58), e.getInt32(62), e.getInt32(66), e.getInt32(70), e.getInt32(74), e.getInt32(78), e.getInt32(82), e.getInt32(86), e.getInt32(90), e.getInt32(94), e.getInt32(98), e.getInt32(102), e.getInt32(106)],\r\n                                        bidPrices: [e.getInt32(110), e.getInt32(114), e.getInt32(118), e.getInt32(122), e.getInt32(126), e.getInt32(130), e.getInt32(134), e.getInt32(138), e.getInt32(142), e.getInt32(146), e.getInt32(150), e.getInt32(154), e.getInt32(158), e.getInt32(162), e.getInt32(166), e.getInt32(170), e.getInt32(174), e.getInt32(178), e.getInt32(182), e.getInt32(186)],\r\n                                        bidQtys: [e.getInt32(190), e.getInt32(194), e.getInt32(198), e.getInt32(202), e.getInt32(206), e.getInt32(210), e.getInt32(214), e.getInt32(218), e.getInt32(222), e.getInt32(226), e.getInt32(230), e.getInt32(234), e.getInt32(238), e.getInt32(242), e.getInt32(246), e.getInt32(250), e.getInt32(254), e.getInt32(258), e.getInt32(262), e.getInt32(266)],\r\n                                        sellers: [e.getInt32(270), e.getInt32(274), e.getInt32(278), e.getInt32(282), e.getInt32(286), e.getInt32(290), e.getInt32(294), e.getInt32(298), e.getInt32(302), e.getInt32(306), e.getInt32(310), e.getInt32(314), e.getInt32(318), e.getInt32(322), e.getInt32(326), e.getInt32(330), e.getInt32(334), e.getInt32(338), e.getInt32(342), e.getInt32(346)],\r\n                                        askPrices: [e.getInt32(350), e.getInt32(354), e.getInt32(358), e.getInt32(362), e.getInt32(366), e.getInt32(370), e.getInt32(374), e.getInt32(378), e.getInt32(382), e.getInt32(386), e.getInt32(390), e.getInt32(394), e.getInt32(398), e.getInt32(402), e.getInt32(406), e.getInt32(410), e.getInt32(414), e.getInt32(418), e.getInt32(422), e.getInt32(426)],\r\n                                        askQtys: [e.getInt32(430), e.getInt32(434), e.getInt32(438), e.getInt32(442), e.getInt32(446), e.getInt32(450), e.getInt32(454), e.getInt32(458), e.getInt32(462), e.getInt32(466), e.getInt32(470), e.getInt32(474), e.getInt32(478), e.getInt32(482), e.getInt32(486), e.getInt32(490), e.getInt32(494), e.getInt32(498), e.getInt32(502), e.getInt32(506)],\r\n                                        averageTradePrice: e.getInt32(510),\r\n                                        open: e.getInt32(514),\r\n                                        high: e.getInt32(518),\r\n                                        low: e.getInt32(522),\r\n                                        close: e.getInt32(526),\r\n                                        totalBuyQty: e[\"getInt64\"](530),\r\n                                        totalSellQty: e[\"getInt64\"](538),\r\n                                        volume: e.getInt32(546)\r\n                                    }\r\n                                }(t) || {},\r\n                                {\r\n                                    topic: \"TbtSnapquoteDataMessage/\".concat(a[\"exchange\"], \"/\").concat(a[\"instrumentToken\"]),\r\n                                    /***msg: Jt(a)*/\r\n                                };\r\n                            case 50:\r\n                                return {\r\n                                    topic: \"OrderUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 51:\r\n                                return {\r\n                                    topic: \"TradeUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            case 58:\r\n                                return {\r\n                                    topic: \"PositionUpdate\",\r\n                                    /***msg: a = Vt(t) || {}*/\r\n                                };\r\n                            default:\r\n                                return {}\r\n                        }\r\n                    }(a)\r\n                    //e.writeToHtml(n);\r\n                    n.msg = __convert_prices(n.msg, __exchange_price_multipliers[n.msg['exchange']])\r\n                    let r = n.topic;\r\n                    ((e._topics[r] || {}).subscriptions || []).forEach((function (subscription) {\r\n                        return (0,\r\n                            subscription.callback)(n)\r\n                    }\r\n                    ))\r\n                } catch (i) {\r\n                    console.log(i)\r\n                }\r\n            }\r\n            e._socket.onclose = function () {\r\n                if (e.shouldReopenSocket) {\r\n                    setTimeout((function () {\r\n                        return e.connect()\r\n                    }\r\n                    ), 1e3)\r\n                }\r\n            }\r\n            e._socket.onerror = function (t) {\r\n                console.log(\"Socket encountered error: \".concat(t.message, \", closing socket\"));\r\n                if (e.isSocketOpen())\r\n                    e._socket.close();\r\n            }\r\n        }))\r\n    }//this.connect.bind(this),\r\n    this.wsHandler = function (e /*messageType, subscriptionLocation, payload*/) {\r\n        var t = this\r\n            , a = e.messageType\r\n            , r = e.subscriptionLocation\r\n            , i = e.payload, Gt = [\"ClientAlerts\", \"OrderUpdate\", \"TradeUpdate\", \"AdminMessage\", \"PositionUpdate\", \"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\", \"MktStatus\", \"ExchangeMessage\"]\r\n            , l = function (e) {\r\n                var t = e.messageType\r\n                    , a = e.payload //exchangeCode and instrumentToken when t=e.messageType is in [\"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\"]\r\n                    , n = void 0 === a ? {} : a;\r\n                if (!(t in Gt))\r\n                    throw \"\".concat(t, \" not supported\");\r\n                if ([\"ClientAlerts\", \"OrderUpdate\", \"TradeUpdate\", \"AdminMessage\", \"PositionUpdate\"].includes(t))\r\n                    return \"\".concat(t);\r\n                if ([\"DetailMarketDataMessage\", \"CompactMarketDataMessage\", \"SnapquoteDataMessage\", \"TbtSnapquoteDataMessage\", \"SpreadMarketUpdate\", \"TbtUpdate\", \"GreekData\"].includes(t)) {\r\n                    var r = n.exchangeCode\r\n                        , i = n.instrumentToken;\r\n                    if (!r || !i)\r\n                        throw \"missing exchangeCode: \".concat(r, \" or instrumentToken: \").concat(i);\r\n                    return \"\".concat(t, \"/\").concat(r, \"/\").concat(i)\r\n                }\r\n                if ([\"MktStatus\", \"ExchangeMessage\"].includes(t)) {\r\n                    var l = n.exchangeCode;\r\n                    if (!l)\r\n                        throw \"missing exchangeCode: \".concat(l);\r\n                    return \"\".concat(t, \"/\").concat(l)\r\n                }\r\n                throw \"invalid messageType: \".concat(t)\r\n            }({\r\n                messageType: a,\r\n                payload: i\r\n            })\r\n            , c = function (e) {\r\n                var t = e.messageType\r\n                    , a = e.actionType\r\n                    , n = e.payload\r\n                    , r = void 0 === n ? {} : n;\r\n                switch (t) {\r\n                    case \"SpreadMarketUpdate\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"spreaddata\"\r\n                        };\r\n                    case \"DetailMarketDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"marketdata\"\r\n                        };\r\n                    case \"CompactMarketDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"compact_marketdata\"\r\n                        };\r\n                    case \"SnapquoteDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"full_snapquote\"\r\n                        };\r\n                    case \"TbtSnapquoteDataMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"tbt_full_snapquote\"\r\n                        };\r\n                    case \"OrderUpdate\":\r\n                        return {\r\n                            a: a,\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"updates\"\r\n                        };\r\n                    case \"TradeUpdate\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"updates\"\r\n                        };\r\n                    case \"ExchangeMessage\":\r\n                        return {\r\n                            a: a,\r\n                            v: [r.exchangeCode],\r\n                            m: \"exchange_messages\"\r\n                        };\r\n                    case \"PositionUpdate\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [localStorage.getItem(\"login_id\"), \"web\"],\r\n                            m: \"position_updates\"\r\n                        };\r\n                    case \"GreekData\":\r\n                        return {\r\n                            a: \"subscribe\",\r\n                            v: [[r.exchangeCode, r.instrumentToken]],\r\n                            m: \"greekdata\"\r\n                        };\r\n                    default:\r\n                        return {}\r\n                }\r\n            }({\r\n                messageType: a,\r\n                payload: i,\r\n                actionType: \"subscribe\"\r\n            })\r\n            , o = JSON.stringify(Object.assign(c, {\r\n                a: \"subscribe\"\r\n            }))\r\n            , s = JSON.stringify(Object.assign(c, {\r\n                a: \"unsubscribe\"\r\n            }));\r\n        return {\r\n            subscribe: function (e) {\r\n                return new Promise((function (n, i) {\r\n                    t._topics[l] || (t._topics[l] = {\r\n                        subscriptionObj: o,\r\n                        subscriptions: [] //subscriptionLocation, callback\r\n                    }),\r\n                        Boolean(t._topics[l].subscriptions.filter((function (e) {\r\n                            return e.subscriptionLocation === r\r\n                        }\r\n                        )).length) ? i(\"\".concat(a, \" already subscribed from \").concat(r)) : (t._socket && t._socket.readyState === WebSocket.OPEN ? (t._topics[l].subscriptions.length && t._socket.send(s),\r\n                            t._socket.send(o),\r\n                            n(\"subscribed\")) : i(\"socket not connect, \".concat(a, \" will be auto subscribed later\")),\r\n                            t._topics[l].subscriptions.push({\r\n                                subscriptionLocation: r,\r\n                                callback: e\r\n                            }))\r\n                }\r\n                ))\r\n            },\r\n            unsubscribe: function () {\r\n                return new Promise((function (e, n) {\r\n                    var c = (t._topics[l] || []).subscriptions || []\r\n                        , o = c.filter((function (e) {\r\n                            return e.subscriptionLocation !== r\r\n                        }\r\n                        ));\r\n                    var Wt = function (a1, b1, c1) {\r\n                        for (var e, t = arguments.length, a = new Array(t), n = 0; n < t; n++)\r\n                            a[n] = arguments[n];\r\n                        (e = console).log.apply(e, [\"Octopus\"].concat(a))\r\n                    }\r\n                    o.length === c.length ? (Wt(a, r, i),\r\n                        n(\"subscription does not exists\")) : (t._topics[l].subscriptions = o,\r\n                            e(\"unsubscribed\"),\r\n                            0 === o.length && t._socket && t._socket.send(s))\r\n                }\r\n                ))\r\n            }\r\n        }\r\n    }//this.wsHandler.bind(this),\r\n\r\n\r\n    this.initSocket = function (acctoken, symbolDetailsObj) {\r\n        if (this.isSocketOpen())\r\n            this.closeSocket(false)\r\n        this.args.token = acctoken\r\n        this.uri = \"wss://\".concat(this.args.host).concat(this.args.path, \"?login_id=\").concat(this.args.loginId, \"&token=\").concat(this.args.token, \"&device=web\");\r\n        if (symbolDetailsObj)\r\n            Object.assign(this._topics, symbolDetailsObj)\r\n        this.connect()\r\n    }\r\n}\r\n\r\nexport async function findTextInRange(context: Excel.RequestContext, textToFind: string, rangeToSearch: Excel.Range, columnOffset: number) {\r\n    try {\r\n        let foundRange = rangeToSearch.find(textToFind + \"\", { completeMatch: true, matchCase: false, searchDirection: Excel.SearchDirection.forward });\r\n        if (columnOffset && columnOffset > 0)\r\n            foundRange = foundRange.getOffsetRange(0, columnOffset);\r\n        foundRange.load([\"address\", \"rowIndex\"]);\r\n        await context.sync();\r\n        return foundRange;\r\n    } catch (error) {\r\n        // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\r\n        console.error(error);\r\n    }\r\n    return undefined;\r\n}\r\nexport function processNumber(key: string, val: any): any {\r\n    return \r\n}\r\nfunction __convert_prices(dictionary, multiplier) {\r\n    let keysToIgnore = [\"exchange\", \"instrumentToken\", \"timestamp\", \"topic\"];\r\n    let keys = ['ltp', 'best_bid_price', 'best_ask_price', 'atp',\r\n        'open', 'high', 'low', 'close',\r\n        'yearly_high', 'yearly_low', 'lowDpr', 'highDpr',\r\n        'bidPrice', 'askPrice', 'change'\r\n    ];\r\n    keys.forEach((key) => {\r\n        if (key in dictionary)\r\n            dictionary[key] = dictionary[key] / multiplier;\r\n    });\r\n    let multiple_value_keys = ['bid_prices', 'ask_prices']\r\n    multiple_value_keys.forEach((key) => {\r\n        if (key in dictionary) {\r\n            let new_values = [];\r\n            for (let value in dictionary[key])\r\n                new_values.push(parseInt(value) / multiplier);\r\n            dictionary[key] = new_values;\r\n        }\r\n    });\r\n    \r\n    return dictionary;\r\n}\r\n\r\n/*function __convert_instrument(dictionary) {\r\n    if (('exchange' in dictionary) && ('token' in dictionary))\r\n        dictionary['instrument'] = get_instrument_by_token(dictionary['exchange'], dictionary['token'])\r\n    return dictionary;\r\n}*/\r\nexport function convertExchange(exchange) {\r\n    let exchangeCode = parseInt(__exchange_codes[exchange]);\r\n    if (isNaN(exchangeCode))\r\n        return 1;\r\n    return exchangeCode\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","import { flattenJson, flattenJsonObj } from \"./gdrive-functions\";\nimport { convertExchange, SASSocket } from \"./sas\";\nimport { UrlFetchApp } from \"./URLFetchApp\";\n\n/* global clearInterval, console, CustomFunctions, setInterval */\n\n\n/**\n * Provides live stock updates for SAS Online. e.g. ticker(\"NSE\", 26000, \"CompactMarketDataMessage\", \"excel\")\n * @customfunction\n * @param chartUrl URL of Chart Page taken from SAS Online\n * @param exchangeName Name of exchange like NSE, Check __exchange_codes\n * @param instrumentToken Token code of scrip\n * @param subscriptionType Type of subscription like CompactMarketDataMessage\n * @param subscriptionLocation Location of subscription like app-navbar\n */\nexport function ticker(chartUrl: string, exchangeName: string, instrumentToken: number, subscriptionType, subscriptionLocation, invocation: CustomFunctions.StreamingInvocation<number[][]>): void {//CustomFunctions.StreamingInvocation<number[][]>): void {\n  let objName = \"sasObj\";\n  let callback = (msg) => {\n    //let keysToIgnore = [\"exchange\", \"instrumentToken\", \"timestamp\", \"topic\"];\n    //let newValues = [];\n    //Object.keys(msg.msg).forEach((key) => keysToIgnore.indexOf(key) <= -1 ? newValues.push(processNumber(key, msg.msg[key])) : \"\");\n    let retValue = [Object.values(msg?.msg).map((value) => parseFloat(value + \"\"))];\n    invocation.setResult(retValue);\n  };\n  let exchangeCode = convertExchange(exchangeName);\n  let topic = getTopicName(exchangeCode, instrumentToken, subscriptionType);\n  if(window[objName] === void 0)\n    window[objName] = getOrInitialize(chartUrl, objName, exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n  else\n    topic = window[objName].subscribe(exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n\n  invocation.onCanceled = () => {\n    window[objName].unsubscribe(topic);\n  };\n}\n\n\n/**\n * Allows importing json data and flatten it into tabular format\n * @customfunction\n * @param url URL to post/fetch data\n * @param successField Response Json key to check for success response \n * @param successFieldValue Value of Response Json key to check for success response\n * @param flattenArrayPath Array from response JSON to flatten into table\n * @param queryParam URL Query string for which repeated api calls need to be made\n * @param queryParamValues String value, seperated by \";\", of URL Query string for which repeated api calls need to be made\n */\nexport async function ImportJson(url, successField, successFieldValue, flattenArrayPath, queryParam = \"\", queryParamValues = \"\") {\n  //url=\"https://alphaapi.sasonline.in/api/v1/search?\"\n  //successField = \"error.code\", successFieldValue=0, flattenArrayPath=\"result\",queryParam=\"key\", queryParamValues=\"INDIGO\"\n  //url=\"https://alpha.sasonline.in/api/v1/optionchain/NFO?token=26009&num=18&price=49911.2\"\n  //successField = \"error.code\", successFieldValue=0, flattenArrayPath=\"result[0].strikes\"\n  if(queryParam == null || queryParam == \"\") {\n    return GetArrayFromJson(url, successField, successFieldValue, flattenArrayPath);\n  } else {\n    var results: any[][] = [];\n    var paramValues = queryParamValues.split(\";\");\n    for(var i = 0; i < paramValues.length; i++) {\n      if(paramValues[i]!=\"\") {\n        var tempResults = await GetArrayFromJson(url + \"&\" + queryParam + \"=\" + paramValues[i], successField, successFieldValue, flattenArrayPath);\n        if(tempResults)\n          results.push(...tempResults);\n      }\n    }\n    return results;\n  }\n}\n\n\n\n/**\n * Allows accessing api and flattens returned json data into tabular format\n * @customfunction\n * @param url URL to post/fetch data\n * @param method HttpMethod\n * @param requestBody Body of the request if POST call\n * @param flattenArrayPath Array from response JSON to flatten into table\n * @param flattenObjPath Object key from response JSON to flatten\n * @param authToken Access Token if accessing secured endpoint\n * @param confirmationMessage Message for confirmation\n */\nexport async function WebApiRequest(url, method, requestBody=\"\", flattenArrayPath=\"\", flattenObjPath=\"\", authToken = undefined, confirmationMessage = \"\") {\n  /*url=\"https://alpha.sasonline.in/api/v1/calculator\",\n  method=\"post\",\n  requestBody='[{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"BUY\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4000PE\",\"underlying\":\"11195\",\"token\":\"114138\",\"quantity\":\"300\",\"price\":\"9.85\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"SELL\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4200PE\",\"underlying\":\"11195\",\"token\":\"114142\",\"quantity\":\"300\",\"price\":\"26.7\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"SELL\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG4800CE\",\"underlying\":\"11195\",\"token\":\"114153\",\"quantity\":\"300\",\"price\":\"39.2\",\"product\":\"0\"},{\"segment\":\"FutOpt\",\"series\":\"OPTSTK\",\"exchange\":\"NFO\",\"side\":\"BUY\",\"mode\":\"NEW\",\"symbol\":\"INDIGO24AUG5000CE\",\"underlying\":\"11195\",\"token\":\"114157\",\"quantity\":\"300\",\"price\":\"17\",\"product\":\"0\"}]'\n  flattenArrayPath=\"result?.individual_margin_values\"\n  flattenObjPath = \"result?.combined_margin\"*/\n  /*url=\"https://alphaapi.sasonline.in/api/v1/funds/view?client_id=AG187&type=all\",method=\"get\",flattenArrayPath=\"data?.values\", flattenObjPath=\"\",authToken=\"\"*/\n  /*url=\"https://alphaapi.sasonline.in/api/v1/orders?type=pending&client_id=AG187\",method=\"get\",flattenArrayPath=\"data?.orders\", flattenObjPath=\"\",authToken=\"\"*/\n  /*url=\"https://alpha.sasonline.in/api/v1/contract/NSE?info=scrip&token=11195\",method=\"get\",flattenArrayPath=\"\", flattenObjPath=\"result\",authToken=\"\"*/\n  /*url=\"https://alpha.sasonline.in/api/v1/marketwatches/7ddfa505-983a-4536-97dc-03bb0c8b7404\",method=\"put\",\n  requestBody = '{\"mw_id\":\"7ddfa505-983a-4536-97dc-03bb0c8b7404\",\"exchange\":\"NFO\",\"trading_symbol\":\"BANKNIFTY2481451100CE\",\"token\":54965,\"execution\":\"NORMAL\"}'\n  flattenArrayPath=\"data\", flattenObjPath=\"\",authToken=\"\"*/\n  var results: any[][] = [];\n  var options = {\n    'method' : method\n  };\n  if((method == 'post' || method == 'put') && requestBody != \"\") {\n    options['body'] = requestBody;\n    options['headers'] = {\n      \"Accept\": \"application/json, text/plain, *//*\",\n      \"Content-Type\": \"application/json\"\n    }\n  }\n  if(authToken != undefined && authToken != \"\") {\n    options['headers'] = options['headers'] ?? {};\n    options['headers']['Authorization'] = \"Bearer \" + authToken;\n  }\n  let proceedForApiCall = false;\n  \n  if(confirmationMessage == null || confirmationMessage == \"\" || (confirmationMessage != \"\" && proceedForApiCall)) {\n    var responseJson = await UrlFetchApp.fetch(url, options);\n    if(flattenArrayPath!=\"\") {\n      var temp = flattenJson(eval(\"responseJson.\"+flattenArrayPath));\n      if(temp.length > 0)\n        results.push(...temp);\n    }\n\n    if(flattenObjPath!=\"\") {\n      var temp: (string | number | boolean)[][] = flattenJsonObj(eval(\"responseJson.\"+flattenObjPath));\n      if(temp.length > 0)\n        results.push(...temp);\n    }\n  }\n  return results;\n}\n\n\nasync function GetArrayFromJson(url, successField, successFieldValue, flattenArrayPath) {\n  var responseJson = await UrlFetchApp.fetch(url);\n  var results: (number|string|boolean)[][] = [];\n  var successFieldEval = eval(\"responseJson.\"+successField);\n  if(successFieldEval == successFieldValue) {\n    var flattenArrayPathSplit = flattenArrayPath.split(\";\");\n    for(var i = 0; i < flattenArrayPathSplit.length; i++) {\n      var tempPath = \"responseJson.\"+flattenArrayPathSplit[i];\n      var tempResults = flattenJson(eval(tempPath));\n      if(i>0) {\n        tempResults = tempResults.slice(1,-1);\n      }\n      results.push(...tempResults);\n    }\n    return results;\n  } \n}\n\n\nfunction getTopicName(exchangeCode: number, instrumentToken: number, subscriptionType: string) {\n  return subscriptionType.concat(\"/\", exchangeCode + \"/\" + instrumentToken);\n}\n\nfunction getOrInitialize(chartUrl, objName, exchangeCode: number, instrumentToken: number, subscriptionType, subscriptionLocation, callback): any {\n  if(window[objName] === void 0) {\n    let login_id = UrlFetchApp.getParameterByName(\"login_id\", chartUrl);\n    let login_token = UrlFetchApp.getParameterByName(\"login_token\", chartUrl);\n    window[objName] = new SASSocket({\n      host: \"alpha.sasonline.in\",//window.location.host,\n      path: \"/ws/v1/feeds\",\n      loginId: login_id,//localStorage.getItem(\"login_id\"),\n      //token: localStorage.getItem(\"token\")\n    })\n    let topicObj = window[objName][\"getTopicObj\"](exchangeCode, instrumentToken, subscriptionType, subscriptionLocation, callback);\n    window[objName][\"initSocket\"](login_token, topicObj)\n    if (window.addEventListener) {\n      window.addEventListener(\"beforeunload\", (event) => window[objName][\"windowOnBeforeUnload\"](event));\n    } else {\n      window.onbeforeunload = (event) => window[objName][\"windowOnBeforeUnload\"](event);\n    }\n  }\n  return window[objName];\n}\n\n\n/**\n         * Search for products that match a given substring. Try =SCRIPTLAB.DATATYPESCUSTOMFUNCTIONS.PRODUCTSEARCH(\"chef\", false).\n         * @customfunction\n         * @param {string} query The string to search for in the sample JSON data.\n         * @param {boolean} [completeMatch] Define whether the search should be a match of the whole product name or part of the product name. If omitted, completeMatch = false.\n         * @return {Promise<any[][]>} Search results as one or more data type entity values.\n         */\nasync function productSearch(query: string, completeMatch?: boolean): Promise<any[][]> {\n  // This function searches a set of sample JSON data for the string entered in the \n  // custom function, and then returns the search result as one or more entity values.\n\n  // Set up an error to use if a matching product doesn't exist in the JSON data.\n  const notAvailableError = {\n    type: \"Error\",\n    errorType: \"NotAvailable\"\n  };\n\n  // Search the sample JSON data for matching product names.\n  try {\n    if (completeMatch === null) {\n      completeMatch = false\n    }\n    \n    console.log(`Searching for ${query}...`);\n    const searchResult = await searchProduct(query, completeMatch);\n\n    // If the search result is empty, return the error.\n    if (searchResult.length == 0) {\n      return [[notAvailableError]];\n    }\n\n    // Create product entities for each of the products returned in the search result.\n    const entities = searchResult.map((product) => [makeProductEntity(product)]);\n    return entities;\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// Helper function to create entities from product properties.\nfunction makeProductEntity(product?: any) {\n  const entity: Excel.EntityCellValue = {\n    type: \"Entity\",\n    text: product.productName,\n    properties: {\n      \"Product ID\": {\n        type: \"String\",\n        basicValue: product.productID.toString() || \"\"\n      },\n      \"Product Name\": {\n        type: \"String\",\n        basicValue: product.productName || \"\"\n      },\n      \"Quantity Per Unit\": {\n        type: \"String\",\n        basicValue: product.quantityPerUnit || \"\"\n      },\n      // Add Unit Price as a formatted number.\n      \"Unit Price\": {\n        type: \"FormattedNumber\",\n        basicValue: product.unitPrice,\n        numberFormat: \"$* #,##0.00\"\n      },\n      Discontinued: {\n        type: \"Boolean\",\n        basicValue: product.discontinued || false\n      }\n    },\n    layouts: {\n      card: {\n        title: { property: \"Product Name\" },\n        sections: [\n          {\n            layout: \"List\",\n            properties: [\"Product ID\"]\n          },\n          {\n            layout: \"List\",\n            title: \"Quantity and price\",\n            collapsible: true,\n            collapsed: false,\n            properties: [\"Quantity Per Unit\", \"Unit Price\"]\n          },\n          {\n            layout: \"List\",\n            title: \"Additional information\",\n            collapsed: true,\n            properties: [\"Discontinued\"]\n          }\n        ]\n      }\n    }\n  };\n\n  // Add image property to the entity and then add it to the card layout.\n  if (product.productImage) {\n    entity.properties[\"Image\"] = {\n      type: \"WebImage\",\n      address: product.productImage || \"\"\n    };\n    entity.layouts.card.mainImage = { property: \"Image\" };\n  }\n  \n  return entity;\n}\n\n// Helper function to search the sample JSON product data.\nfunction searchProduct(query: string, completeMatch: boolean): any {\n  const queryUpperCase = query.toUpperCase();\n  if (completeMatch === true) {\n    return products.filter((p) => p.productName.toUpperCase() === queryUpperCase);\n  } else {\n    return products.filter((p) => p.productName.toUpperCase().indexOf(queryUpperCase) >= 0);\n  }\n}\n\n/** Sample JSON product data. */\nconst products = [\n  {\n    productID: 1,\n    productName: \"Chai\",\n    supplierID: 1,\n    categoryID: 1,\n    quantityPerUnit: \"10 boxes x 20 bags\",\n    unitPrice: 18,\n    discontinued: false,\n    productImage: \"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG\"\n  },\n  {\n    productID: 2,\n    productName: \"Chang\",\n    supplierID: 1,\n    categoryID: 1,\n    quantityPerUnit: \"24 - 12 oz bottles\",\n    unitPrice: 19,\n    discontinued: false,\n    productImage: \"\"\n  },\n  {\n    productID: 3,\n    productName: \"Aniseed Syrup\",\n    supplierID: 1,\n    categoryID: 2,\n    quantityPerUnit: \"12 - 550 ml bottles\",\n    unitPrice: 10,\n    discontinued: false,\n    productImage: \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Maltose_syrup.jpg/185px-Maltose_syrup.jpg\"\n  },\n  {\n    productID: 4,\n    productName: \"Chef Anton's Cajun Seasoning\",\n    supplierID: 2,\n    categoryID: 2,\n    quantityPerUnit: \"48 - 6 oz jars\",\n    unitPrice: 22,\n    discontinued: false,\n    productImage:\n      \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Kruidenmengeling-spice.jpg/193px-Kruidenmengeling-spice.jpg\"\n  },\n  {\n    productID: 5,\n    productName: \"Chef Anton's Gumbo Mix\",\n    supplierID: 2,\n    categoryID: 2,\n    quantityPerUnit: \"36 boxes\",\n    unitPrice: 21.35,\n    discontinued: true,\n    productImage:\n      \"https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Okra_in_a_Bowl_%28Unsplash%29.jpg/180px-Okra_in_a_Bowl_%28Unsplash%29.jpg\"\n  },\n  {\n    productID: 6,\n    productName: \"Grandma's Boysenberry Spread\",\n    supplierID: 3,\n    categoryID: 2,\n    quantityPerUnit: \"12 - 8 oz jars\",\n    unitPrice: 25,\n    discontinued: false,\n    productImage:\n      \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Making_cranberry_sauce_-_in_the_jar.jpg/90px-Making_cranberry_sauce_-_in_the_jar.jpg\"\n  },\n  {\n    productID: 7,\n    productName: \"Uncle Bob's Organic Dried Pears\",\n    supplierID: 3,\n    categoryID: 7,\n    quantityPerUnit: \"12 - 1 lb pkgs.\",\n    unitPrice: 30,\n    discontinued: false,\n    productImage: \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/DriedPears.JPG/120px-DriedPears.JPG\"\n  },\n  {\n    productID: 8,\n    productName: \"Northwoods Cranberry Sauce\",\n    supplierID: 3,\n    categoryID: 2,\n    quantityPerUnit: \"12 - 12 oz jars\",\n    unitPrice: 40,\n    discontinued: false,\n    productImage:\n      \"https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Making_cranberry_sauce_-_stovetop.jpg/90px-Making_cranberry_sauce_-_stovetop.jpg\"\n  },\n  {\n    productID: 9,\n    productName: \"Mishi Kobe Niku\",\n    supplierID: 4,\n    categoryID: 6,\n    quantityPerUnit: \"18 - 500 g pkgs.\",\n    unitPrice: 97,\n    discontinued: true,\n    productImage: \"\"\n  },\n  {\n    productID: 10,\n    productName: \"Ikura\",\n    supplierID: 4,\n    categoryID: 8,\n    quantityPerUnit: \"12 - 200 ml jars\",\n    unitPrice: 31,\n    discontinued: false,\n    productImage: \"\"\n  },\n];\n\nconst categories = [\n  {\n    categoryID: 1,\n    categoryName: \"Beverages\",\n    description: \"Soft drinks, coffees, teas, beers, and ales\"\n  },\n  {\n    categoryID: 2,\n    categoryName: \"Condiments\",\n    description: \"Sweet and savory sauces, relishes, spreads, and seasonings\"\n  },\n  {\n    categoryID: 3,\n    categoryName: \"Confections\",\n    description: \"Desserts, candies, and sweet breads\"\n  },\n  {\n    categoryID: 4,\n    categoryName: \"Dairy Products\",\n    description: \"Cheeses\"\n  },\n  {\n    categoryID: 5,\n    categoryName: \"Grains/Cereals\",\n    description: \"Breads, crackers, pasta, and cereal\"\n  },\n  {\n    categoryID: 6,\n    categoryName: \"Meat/Poultry\",\n    description: \"Prepared meats\"\n  },\n  {\n    categoryID: 7,\n    categoryName: \"Produce\",\n    description: \"Dried fruit and bean curd\"\n  },\n  {\n    categoryID: 8,\n    categoryName: \"Seafood\",\n    description: \"Seaweed and fish\"\n  }\n];\n\nconst suppliers = [\n  {\n    supplierID: 1,\n    companyName: \"Exotic Liquids\",\n    contactName: \"Charlotte Cooper\",\n    contactTitle: \"Purchasing Manager\"\n  },\n  {\n    supplierID: 2,\n    companyName: \"New Orleans Cajun Delights\",\n    contactName: \"Shelley Burke\",\n    contactTitle: \"Order Administrator\"\n  },\n  {\n    supplierID: 3,\n    companyName: \"Grandma Kelly's Homestead\",\n    contactName: \"Regina Murphy\",\n    contactTitle: \"Sales Representative\"\n  },\n  {\n    supplierID: 4,\n    companyName: \"Tokyo Traders\",\n    contactName: \"Yoshi Nagase\",\n    contactTitle: \"Marketing Manager\",\n    address: \"9-8 Sekimai Musashino-shi\"\n  },\n  {\n    supplierID: 5,\n    companyName: \"Cooperativa de Quesos 'Las Cabras'\",\n    contactName: \"Antonio del Valle Saavedra\",\n    contactTitle: \"Export Administrator\"\n  },\n  {\n    supplierID: 6,\n    companyName: \"Mayumi's\",\n    contactName: \"Mayumi Ohno\",\n    contactTitle: \"Marketing Representative\"\n  },\n  {\n    supplierID: 7,\n    companyName: \"Pavlova, Ltd.\",\n    contactName: \"Ian Devling\",\n    contactTitle: \"Marketing Manager\"\n  },\n  {\n    supplierID: 8,\n    companyName: \"Specialty Biscuits, Ltd.\",\n    contactName: \"Peter Wilson\",\n    contactTitle: \"Sales Representative\"\n  }\n];\n\n/**\n * Displays the current time once a second.\n * @customfunction\n * @param invocation Custom function handler\nexport function clock(invocation: CustomFunctions.StreamingInvocation<string>): void {\n  const timer = setInterval(() => {\n    const time = currentTime();\n    invocation.setResult(time);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n\n * @customfunction\n * @param {string} address The address of the cell from which to retrieve the value.\n * @returns The value of the cell at the input address.\n\nexport async function getRangeValue(address) {\n  // Retrieve the context object. \n  const context = new Excel.RequestContext();\n  \n  // Use the context object to access the cell at the input address. \n  const range = context.workbook.worksheets.getActiveWorksheet().getRange(address);\n  range.load(\"values\");\n  await context.sync();\n  \n  // Return the value of the cell at the input address.\n  return range.values[0][0];\n }\n\n/**\n * Returns the current time.\n * @returns String with the current time formatted for the current locale.\n\nexport function currentTime(): string {\n  return new Date().toLocaleTimeString();\n}\n\n/**\n * Increment the cells with a given amount every second. Creates a dynamic spilled array with multiple results\n * @customfunction\n * @param {number} amount The amount to add to the cell value on each increment.\n * @param {CustomFunctions.StreamingInvocation<number[][]>} invocation Parameter to send results to Excel or respond to the user canceling the function. A dynamic array.\n\nexport function increment(amount: number, invocation: CustomFunctions.StreamingInvocation<number[][]>): void {\n  let firstResult = 0;\n  let secondResult = 1;\n  let thirdResult = 2;\n\n  const timer = setInterval(() => {\n    firstResult += amount;\n    secondResult += amount;\n    thirdResult += amount;\n    invocation.setResult([[firstResult], [secondResult], [thirdResult]]);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n/**\n * Writes a message to console.log().\n * @customfunction LOG\n * @param message String to write.\n * @returns String to write.\n\nexport function logMessage(message: string): string {\n  console.log(message);\n\n  return message;\n}\n/**\n * Get text values that spill both right and down.\n * @customfunction\n * @returns {string[][]} A dynamic array with multiple results.\n\nexport function spillRectangle() {\n  return [\n    ['apples', 1, 'pounds'],\n    ['oranges', 3, 'pounds'],\n    ['pears', 5, 'crates']\n  ];\n}\n*/\nCustomFunctions.associate(\"TICKER\", ticker);\nCustomFunctions.associate(\"IMPORTJSON\", ImportJson);\nCustomFunctions.associate(\"WEBAPIREQUEST\", WebApiRequest);\nCustomFunctions.associate(\"PRODUCTSEARCH\", productSearch);"],"names":["UrlFetchApp","fetch","url","options","undefined","response","json","console","log","error","message","getParameterByName","name","window","location","href","replace","results","RegExp","exec","decodeURIComponent","Run","onlyUnique","value","index","array","indexOf","flattenJson","data","result","Array","isArray","length","headersToRemove","setOfHeaders","Set","flatMap","item","tempHeaders","Object","keys","additionalHeaders","forEach","key","setOfSubKeys","push","subItem","headers","header","uniqueHeadersToRemove","filter","val","endsWith","row","rowData","eval","flattenJsonObj","obj","objHeaderVal","join","xlfNormSDist","x","k","Math","exp","sqrt","PI","xlfNormalPDF1a","mu","sigma","pow","xlfNormalPDF1b","xlfNormalSdistPDF","d1","UP","SP","T","r","V","D","Nd1","d2","Nd2","CallPrice","PutPrice","CallDelta","PutDelta","CallTheta","OptionGamma","OptionVega","PutTheta","CallRho","PutRho","CallIV","MP","Mx","Mn","PutIV","DataView","prototype","e","t","a","this","byteLength","n","getUint8","String","fromCharCode","getUint32","Number","isSafeInteger","warn","native_getBigInt64","getBigInt64","call","toString","__exchange_codes","__exchange_price_multipliers","SASSocket","args","protocol","container","document","getElementById","uri","_socket","_reconnectionTimeout","_lastConnectedTimestamp","Date","now","_topics","Gt","JSON","parse","shouldReopenSocket","exchanges","instruments","exchange","_sendHeartbeat","HearbeatIntervalID","clearInterval","setInterval","readyState","WebSocket","OPEN","send","subscribe","exchangeCode","instrumentToken","subscriptionType","subscriptionLocation","callback","topicObj","getTopicObj","topicName","getTopicName","isSocketOpen","stringify","concat","subscriptions","unsubscribe","assign","unsubscribeAll","topic","bind","windowOnBeforeUnload","closeSocket","shouldReopen","close","writeToHtml","async","msg","timestamp","Excel","run","table","context","workbook","worksheets","getItem","tables","tableRange","getRange","foundRange","textToFind","rangeToSearch","find","completeMatch","matchCase","searchDirection","SearchDirection","forward","getOffsetRange","load","sync","findTextInRange","getColumn","rowRange","rows","getItemAt","rowIndex","getResizedRange","newValues","__convert_prices","columnCount","newValue","values","connect","Promise","_value","_callback","binaryType","onopen","onmessage","getInt8","getInt32","underlyingToken","exchangeTimestamp","delta","gamma","vega","rho","theta","iv","ltt","ltq","ltp","currentOpenInterest","initialOpenInterest","lastTradedPrice","lastTradedTime","lastTradedQuantity","volume","bestBidPrice","bestBidQuantity","bestAskPrice","bestAskQuantity","totalBuyQuantity","totalSellQuantity","averageTradePrice","openPrice","highPrice","lowPrice","closePrice","yearlyHighPrice","yearlyLowPrice","lowDPR","HighDPR","change","lowDpr","highDpr","bidPrice","askPrice","buyers","bidPrices","bidQtys","sellers","askPrices","askQtys","open","high","low","totalBuyQty","totalSellQty","instrumentToken1","instrumentToken2","totalBuyers","totalSellers","totalTradeValue","getInt16","i","l","c","marketType","lastTradePrice","lastTradeQuantity","totalTradeQuantity","subscription","onclose","setTimeout","onerror","wsHandler","messageType","payload","includes","actionType","v","m","localStorage","o","s","subscriptionObj","Boolean","a1","b1","c1","arguments","apply","Wt","initSocket","acctoken","symbolDetailsObj","token","host","path","loginId","dictionary","multiplier","new_values","parseInt","convertExchange","isNaN","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","ticker","chartUrl","exchangeName","invocation","objName","retValue","map","parseFloat","setResult","getOrInitialize","onCanceled","ImportJson","successField","successFieldValue","flattenArrayPath","queryParam","queryParamValues","GetArrayFromJson","paramValues","split","tempResults","WebApiRequest","method","requestBody","flattenObjPath","authToken","confirmationMessage","proceedForApiCall","responseJson","temp","successFieldEval","flattenArrayPathSplit","tempPath","slice","login_id","login_token","addEventListener","event","onbeforeunload","productSearch","query","notAvailableError","type","errorType","searchResult","searchProduct","product","makeProductEntity","entity","text","productName","properties","basicValue","productID","quantityPerUnit","unitPrice","numberFormat","Discontinued","discontinued","layouts","card","title","property","sections","layout","collapsible","collapsed","productImage","address","mainImage","queryUpperCase","toUpperCase","products","p","supplierID","categoryID","categories","categoryName","description","suppliers","companyName","contactName","contactTitle","CustomFunctions","associate"],"sourceRoot":""}