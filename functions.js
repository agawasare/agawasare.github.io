(function(){"use strict";var __webpack_modules__={64844:function(t,e,n){n.d(e,{p:function(){return a}});class a{static async fetch(t,e=void 0){try{const n=e?await fetch(t,e):await fetch(t),a=await n.json();return console.log(a),a}catch(t){console.error(t.message)}}static getParameterByName(t,e=window.location.href){t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}},72291:function(t,e,n){function a(t,e,n){return n.indexOf(t)===e}function s(t){var e=[];if(!Array.isArray(t)||0===t.length)return e;var n=[];let s=new Set(t.flatMap((t=>{var e=Object.keys(t),a=[];return e.forEach((e=>{if(null!=t[e]&&null!=t[e]&&"object"==typeof t[e]&&!Array.isArray(t[e]))var s=Object.keys(t[e]);null!=s&&(n.push(e),a.push(...s.flatMap((t=>[e+"."+t]))))})),e.push(...a),e})));var o=[];s.forEach((t=>o.push(t)));var r=n.filter(a);return o=o.filter((t=>-1==r.indexOf(t)&&!t.endsWith("?"))),e.push(o),t.forEach((function(t){if(Array.isArray(t))e.push(t);else{var n=[];o.forEach((function(e){var a=t[e];n.push(void 0===a?"":a)})),e.push(n)}})),e}function o(t){var e=[];if(Array.isArray(t)||t.length>0)return e;var n=[...Object.keys(t)];e.push(n);var a=[];return n.forEach((function(e){Array.isArray(t[e])&&t[e].length>0?a.push(void 0===t[e]?"":t[e].join(", ")):a.push(void 0===t[e]?"":t[e])})),e.push(a),e}n.d(e,{H:function(){return s},Q:function(){return o}})},42275:function(t,e,n){n.d(e,{D7:function(){return c},vC:function(){return r}}),DataView.prototype.getString=function(t,e){for(var n="number"==typeof e?t+e:this.byteLength,a="",s=-1;t<this.byteLength&&t<n&&0!=(s=this.getUint8(t++));)a+=String.fromCharCode(s);return a},DataView.prototype.getInt64=function(t){var e=this.getUint32(t),n=this.getUint32(t+4),a=Math.pow(2,32)*e+n;return Number.isSafeInteger(a)?a:(console.warn(a,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),-1)};var a=DataView.prototype.getBigInt64;DataView.prototype.getBigInt64=function(t){return a.call(this,t).toString()};var s={NSE:1,NFO:2,CDS:3,MCX:4,BSE:6,BFO:7},o={1:100,2:100,3:1e7,4:100,6:100,7:100};function r(t){this.args=t,window.location.protocol,this.container=document.getElementById("divContainer"),this.uri="",this._socket=null,this._reconnectionTimeout=0,this._lastConnectedTimestamp=Date.now(),this._topics={},this.Gt=JSON.parse('{"DetailMarketDataMessage":{"mode":"marketdata","code":"1"},"CompactMarketDataMessage":{"mode":"compact_marketdata","code":"2"},"SnapquoteDataMessage":{"mode":"full_snapquote","code":"4"},"TbtSnapquoteDataMessage":{"mode":"tbt_full_snapquote","code":"14"},"SpreadMarketUpdate":{"mode":"spreaddata","code":"5"},"MktStatus":{"mode":"market_status","code":"9"},"ExchangeMessage":{"mode":"exchange_messages","code":"10"},"TbtUpdate":{"mode":"tbt_full_snapquote","code":"14"},"ClientAlerts":{"mode":"updates","code":"5002"},"AdminMessages":{"mode":"updates","code":"5002"},"OrderUpdate":{"mode":"updates","code":"5002"},"TradeUpdate":{"mode":"updates","code":"5002"},"PositionUpdate":{"mode":"updates","code":"5002"},"GreekData":{"mode":"greekdata","code":"15"}}'),this.shouldReopenSocket=!0,this.exchanges=[{name:"NSE",value:1},{name:"NFO",value:2},{name:"CDS",value:3},{name:"BSE",value:6}],this.instruments=[{name:"NIFTYBEES-EQ",value:10576,exchange:1},{name:"NIFTY 50",value:26e3,exchange:1},{name:"Nifty IT",value:26008,exchange:1},{name:"Nifty Bank",value:26009,exchange:1},{name:"Nifty Next 50",value:26013,exchange:1},{name:"Nifty Pharma",value:26023,exchange:1},{name:"Nifty PSU Bank",value:26025,exchange:1},{name:"NIFTY FIN SERVICE",value:26037,exchange:1},{name:"NIFTY MID SELECT",value:26074,exchange:1},{name:"SENSEX",value:1,exchange:6},{name:"BANKNIFTY24AUGFUT",value:35089,exchange:2},{name:"FINNIFTY24AUGFUT",value:35073,exchange:2},{name:"USDINR24AUGFUT",value:1237,exchange:3},{name:"MIDCPNIFTY24SEPFUT",value:38958,exchange:2},{name:"BANKNIFTY24AUG51200PE",value:48010,exchange:2}],this._sendHeartbeat=function(){var t=this;t.HearbeatIntervalID&&(clearInterval(t.HearbeatIntervalID),t.HearbeatIntervalID=void 0),t.HearbeatIntervalID=setInterval((function(){t._socket&&t._socket.readyState===WebSocket.OPEN&&t._socket.send('{"a":"h","v":[],"m":""}')}),9500)},this.subscribe=function(t,e,n,a,s){var o=this.getTopicObj(t,e,n,a,s),r=this.getTopicName(t,e,n);return this._topics[r]=o[r],this.isSocketOpen()&&this._socket.send(JSON.stringify(o[r].message)),r},this.getTopicName=function(t,e,n){return n.concat("/",t+"/"+e)},this.getTopicObj=function(t,e,n,a,s){var o={a:"subscribe",v:[[t,e]],m:"compact_marketdata"},r=this.getTopicName(t,e,n);return{[r]:{message:o,subscriptions:[{callback:s,subscriptionLocation:a}]}}},this.unsubscribe=function(t){var e=this._topics[t].message;Object.assign(e,{a:"unsubscribe"}),e&&this.isSocketOpen()&&(this._socket.send(JSON.stringify(e)),delete this._topics[t])},this.unsubscribeAll=function(){Object.keys(this._topics).forEach((t=>{this.unsubscribe(t)}))},this._sendHeartbeat.bind(this),this.windowOnBeforeUnload=function(){console.log("Unloading"),this.closeSocket(!1)},this.isSocketOpen=()=>this._socket&&this._socket.readyState===WebSocket.OPEN,this.closeSocket=function(t){return this.isSocketOpen()&&(this.shouldReopenSocket=t,this.unsubscribeAll(),this._socket.close(),this._socket=void 0,this.HearbeatIntervalID&&(clearInterval(this.HearbeatIntervalID),this.HearbeatIntervalID=void 0)),!0},this.writeToHtml=async function(t){t.msg&&(t.msg.timestamp=Date.now(),t.msg.topic=t?.topic,this.container&&t.msg&&await Excel.run((async e=>{let n=e.workbook.worksheets.getItem("Trades").tables.getItem("TradesTable"),a=n.getRange(),s=await async function(t,e,n){try{let a=n.find(e+"",{completeMatch:!0,matchCase:!1,searchDirection:Excel.SearchDirection.forward});return a=a.getOffsetRange(0,1),a.load(["address","rowIndex"]),await t.sync(),a}catch(t){console.error(t)}}(e,t.msg.instrumentToken,a.getColumn(2));if(null!=s){let a=n.rows.getItemAt(s.rowIndex-1).getRange().getOffsetRange(0,3).getResizedRange(0,-8);a.load(["address","rowCount","columnCount"]),await e.sync();let r=[];if(t.msg=i(t.msg,o[t.msg.exchange]),r.push(...Object.keys(t.msg)),r.length==a.columnCount){let t=[r];a.values=t}await e.sync()}})))},this.connect=function(){var t=this;return new Promise(((e,n)=>{t._socket=new WebSocket(t.uri),t._socket.binaryType="arraybuffer",t._socket.onopen=function(){t._reconnectionTimeout=0,Object.values(t._topics).forEach((function(e){e.message&&t._socket.send(JSON.stringify(e.message))})),t._sendHeartbeat()},t._socket.onmessage=function(e){var n=e.data;try{var a=function(t){var e=new DataView(t),n={};switch(e.getInt8(0)){case 15:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),underlyingToken:t.getInt32(6),exchangeTimestamp:t.getInt32(10),delta:t.getBigInt64(14),gamma:t.getBigInt64(22),vega:t.getBigInt64(30),rho:t.getBigInt64(38),theta:t.getBigInt64(46),iv:t.getBigInt64(54),ltt:t.getInt32(62),ltq:t.getInt32(66),ltp:t.getInt32(70),currentOpenInterest:t.getInt32(74),initialOpenInterest:t.getInt32(78)}}(e)||{},{topic:"GreekData/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 1:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),lastTradedPrice:t.getInt32(6),lastTradedTime:t.getInt32(10),lastTradedQuantity:t.getInt32(14),volume:t.getInt32(18),bestBidPrice:t.getInt32(22),bestBidQuantity:t.getInt32(26),bestAskPrice:t.getInt32(30),bestAskQuantity:t.getInt32(34),totalBuyQuantity:t.getInt64(38),totalSellQuantity:t.getInt64(46),averageTradePrice:t.getInt32(54),exchangeTimestamp:t.getInt32(58),openPrice:t.getInt32(62),highPrice:t.getInt32(66),lowPrice:t.getInt32(70),closePrice:t.getInt32(74),yearlyHighPrice:t.getInt32(78),yearlyLowPrice:t.getInt32(82),lowDPR:t.getInt32(86),HighDPR:t.getInt32(90),currentOpenInterest:t.getInt32(94),initialOpenInterest:t.getInt32(98)}}(e)||{},{topic:"DetailMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 2:return n=function(t){return 42===t.byteLength?{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),ltp:t.getInt32(6),change:t.getInt32(10),ltt:t.getInt32(14),lowDpr:t.getInt32(18),highDpr:t.getInt32(22),currentOpenInterest:t.getInt32(26),initialOpenInterest:t.getInt32(30),bidPrice:t.getInt32(34),askPrice:t.getInt32(38)}:46===t.byteLength?{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),ltp:t.getInt32(6),change:t.getInt32(10),ltt:t.getInt32(14),lowDpr:t.getInt32(18),highDpr:t.getInt32(22),currentOpenInterest:t.getInt32(26),initialOpenInterest:t.getInt32(30),bidPrice:t.getInt32(34),askPrice:t.getInt32(38),ltq:t.getInt32(42)}:{exchange:0,instrumentToken:0,ltp:0,change:0,ltt:0,lowDpr:0,highDpr:0,currentOpenInterest:0,initialOpenInterest:0,bidPrice:0,askPrice:0,ltq:0}}(e)||{},{topic:"CompactMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 4:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),buyers:[t.getInt32(6),t.getInt32(10),t.getInt32(14),t.getInt32(18),t.getInt32(22)],bidPrices:[t.getInt32(26),t.getInt32(30),t.getInt32(34),t.getInt32(38),t.getInt32(42)],bidQtys:[t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58),t.getInt32(62)],sellers:[t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78),t.getInt32(82)],askPrices:[t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98),t.getInt32(102)],askQtys:[t.getInt32(106),t.getInt32(110),t.getInt32(114),t.getInt32(118),t.getInt32(122)],averageTradePrice:t.getInt32(126),open:t.getInt32(130),high:t.getInt32(134),low:t.getInt32(138),close:t.getInt32(142),totalBuyQty:t.getInt64(146),totalSellQty:t.getInt64(154),volume:t.getInt32(162)}}(e)||{},{topic:"SnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 5:return n=function(t){return{exchange:t.getInt8(1),instrumentToken1:t.getInt32(2),instrumentToken2:t.getInt32(6),exchangeTimestamp:t.getInt32(10),totalBuyers:t.getInt32(14),totalSellers:t.getInt32(18),buyers:[t.getInt32(22),t.getInt32(26),t.getInt32(30),t.getInt32(34),t.getInt32(38)],bidPrices:[t.getInt32(42),t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58)],bidQtys:[t.getInt32(62),t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78)],sellers:[t.getInt32(82),t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98)],askPrices:[t.getInt32(102),t.getInt32(106),t.getInt32(110),t.getInt32(114),t.getInt32(118)],askQtys:[t.getInt32(122),t.getInt32(126),t.getInt32(130),t.getInt32(134),t.getInt32(138)],volume:t.getInt32(142),totalTradeValue:t.getInt64(146),totalBuyQty:t.getInt64(154),totalSellQty:t.getInt64(162),open:t.getInt32(170),high:t.getInt32(174),low:t.getInt32(178),ltp:t.getInt32(182),lastTradedPrice:t.getInt32(182),ltt:t.getInt32(186),lowDpr:t.getInt32(190),highDpr:t.getInt32(194),closePrice:t.getInt32(198),close:t.getInt32(198),averageTradePrice:206===t.byteLength?t.getInt32(202):0}}(e)||{},{topic:"SpreadMarketUpdate/".concat(n.exchange,"/").concat(n.instrumentToken1,"-").concat(n.instrumentToken2),msg:n};case 9:return n=function(t){var e=t.getInt8(1),n=t.getInt16(2),a=t.getString(4,n),s=4+n,o=t.getInt16(s),r=s+2,i=r+o;return{exchange:e,marketType:a,message:t.getString(r,o),timestamp:t.getInt32(i)}}(e)||{},{topic:"MktStatus/".concat(n.exchange),msg:n};case 10:return n=function(t){var e=t.getInt8(1),n=t.getInt16(2),a=4+n;return{exchange:e,message:t.getString(4,n),timestamp:t.getInt32(a)}}(e)||{},{topic:"ExchangeMessage/".concat(n.exchange),msg:n};case 11:case 50:return{topic:"OrderUpdate"};case 12:case 51:return{topic:"TradeUpdate"};case 14:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),lastTradePrice:t.getInt32(14),lastTradeQuantity:t.getInt32(18),totalTradeQuantity:t.getInt64(22),buyers:[t.getInt32(30),t.getInt32(34),t.getInt32(38),t.getInt32(42),t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58),t.getInt32(62),t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78),t.getInt32(82),t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98),t.getInt32(102),t.getInt32(106)],bidPrices:[t.getInt32(110),t.getInt32(114),t.getInt32(118),t.getInt32(122),t.getInt32(126),t.getInt32(130),t.getInt32(134),t.getInt32(138),t.getInt32(142),t.getInt32(146),t.getInt32(150),t.getInt32(154),t.getInt32(158),t.getInt32(162),t.getInt32(166),t.getInt32(170),t.getInt32(174),t.getInt32(178),t.getInt32(182),t.getInt32(186)],bidQtys:[t.getInt32(190),t.getInt32(194),t.getInt32(198),t.getInt32(202),t.getInt32(206),t.getInt32(210),t.getInt32(214),t.getInt32(218),t.getInt32(222),t.getInt32(226),t.getInt32(230),t.getInt32(234),t.getInt32(238),t.getInt32(242),t.getInt32(246),t.getInt32(250),t.getInt32(254),t.getInt32(258),t.getInt32(262),t.getInt32(266)],sellers:[t.getInt32(270),t.getInt32(274),t.getInt32(278),t.getInt32(282),t.getInt32(286),t.getInt32(290),t.getInt32(294),t.getInt32(298),t.getInt32(302),t.getInt32(306),t.getInt32(310),t.getInt32(314),t.getInt32(318),t.getInt32(322),t.getInt32(326),t.getInt32(330),t.getInt32(334),t.getInt32(338),t.getInt32(342),t.getInt32(346)],askPrices:[t.getInt32(350),t.getInt32(354),t.getInt32(358),t.getInt32(362),t.getInt32(366),t.getInt32(370),t.getInt32(374),t.getInt32(378),t.getInt32(382),t.getInt32(386),t.getInt32(390),t.getInt32(394),t.getInt32(398),t.getInt32(402),t.getInt32(406),t.getInt32(410),t.getInt32(414),t.getInt32(418),t.getInt32(422),t.getInt32(426)],askQtys:[t.getInt32(430),t.getInt32(434),t.getInt32(438),t.getInt32(442),t.getInt32(446),t.getInt32(450),t.getInt32(454),t.getInt32(458),t.getInt32(462),t.getInt32(466),t.getInt32(470),t.getInt32(474),t.getInt32(478),t.getInt32(482),t.getInt32(486),t.getInt32(490),t.getInt32(494),t.getInt32(498),t.getInt32(502),t.getInt32(506)],averageTradePrice:t.getInt32(510),open:t.getInt32(514),high:t.getInt32(518),low:t.getInt32(522),close:t.getInt32(526),totalBuyQty:t.getInt64(530),totalSellQty:t.getInt64(538),volume:t.getInt32(546)}}(e)||{},{topic:"TbtSnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken)};case 58:return{topic:"PositionUpdate"};default:return{}}}(n);a.msg=i(a.msg,o[a.msg.exchange]);let e=a.topic;((t._topics[e]||{}).subscriptions||[]).forEach((function(t){return(0,t.callback)(a)}))}catch(t){console.log(t)}},t._socket.onclose=function(){t.shouldReopenSocket&&setTimeout((function(){return t.connect()}),1e3)},t._socket.onerror=function(e){console.log("Socket encountered error: ".concat(e.message,", closing socket")),t.isSocketOpen()&&t._socket.close()}}))},this.wsHandler=function(t){var e=this,n=t.messageType,a=t.subscriptionLocation,s=t.payload,o=["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate","DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData","MktStatus","ExchangeMessage"],r=function(t){var e=t.messageType,n=t.payload,a=void 0===n?{}:n;if(!(e in o))throw"".concat(e," not supported");if(["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate"].includes(e))return"".concat(e);if(["DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData"].includes(e)){var s=a.exchangeCode,r=a.instrumentToken;if(!s||!r)throw"missing exchangeCode: ".concat(s," or instrumentToken: ").concat(r);return"".concat(e,"/").concat(s,"/").concat(r)}if(["MktStatus","ExchangeMessage"].includes(e)){var i=a.exchangeCode;if(!i)throw"missing exchangeCode: ".concat(i);return"".concat(e,"/").concat(i)}throw"invalid messageType: ".concat(e)}({messageType:n,payload:s}),i=function(t){var e=t.actionType,n=t.payload,a=void 0===n?{}:n;switch(t.messageType){case"SpreadMarketUpdate":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"spreaddata"};case"DetailMarketDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"marketdata"};case"CompactMarketDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"compact_marketdata"};case"SnapquoteDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"full_snapquote"};case"TbtSnapquoteDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"tbt_full_snapquote"};case"OrderUpdate":return{a:e,v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"TradeUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"ExchangeMessage":return{a:e,v:[a.exchangeCode],m:"exchange_messages"};case"PositionUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"position_updates"};case"GreekData":return{a:"subscribe",v:[[a.exchangeCode,a.instrumentToken]],m:"greekdata"};default:return{}}}({messageType:n,payload:s,actionType:"subscribe"}),c=JSON.stringify(Object.assign(i,{a:"subscribe"})),g=JSON.stringify(Object.assign(i,{a:"unsubscribe"}));return{subscribe:function(t){return new Promise((function(s,o){e._topics[r]||(e._topics[r]={subscriptionObj:c,subscriptions:[]}),Boolean(e._topics[r].subscriptions.filter((function(t){return t.subscriptionLocation===a})).length)?o("".concat(n," already subscribed from ").concat(a)):(e._socket&&e._socket.readyState===WebSocket.OPEN?(e._topics[r].subscriptions.length&&e._socket.send(g),e._socket.send(c),s("subscribed")):o("socket not connect, ".concat(n," will be auto subscribed later")),e._topics[r].subscriptions.push({subscriptionLocation:a,callback:t}))}))},unsubscribe:function(){return new Promise((function(t,o){var i=(e._topics[r]||[]).subscriptions||[],c=i.filter((function(t){return t.subscriptionLocation!==a}));c.length===i.length?(function(t,e,n){for(var a,s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];(a=console).log.apply(a,["Octopus"].concat(o))}(n,a,s),o("subscription does not exists")):(e._topics[r].subscriptions=c,t("unsubscribed"),0===c.length&&e._socket&&e._socket.send(g))}))}}},this.initSocket=function(t,e){this.isSocketOpen()&&this.closeSocket(!1),this.args.token=t,this.uri="wss://".concat(this.args.host).concat(this.args.path,"?login_id=").concat(this.args.loginId,"&token=").concat(this.args.token,"&device=web"),e&&Object.assign(this._topics,e),this.connect()}}function i(t,e){return["ltp","best_bid_price","best_ask_price","atp","open","high","low","close","yearly_high","yearly_low","lowDpr","highDpr","bidPrice","askPrice","change"].forEach((n=>{n in t&&(t[n]=t[n]/e)})),["bid_prices","ask_prices"].forEach((n=>{if(n in t){let a=[];for(let s in t[n])a.push(parseInt(s)/e);t[n]=a}})),t}function c(t){let e=parseInt(s[t]);return isNaN(e)?1:e}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={},_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72291),_sas__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42275),_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64844);function ticker(t,e,n,a,s,o){let r="sasObj",i=t=>{let e=[Object.values(t?.msg).map((t=>parseFloat(t+"")))];o.setResult(e)},c=(0,_sas__WEBPACK_IMPORTED_MODULE_0__.D7)(e),g=getTopicName(c,n,a);void 0===window[r]?window[r]=getOrInitialize(t,r,c,n,a,s,i):g=window[r].subscribe(c,n,a,s,i),o.onCanceled=()=>{window[r].unsubscribe(g)}}async function ImportJson(t,e,n,a,s="",o=""){if(null==s||""==s)return GetArrayFromJson(t,e,n,a);for(var r=[],i=o.split(";"),c=0;c<i.length;c++)if(""!=i[c]){var g=await GetArrayFromJson(t+"&"+s+"="+i[c],e,n,a);g&&r.push(...g)}return r.slice(1)}async function WebApiRequest(url,method,requestBody="",flattenArrayPath="",flattenObjPath="",authToken=void 0,confirmationMessage=""){var results=[],options={method:method};"post"!=method&&"put"!=method||""==requestBody||(options.body=requestBody,options.headers={Accept:"application/json, text/plain, *//*","Content-Type":"application/json"}),null!=authToken&&""!=authToken&&(options.headers=options.headers??{},options.headers.Authorization="Bearer "+authToken);let proceedForApiCall=!1;if(null==confirmationMessage||""==confirmationMessage||""!=confirmationMessage&&proceedForApiCall){var obj={responseJson:await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(url,options)};if(""!=flattenArrayPath){var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.H)(eval("obj.responseJson."+flattenArrayPath));temp.length>0&&results.push(...temp)}if(""!=flattenObjPath){var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.Q)(obj.responseJson[flattenObjPath]);temp.length>0&&results.push(...temp)}}return results}async function GetArrayFromJson(t,e,n,a){var s={responseJson:await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(t)},o=[];if(s.responseJson[e]==n){for(var r=a.split(";"),i=0;i<r.length;i++){r[i];var c=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.H)(s.responseJson[r[i]]);i>0&&(c=c.slice(1,-1)),o.push(...c)}return o}}function getTopicName(t,e,n){return n.concat("/",t+"/"+e)}function getOrInitialize(t,e,n,a,s,o,r){if(void 0===window[e]){let i=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_id",t),c=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_token",t);window[e]=new _sas__WEBPACK_IMPORTED_MODULE_0__.vC({host:"alpha.sasonline.in",path:"/ws/v1/feeds",loginId:i});let g=window[e].getTopicObj(n,a,s,o,r);window[e].initSocket(c,g),window.addEventListener?window.addEventListener("beforeunload",(t=>window[e].windowOnBeforeUnload(t))):window.onbeforeunload=t=>window[e].windowOnBeforeUnload(t)}return window[e]}CustomFunctions.associate("TICKER",ticker),CustomFunctions.associate("IMPORTJSON",ImportJson),CustomFunctions.associate("WEBAPIREQUEST",WebApiRequest)})();
//# sourceMappingURL=functions.js.map