(function(){"use strict";var __webpack_modules__={64844:function(t,e,n){n.d(e,{p:function(){return a}});class a{static notAvailableError={type:"Error",errorType:"NotAvailable"};static async fetch(t,e=void 0){try{const n=e?await fetch(t,e):await fetch(t),a=await n.json();return console.log(a),a}catch(t){console.error(t.message)}}static getParameterByName(t,e=window.location.href){t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}},72291:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function Run(){}function onlyUnique(t,e,n){return n.indexOf(t)===e}function flattenJsonArray(data){var result=[];if(!Array.isArray(data)||0===data.length)return result;var headersToRemove=[];let setOfHeaders=new Set(data.flatMap((t=>{var e=Object.keys(t),n=[];return e.forEach((e=>{if(null!=t[e]&&null!=t[e]&&"object"==typeof t[e]&&!Array.isArray(t[e]))var a=Object.keys(t[e]);null!=a&&(headersToRemove.push(e),n.push(...a.flatMap((t=>[e+"."+t]))))})),e.push(...n),e})));var headers=[];setOfHeaders.forEach((t=>headers.push(t)));var uniqueHeadersToRemove=headersToRemove.filter(onlyUnique);return headers=headers.filter((t=>-1==uniqueHeadersToRemove.indexOf(t)&&!t.endsWith("?"))),result.push(headers),data.forEach((function(row){if(Array.isArray(row))result.push(row);else{var rowData=[];headers.forEach((function(header){var val=eval("row."+header);rowData.push(void 0===val?"":val)})),result.push(rowData)}})),result}function flattenJsonObj(obj){var result=[];if(Array.isArray(obj)||obj.length>0)return result;var headers=[...Object.keys(obj)];result.push(headers);var rowData=[];return headers.forEach((function(header){var objHeaderVal=eval("obj."+header);Array.isArray(objHeaderVal)&&objHeaderVal.length>0?rowData.push(void 0===objHeaderVal?"":objHeaderVal.join(", ")):rowData.push(void 0===objHeaderVal?"":objHeaderVal)})),result.push(rowData),result}function xlfNormSDist(t){if(t<0)return 1-xlfNormSDist(-t);var e=1/(1+.2316419*t);return 1-Math.exp(-t*t/2)/Math.sqrt(2*Math.PI)*e*(.31938153+e*(e*(1.781477937+e*(1.330274429*e-1.821255978))-.356563782))}function xlfNormalPDF1a(t,e,n){return Math.exp(-Math.pow(t-e,2)/(2*Math.pow(n,2)))/(n*Math.sqrt(2*Math.PI))}function xlfNormalPDF1b(t,e,n){return Math.exp(-.5*Math.pow((t-e)/n,2))/(n*Math.sqrt(2*Math.PI))}function xlfNormalSdistPDF(t){return Math.exp(-.5*t*t)/Math.sqrt(2*Math.PI)}function d1(t,e,n,a,r,o){return(Math.log(t/e)+(a-o+.5*r^2)*n)/(r*Math.sqrt(n))}function Nd1(t,e,n,a,r,o){return Math.exp(-(2^d1(t,e,n,a,r,o))/2)/Math.sqrt(2*Math.PI)}function d2(t,e,n,a,r,o){return d1(t,e,n,a,r,o)-r*Math.sqrt(n)}function Nd2(t,e,n,a,r,o){return xlfNormSDist(d2(t,e,n,a,r,o))}function CallPrice(t,e,n,a,r,o){return Math.exp(-o*n)*t*xlfNormSDist(d1(t,e,n,a,r,o))-e*Math.exp(-a*n)*xlfNormSDist(d1(t,e,n,a,r,o)-r*Math.sqrt(n))}function PutPrice(t,e,n,a,r,o){return e*Math.exp(-a*n)*xlfNormSDist(-d2(t,e,n,a,r,o))-Math.exp(-o*n)*t*xlfNormSDist(-d1(t,e,n,a,r,o))}function CallDelta(t,e,n,a,r,o){return xlfNormSDist(d1(t,e,n,a,r,o))}function PutDelta(t,e,n,a,r,o){return xlfNormSDist(d1(t,e,n,a,r,o))-1}function CallTheta(t,e,n,a,r,o){return-(t*r*Nd1(t,e,n,a,r,o)/(2*Math.sqrt(n))-a*e*Math.exp(-a*n)*Nd2(t,e,n,a,r,o))/365}function OptionGamma(t,e,n,a,r,o){return Nd1(t,e,n,a,r,o)/(t*(r*Math.sqrt(n)))}function OptionVega(t,e,n,a,r,o){return.01*t*Math.sqrt(n)*Nd1(t,e,n,a,r,o)}function PutTheta(t,e,n,a,r,o){return(-t*r*Nd1(t,e,n,a,r,o)/(2*Math.sqrt(n))+a*e*Math.exp(-a*n)*(1-Nd2(t,e,n,a,r,o)))/365}function CallRho(t,e,n,a,r,o){return.01*e*n*Math.exp(-a*n)*xlfNormSDist(d2(t,e,n,a,r,o))}function PutRho(t,e,n,a,r,o){return-.01*e*n*Math.exp(-a*n)*(1-xlfNormSDist(d2(t,e,n,a,r,o)))}function CallIV(t,e,n,a,r,o){let s=5,i=0;for(;s-i>1e-4;)CallPrice(t,e,n,a,(s+i)/2,o)>r?s=(s+i)/2:i=(s+i)/2;return(s+i)/2}function PutIV(t,e,n,a,r,o){let s=5,i=0;for(;s-i>1e-4;)PutPrice(t,e,n,a,(s+i)/2,o)>r?s=(s+i)/2:i=(s+i)/2;return(s+i)/2}__webpack_require__.d(__webpack_exports__,{Q:function(){return flattenJsonObj},y:function(){return flattenJsonArray}})},42275:function(t,e,n){n.d(e,{D7:function(){return c},vC:function(){return s}}),DataView.prototype.getString=function(t,e){for(var n="number"==typeof e?t+e:this.byteLength,a="",r=-1;t<this.byteLength&&t<n&&0!=(r=this.getUint8(t++));)a+=String.fromCharCode(r);return a},DataView.prototype.getInt64=function(t){var e=this.getUint32(t),n=this.getUint32(t+4),a=Math.pow(2,32)*e+n;return Number.isSafeInteger(a)?a:(console.warn(a,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),-1)};var a=DataView.prototype.getBigInt64;DataView.prototype.getBigInt64=function(t){return a.call(this,t).toString()};var r={NSE:1,NFO:2,CDS:3,MCX:4,BSE:6,BFO:7},o={1:100,2:100,3:1e7,4:100,6:100,7:100};function s(t){this.args=t,window.location.protocol,this.container=document.getElementById("divContainer"),this.uri="",this._socket=null,this._reconnectionTimeout=0,this._lastConnectedTimestamp=Date.now(),this._topics={},this.Gt=JSON.parse('{"DetailMarketDataMessage":{"mode":"marketdata","code":"1"},"CompactMarketDataMessage":{"mode":"compact_marketdata","code":"2"},"SnapquoteDataMessage":{"mode":"full_snapquote","code":"4"},"TbtSnapquoteDataMessage":{"mode":"tbt_full_snapquote","code":"14"},"SpreadMarketUpdate":{"mode":"spreaddata","code":"5"},"MktStatus":{"mode":"market_status","code":"9"},"ExchangeMessage":{"mode":"exchange_messages","code":"10"},"TbtUpdate":{"mode":"tbt_full_snapquote","code":"14"},"ClientAlerts":{"mode":"updates","code":"5002"},"AdminMessages":{"mode":"updates","code":"5002"},"OrderUpdate":{"mode":"updates","code":"5002"},"TradeUpdate":{"mode":"updates","code":"5002"},"PositionUpdate":{"mode":"updates","code":"5002"},"GreekData":{"mode":"greekdata","code":"15"}}'),this.shouldReopenSocket=!0,this.exchanges=[{name:"NSE",value:1},{name:"NFO",value:2},{name:"CDS",value:3},{name:"BSE",value:6}],this.instruments=[{name:"NIFTYBEES-EQ",value:10576,exchange:1},{name:"NIFTY 50",value:26e3,exchange:1},{name:"Nifty IT",value:26008,exchange:1},{name:"Nifty Bank",value:26009,exchange:1},{name:"Nifty Next 50",value:26013,exchange:1},{name:"Nifty Pharma",value:26023,exchange:1},{name:"Nifty PSU Bank",value:26025,exchange:1},{name:"NIFTY FIN SERVICE",value:26037,exchange:1},{name:"NIFTY MID SELECT",value:26074,exchange:1},{name:"SENSEX",value:1,exchange:6},{name:"BANKNIFTY24AUGFUT",value:35089,exchange:2},{name:"FINNIFTY24AUGFUT",value:35073,exchange:2},{name:"USDINR24AUGFUT",value:1237,exchange:3},{name:"MIDCPNIFTY24SEPFUT",value:38958,exchange:2},{name:"BANKNIFTY24AUG51200PE",value:48010,exchange:2}],this._sendHeartbeat=function(){var t=this;t.HearbeatIntervalID&&(clearInterval(t.HearbeatIntervalID),t.HearbeatIntervalID=void 0),t.HearbeatIntervalID=setInterval((function(){t._socket&&t._socket.readyState===WebSocket.OPEN&&t._socket.send('{"a":"h","v":[],"m":""}')}),9500)},this.subscribe=function(t,e,n,a,r){var o=this.getTopicObj(t,e,n,a,r),s=this.getTopicName(t,e,n);return this._topics[s]=o[s],this.isSocketOpen()&&this._socket.send(JSON.stringify(o[s].message)),s},this.getTopicName=function(t,e,n){return n.concat("/",t+"/"+e)},this.getTopicObj=function(t,e,n,a,r){var o={a:"subscribe",v:[[t,e]],m:"compact_marketdata"},s=this.getTopicName(t,e,n);return{[s]:{message:o,subscriptions:[{callback:r,subscriptionLocation:a}]}}},this.unsubscribe=function(t){var e=this._topics[t].message;Object.assign(e,{a:"unsubscribe"}),e&&this.isSocketOpen()&&(this._socket.send(JSON.stringify(e)),delete this._topics[t])},this.unsubscribeAll=function(){Object.keys(this._topics).forEach((t=>{this.unsubscribe(t)}))},this._sendHeartbeat.bind(this),this.windowOnBeforeUnload=function(){console.log("Unloading"),this.closeSocket(!1)},this.isSocketOpen=()=>this._socket&&this._socket.readyState===WebSocket.OPEN,this.closeSocket=function(t){return this.isSocketOpen()&&(this.shouldReopenSocket=t,this.unsubscribeAll(),this._socket.close(),this._socket=void 0,this.HearbeatIntervalID&&(clearInterval(this.HearbeatIntervalID),this.HearbeatIntervalID=void 0)),!0},this.writeToHtml=async function(t){t.msg&&(t.msg.timestamp=Date.now(),t.msg.topic=t?.topic,this.container&&t.msg&&await Excel.run((async e=>{let n=e.workbook.worksheets.getItem("Trades").tables.getItem("TradesTable"),a=n.getRange(),r=await async function(t,e,n){try{let a=n.find(e+"",{completeMatch:!0,matchCase:!1,searchDirection:Excel.SearchDirection.forward});return a=a.getOffsetRange(0,1),a.load(["address","rowIndex"]),await t.sync(),a}catch(t){console.error(t)}}(e,t.msg.instrumentToken,a.getColumn(2));if(null!=r){let a=n.rows.getItemAt(r.rowIndex-1).getRange().getOffsetRange(0,3).getResizedRange(0,-8);a.load(["address","rowCount","columnCount"]),await e.sync();let s=[];if(t.msg=i(t.msg,o[t.msg.exchange]),s.push(...Object.keys(t.msg)),s.length==a.columnCount){let t=[s];a.values=t}await e.sync()}})))},this.connect=function(){var t=this;return new Promise(((e,n)=>{t._socket=new WebSocket(t.uri),t._socket.binaryType="arraybuffer",t._socket.onopen=function(){t._reconnectionTimeout=0,Object.values(t._topics).forEach((function(e){e.message&&t._socket.send(JSON.stringify(e.message))})),t._sendHeartbeat()},t._socket.onmessage=function(e){var n=e.data;try{var a=function(t){var e=new DataView(t),n={};switch(e.getInt8(0)){case 15:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),underlyingToken:t.getInt32(6),exchangeTimestamp:t.getInt32(10),delta:t.getBigInt64(14),gamma:t.getBigInt64(22),vega:t.getBigInt64(30),rho:t.getBigInt64(38),theta:t.getBigInt64(46),iv:t.getBigInt64(54),ltt:t.getInt32(62),ltq:t.getInt32(66),ltp:t.getInt32(70),currentOpenInterest:t.getInt32(74),initialOpenInterest:t.getInt32(78)}}(e)||{},{topic:"GreekData/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 1:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),lastTradedPrice:t.getInt32(6),lastTradedTime:t.getInt32(10),lastTradedQuantity:t.getInt32(14),volume:t.getInt32(18),bestBidPrice:t.getInt32(22),bestBidQuantity:t.getInt32(26),bestAskPrice:t.getInt32(30),bestAskQuantity:t.getInt32(34),totalBuyQuantity:t.getInt64(38),totalSellQuantity:t.getInt64(46),averageTradePrice:t.getInt32(54),exchangeTimestamp:t.getInt32(58),openPrice:t.getInt32(62),highPrice:t.getInt32(66),lowPrice:t.getInt32(70),closePrice:t.getInt32(74),yearlyHighPrice:t.getInt32(78),yearlyLowPrice:t.getInt32(82),lowDPR:t.getInt32(86),HighDPR:t.getInt32(90),currentOpenInterest:t.getInt32(94),initialOpenInterest:t.getInt32(98)}}(e)||{},{topic:"DetailMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 2:return n=function(t){return 42===t.byteLength?{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),ltp:t.getInt32(6),change:t.getInt32(10),ltt:t.getInt32(14),lowDpr:t.getInt32(18),highDpr:t.getInt32(22),currentOpenInterest:t.getInt32(26),initialOpenInterest:t.getInt32(30),bidPrice:t.getInt32(34),askPrice:t.getInt32(38)}:46===t.byteLength?{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),ltp:t.getInt32(6),change:t.getInt32(10),ltt:t.getInt32(14),lowDpr:t.getInt32(18),highDpr:t.getInt32(22),currentOpenInterest:t.getInt32(26),initialOpenInterest:t.getInt32(30),bidPrice:t.getInt32(34),askPrice:t.getInt32(38),ltq:t.getInt32(42)}:{exchange:0,instrumentToken:0,ltp:0,change:0,ltt:0,lowDpr:0,highDpr:0,currentOpenInterest:0,initialOpenInterest:0,bidPrice:0,askPrice:0,ltq:0}}(e)||{},{topic:"CompactMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 4:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),buyers:[t.getInt32(6),t.getInt32(10),t.getInt32(14),t.getInt32(18),t.getInt32(22)],bidPrices:[t.getInt32(26),t.getInt32(30),t.getInt32(34),t.getInt32(38),t.getInt32(42)],bidQtys:[t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58),t.getInt32(62)],sellers:[t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78),t.getInt32(82)],askPrices:[t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98),t.getInt32(102)],askQtys:[t.getInt32(106),t.getInt32(110),t.getInt32(114),t.getInt32(118),t.getInt32(122)],averageTradePrice:t.getInt32(126),open:t.getInt32(130),high:t.getInt32(134),low:t.getInt32(138),close:t.getInt32(142),totalBuyQty:t.getInt64(146),totalSellQty:t.getInt64(154),volume:t.getInt32(162)}}(e)||{},{topic:"SnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 5:return n=function(t){return{exchange:t.getInt8(1),instrumentToken1:t.getInt32(2),instrumentToken2:t.getInt32(6),exchangeTimestamp:t.getInt32(10),totalBuyers:t.getInt32(14),totalSellers:t.getInt32(18),buyers:[t.getInt32(22),t.getInt32(26),t.getInt32(30),t.getInt32(34),t.getInt32(38)],bidPrices:[t.getInt32(42),t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58)],bidQtys:[t.getInt32(62),t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78)],sellers:[t.getInt32(82),t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98)],askPrices:[t.getInt32(102),t.getInt32(106),t.getInt32(110),t.getInt32(114),t.getInt32(118)],askQtys:[t.getInt32(122),t.getInt32(126),t.getInt32(130),t.getInt32(134),t.getInt32(138)],volume:t.getInt32(142),totalTradeValue:t.getInt64(146),totalBuyQty:t.getInt64(154),totalSellQty:t.getInt64(162),open:t.getInt32(170),high:t.getInt32(174),low:t.getInt32(178),ltp:t.getInt32(182),lastTradedPrice:t.getInt32(182),ltt:t.getInt32(186),lowDpr:t.getInt32(190),highDpr:t.getInt32(194),closePrice:t.getInt32(198),close:t.getInt32(198),averageTradePrice:206===t.byteLength?t.getInt32(202):0}}(e)||{},{topic:"SpreadMarketUpdate/".concat(n.exchange,"/").concat(n.instrumentToken1,"-").concat(n.instrumentToken2),msg:n};case 9:return n=function(t){var e=t.getInt8(1),n=t.getInt16(2),a=t.getString(4,n),r=4+n,o=t.getInt16(r),s=r+2,i=s+o;return{exchange:e,marketType:a,message:t.getString(s,o),timestamp:t.getInt32(i)}}(e)||{},{topic:"MktStatus/".concat(n.exchange),msg:n};case 10:return n=function(t){var e=t.getInt8(1),n=t.getInt16(2),a=4+n;return{exchange:e,message:t.getString(4,n),timestamp:t.getInt32(a)}}(e)||{},{topic:"ExchangeMessage/".concat(n.exchange),msg:n};case 11:case 50:return{topic:"OrderUpdate"};case 12:case 51:return{topic:"TradeUpdate"};case 14:return n=function(t){return{exchange:t.getInt8(1),instrumentToken:t.getInt32(2),lastTradePrice:t.getInt32(14),lastTradeQuantity:t.getInt32(18),totalTradeQuantity:t.getInt64(22),buyers:[t.getInt32(30),t.getInt32(34),t.getInt32(38),t.getInt32(42),t.getInt32(46),t.getInt32(50),t.getInt32(54),t.getInt32(58),t.getInt32(62),t.getInt32(66),t.getInt32(70),t.getInt32(74),t.getInt32(78),t.getInt32(82),t.getInt32(86),t.getInt32(90),t.getInt32(94),t.getInt32(98),t.getInt32(102),t.getInt32(106)],bidPrices:[t.getInt32(110),t.getInt32(114),t.getInt32(118),t.getInt32(122),t.getInt32(126),t.getInt32(130),t.getInt32(134),t.getInt32(138),t.getInt32(142),t.getInt32(146),t.getInt32(150),t.getInt32(154),t.getInt32(158),t.getInt32(162),t.getInt32(166),t.getInt32(170),t.getInt32(174),t.getInt32(178),t.getInt32(182),t.getInt32(186)],bidQtys:[t.getInt32(190),t.getInt32(194),t.getInt32(198),t.getInt32(202),t.getInt32(206),t.getInt32(210),t.getInt32(214),t.getInt32(218),t.getInt32(222),t.getInt32(226),t.getInt32(230),t.getInt32(234),t.getInt32(238),t.getInt32(242),t.getInt32(246),t.getInt32(250),t.getInt32(254),t.getInt32(258),t.getInt32(262),t.getInt32(266)],sellers:[t.getInt32(270),t.getInt32(274),t.getInt32(278),t.getInt32(282),t.getInt32(286),t.getInt32(290),t.getInt32(294),t.getInt32(298),t.getInt32(302),t.getInt32(306),t.getInt32(310),t.getInt32(314),t.getInt32(318),t.getInt32(322),t.getInt32(326),t.getInt32(330),t.getInt32(334),t.getInt32(338),t.getInt32(342),t.getInt32(346)],askPrices:[t.getInt32(350),t.getInt32(354),t.getInt32(358),t.getInt32(362),t.getInt32(366),t.getInt32(370),t.getInt32(374),t.getInt32(378),t.getInt32(382),t.getInt32(386),t.getInt32(390),t.getInt32(394),t.getInt32(398),t.getInt32(402),t.getInt32(406),t.getInt32(410),t.getInt32(414),t.getInt32(418),t.getInt32(422),t.getInt32(426)],askQtys:[t.getInt32(430),t.getInt32(434),t.getInt32(438),t.getInt32(442),t.getInt32(446),t.getInt32(450),t.getInt32(454),t.getInt32(458),t.getInt32(462),t.getInt32(466),t.getInt32(470),t.getInt32(474),t.getInt32(478),t.getInt32(482),t.getInt32(486),t.getInt32(490),t.getInt32(494),t.getInt32(498),t.getInt32(502),t.getInt32(506)],averageTradePrice:t.getInt32(510),open:t.getInt32(514),high:t.getInt32(518),low:t.getInt32(522),close:t.getInt32(526),totalBuyQty:t.getInt64(530),totalSellQty:t.getInt64(538),volume:t.getInt32(546)}}(e)||{},{topic:"TbtSnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken)};case 58:return{topic:"PositionUpdate"};default:return{}}}(n);a.msg=i(a.msg,o[a.msg.exchange]);let e=a.topic;((t._topics[e]||{}).subscriptions||[]).forEach((function(t){return(0,t.callback)(a)}))}catch(t){console.log(t)}},t._socket.onclose=function(){t.shouldReopenSocket&&setTimeout((function(){return t.connect()}),1e3)},t._socket.onerror=function(e){console.log("Socket encountered error: ".concat(e.message,", closing socket")),t.isSocketOpen()&&t._socket.close()}}))},this.wsHandler=function(t){var e=this,n=t.messageType,a=t.subscriptionLocation,r=t.payload,o=["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate","DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData","MktStatus","ExchangeMessage"],s=function(t){var e=t.messageType,n=t.payload,a=void 0===n?{}:n;if(!(e in o))throw"".concat(e," not supported");if(["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate"].includes(e))return"".concat(e);if(["DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData"].includes(e)){var r=a.exchangeCode,s=a.instrumentToken;if(!r||!s)throw"missing exchangeCode: ".concat(r," or instrumentToken: ").concat(s);return"".concat(e,"/").concat(r,"/").concat(s)}if(["MktStatus","ExchangeMessage"].includes(e)){var i=a.exchangeCode;if(!i)throw"missing exchangeCode: ".concat(i);return"".concat(e,"/").concat(i)}throw"invalid messageType: ".concat(e)}({messageType:n,payload:r}),i=function(t){var e=t.actionType,n=t.payload,a=void 0===n?{}:n;switch(t.messageType){case"SpreadMarketUpdate":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"spreaddata"};case"DetailMarketDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"marketdata"};case"CompactMarketDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"compact_marketdata"};case"SnapquoteDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"full_snapquote"};case"TbtSnapquoteDataMessage":return{a:e,v:[[a.exchangeCode,a.instrumentToken]],m:"tbt_full_snapquote"};case"OrderUpdate":return{a:e,v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"TradeUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"ExchangeMessage":return{a:e,v:[a.exchangeCode],m:"exchange_messages"};case"PositionUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"position_updates"};case"GreekData":return{a:"subscribe",v:[[a.exchangeCode,a.instrumentToken]],m:"greekdata"};default:return{}}}({messageType:n,payload:r,actionType:"subscribe"}),c=JSON.stringify(Object.assign(i,{a:"subscribe"})),u=JSON.stringify(Object.assign(i,{a:"unsubscribe"}));return{subscribe:function(t){return new Promise((function(r,o){e._topics[s]||(e._topics[s]={subscriptionObj:c,subscriptions:[]}),Boolean(e._topics[s].subscriptions.filter((function(t){return t.subscriptionLocation===a})).length)?o("".concat(n," already subscribed from ").concat(a)):(e._socket&&e._socket.readyState===WebSocket.OPEN?(e._topics[s].subscriptions.length&&e._socket.send(u),e._socket.send(c),r("subscribed")):o("socket not connect, ".concat(n," will be auto subscribed later")),e._topics[s].subscriptions.push({subscriptionLocation:a,callback:t}))}))},unsubscribe:function(){return new Promise((function(t,o){var i=(e._topics[s]||[]).subscriptions||[],c=i.filter((function(t){return t.subscriptionLocation!==a}));c.length===i.length?(function(t,e,n){for(var a,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];(a=console).log.apply(a,["Octopus"].concat(o))}(n,a,r),o("subscription does not exists")):(e._topics[s].subscriptions=c,t("unsubscribed"),0===c.length&&e._socket&&e._socket.send(u))}))}}},this.initSocket=function(t,e){this.isSocketOpen()&&this.closeSocket(!1),this.args.token=t,this.uri="wss://".concat(this.args.host).concat(this.args.path,"?login_id=").concat(this.args.loginId,"&token=").concat(this.args.token,"&device=web"),e&&Object.assign(this._topics,e),this.connect()}}function i(t,e){return["ltp","best_bid_price","best_ask_price","atp","open","high","low","close","yearly_high","yearly_low","lowDpr","highDpr","bidPrice","askPrice","change"].forEach((n=>{n in t&&(t[n]=t[n]/e)})),["bid_prices","ask_prices"].forEach((n=>{if(n in t){let a=[];for(let r in t[n])a.push(parseInt(r)/e);t[n]=a}})),t}function c(t){let e=parseInt(r[t]);return isNaN(e)?1:e}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={},_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72291),_sas__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42275),_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64844);function ticker(t,e,n,a,r,o){let s="sasObj",i=t=>{let e=[Object.values(t?.msg).map((t=>parseFloat(t+"")))];o.setResult(e)},c=(0,_sas__WEBPACK_IMPORTED_MODULE_0__.D7)(e),u=getTopicName(c,n,a);void 0===window[s]?window[s]=getOrInitialize(t,s,c,n,a,r,i):u=window[s].subscribe(c,n,a,r,i),o.onCanceled=()=>{window[s].unsubscribe(u)}}async function ImportJson(t,e,n,a,r="",o=""){var s=void 0;if(null==r||""==r)s=await GetArrayFromJson(t,e,n,a);else{s=[];for(var i=o.split(";"),c=0;c<i.length;c++)if(""!=i[c]){var u=await GetArrayFromJson(t+"&"+r+"="+i[c],e,n,a);u&&s.push(...u)}}return getEntities(s)}async function WebApiRequest(url,method,requestBody="",flattenArrayPath="",flattenObjPath="",authToken=void 0,confirmationMessage=""){var results=[],options={method:method};"post"!=method&&"put"!=method||""==requestBody||(options.body=requestBody,options.headers={Accept:"application/json, text/plain, *//*","Content-Type":"application/json"}),null!=authToken&&""!=authToken&&(options.headers=options.headers??{},options.headers.Authorization="Bearer "+authToken);let proceedForApiCall=!1;if(null==confirmationMessage||""==confirmationMessage||""!=confirmationMessage&&proceedForApiCall){var responseJson=await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(url,options);if(""!=flattenArrayPath&&flattenArrayPath.split(";").forEach((flattenArrayPathItem=>{var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.y)(eval("responseJson."+flattenArrayPathItem));temp.length>0&&results.push(...temp)})),""!=flattenObjPath){var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.Q)(eval("responseJson."+flattenObjPath));temp.length>0&&results.push(...temp)}}const entities=getEntities(results);return entities}function getEntities(t){if(t.length<=1)return[[_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.notAvailableError]];const e=t[0];return t.splice(1).map((t=>[makeEntity(e,t)]))}async function GetArrayFromJson(url,successField,successFieldValue,flattenArrayPath){var responseJson=await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(url),results=[],successFieldEval=eval("responseJson."+successField);if(successFieldEval==successFieldValue)return flattenArrayPath.split(";").forEach(((flattenArrayPathItem,i)=>{var tempPath="responseJson."+flattenArrayPathItem,tempResults=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.y)(eval(tempPath));i>0&&(tempResults=tempResults.slice(1,-1)),results.push(...tempResults)})),results}function getTopicName(t,e,n){return n.concat("/",t+"/"+e)}function getOrInitialize(t,e,n,a,r,o,s){if(void 0===window[e]){let i=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_id",t),c=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_token",t);window[e]=new _sas__WEBPACK_IMPORTED_MODULE_0__.vC({host:"alpha.sasonline.in",path:"/ws/v1/feeds",loginId:i});let u=window[e].getTopicObj(n,a,r,o,s);window[e].initSocket(c,u),window.addEventListener?window.addEventListener("beforeunload",(t=>window[e].windowOnBeforeUnload(t))):window.onbeforeunload=t=>window[e].windowOnBeforeUnload(t)}return window[e]}async function productSearch(t,e){try{null===e&&(e=!1),console.log(`Searching for ${t}...`);const n=await searchProduct(t,e);return 0==n.length?[[_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.notAvailableError]]:n.map((t=>[makeProductEntity(t)]))}catch(t){console.error(t)}}function makeEntity(t,e){if(e.length>0){const n={type:Excel.CellValueType.entity,text:""+e[0],properties:{}};return t.forEach(((t,a)=>{try{var r={type:getExcelTypeOf(e[a]),basicValue:e[a]};r.type==Excel.CellValueType.formattedNumber&&(r.numberFormat="$* #,##0.00"),n.properties[t]=r}catch(t){console.log(t)}})),n}}function getExcelTypeOf(t){return"number"==typeof t||"bigint"==typeof t?Excel.CellValueType.formattedNumber:"boolean"==typeof t?Excel.CellValueType.boolean:"string"==typeof t?Excel.CellValueType.string:void 0}function makeProductEntity(t){const e={type:"Entity",text:t.productName,properties:{"Product ID":{type:"String",basicValue:t.productID.toString()||""},"Product Name":{type:"String",basicValue:t.productName||""},"Quantity Per Unit":{type:"String",basicValue:t.quantityPerUnit||""},"Unit Price":{type:"FormattedNumber",basicValue:t.unitPrice,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:t.discontinued||!1}},layouts:{card:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}}};return t.productImage&&(e.properties.Image={type:"WebImage",address:t.productImage||""},e.layouts.card.mainImage={property:"Image"}),e}function searchProduct(t,e){const n=t.toUpperCase();return!0===e?products.filter((t=>t.productName.toUpperCase()===n)):products.filter((t=>t.productName.toUpperCase().indexOf(n)>=0))}const products=[{productID:1,productName:"Chai",supplierID:1,categoryID:1,quantityPerUnit:"10 boxes x 20 bags",unitPrice:18,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},{productID:2,productName:"Chang",supplierID:1,categoryID:1,quantityPerUnit:"24 - 12 oz bottles",unitPrice:19,discontinued:!1,productImage:""},{productID:3,productName:"Aniseed Syrup",supplierID:1,categoryID:2,quantityPerUnit:"12 - 550 ml bottles",unitPrice:10,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Maltose_syrup.jpg/185px-Maltose_syrup.jpg"},{productID:4,productName:"Chef Anton's Cajun Seasoning",supplierID:2,categoryID:2,quantityPerUnit:"48 - 6 oz jars",unitPrice:22,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Kruidenmengeling-spice.jpg/193px-Kruidenmengeling-spice.jpg"},{productID:5,productName:"Chef Anton's Gumbo Mix",supplierID:2,categoryID:2,quantityPerUnit:"36 boxes",unitPrice:21.35,discontinued:!0,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Okra_in_a_Bowl_%28Unsplash%29.jpg/180px-Okra_in_a_Bowl_%28Unsplash%29.jpg"},{productID:6,productName:"Grandma's Boysenberry Spread",supplierID:3,categoryID:2,quantityPerUnit:"12 - 8 oz jars",unitPrice:25,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Making_cranberry_sauce_-_in_the_jar.jpg/90px-Making_cranberry_sauce_-_in_the_jar.jpg"},{productID:7,productName:"Uncle Bob's Organic Dried Pears",supplierID:3,categoryID:7,quantityPerUnit:"12 - 1 lb pkgs.",unitPrice:30,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/DriedPears.JPG/120px-DriedPears.JPG"},{productID:8,productName:"Northwoods Cranberry Sauce",supplierID:3,categoryID:2,quantityPerUnit:"12 - 12 oz jars",unitPrice:40,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Making_cranberry_sauce_-_stovetop.jpg/90px-Making_cranberry_sauce_-_stovetop.jpg"},{productID:9,productName:"Mishi Kobe Niku",supplierID:4,categoryID:6,quantityPerUnit:"18 - 500 g pkgs.",unitPrice:97,discontinued:!0,productImage:""},{productID:10,productName:"Ikura",supplierID:4,categoryID:8,quantityPerUnit:"12 - 200 ml jars",unitPrice:31,discontinued:!1,productImage:""}],categories=[{categoryID:1,categoryName:"Beverages",description:"Soft drinks, coffees, teas, beers, and ales"},{categoryID:2,categoryName:"Condiments",description:"Sweet and savory sauces, relishes, spreads, and seasonings"},{categoryID:3,categoryName:"Confections",description:"Desserts, candies, and sweet breads"},{categoryID:4,categoryName:"Dairy Products",description:"Cheeses"},{categoryID:5,categoryName:"Grains/Cereals",description:"Breads, crackers, pasta, and cereal"},{categoryID:6,categoryName:"Meat/Poultry",description:"Prepared meats"},{categoryID:7,categoryName:"Produce",description:"Dried fruit and bean curd"},{categoryID:8,categoryName:"Seafood",description:"Seaweed and fish"}],suppliers=[{supplierID:1,companyName:"Exotic Liquids",contactName:"Charlotte Cooper",contactTitle:"Purchasing Manager"},{supplierID:2,companyName:"New Orleans Cajun Delights",contactName:"Shelley Burke",contactTitle:"Order Administrator"},{supplierID:3,companyName:"Grandma Kelly's Homestead",contactName:"Regina Murphy",contactTitle:"Sales Representative"},{supplierID:4,companyName:"Tokyo Traders",contactName:"Yoshi Nagase",contactTitle:"Marketing Manager",address:"9-8 Sekimai Musashino-shi"},{supplierID:5,companyName:"Cooperativa de Quesos 'Las Cabras'",contactName:"Antonio del Valle Saavedra",contactTitle:"Export Administrator"},{supplierID:6,companyName:"Mayumi's",contactName:"Mayumi Ohno",contactTitle:"Marketing Representative"},{supplierID:7,companyName:"Pavlova, Ltd.",contactName:"Ian Devling",contactTitle:"Marketing Manager"},{supplierID:8,companyName:"Specialty Biscuits, Ltd.",contactName:"Peter Wilson",contactTitle:"Sales Representative"}];CustomFunctions.associate("TICKER",ticker),CustomFunctions.associate("IMPORTJSON",ImportJson),CustomFunctions.associate("WEBAPIREQUEST",WebApiRequest),CustomFunctions.associate("PRODUCTSEARCH",productSearch)})();
//# sourceMappingURL=functions.js.map