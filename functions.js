(function(){"use strict";var __webpack_modules__={64844:function(e,t,n){n.d(t,{p:function(){return a}});class a{static notAvailableError={type:"Error",errorType:"NotAvailable"};static async fetch(e,t=void 0){try{const n=t?await fetch(e,t):await fetch(e);return await n.json()}catch(e){console.error(e.message)}}static getParameterByName(e,t=window.location.href){e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}},72291:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function Run(){}function onlyUnique(e,t,n){return n.indexOf(e)===t}function flattenJsonArray(data){var result=[];if(!Array.isArray(data)||0===data.length)return result;var headersToRemove=[];let setOfHeaders=new Set(data.flatMap((e=>{var t=Object.keys(e),n=[];return t.forEach((t=>{if(null!=e[t]&&null!=e[t]&&"object"==typeof e[t]&&!Array.isArray(e[t]))var a=Object.keys(e[t]);null!=a&&(headersToRemove.push(t),n.push(...a.flatMap((e=>[t+"."+e]))))})),t.push(...n),t})));var headers=[];setOfHeaders.forEach((e=>headers.push(e)));var uniqueHeadersToRemove=headersToRemove.filter(onlyUnique);return headers=headers.filter((e=>-1==uniqueHeadersToRemove.indexOf(e)&&!e.endsWith("?"))),result.push(headers),data.forEach((function(row){if(Array.isArray(row))result.push(row);else{var rowData=[];headers.forEach((function(header){var val=eval("row."+header);rowData.push(void 0===val?"":val)})),result.push(rowData)}})),result}function flattenJsonObj(obj){var result=[];if(Array.isArray(obj)||obj.length>0)return result;var headers=[...Object.keys(obj)];result.push(headers);var rowData=[];return headers.forEach((function(header){var objHeaderVal=eval("obj."+header);Array.isArray(objHeaderVal)&&objHeaderVal.length>0?rowData.push(void 0===objHeaderVal?"":objHeaderVal.join(", ")):rowData.push(void 0===objHeaderVal?"":objHeaderVal)})),result.push(rowData),result}function xlfNormSDist(e){if(e<0)return 1-xlfNormSDist(-e);var t=1/(1+.2316419*e);return 1-Math.exp(-e*e/2)/Math.sqrt(2*Math.PI)*t*(.31938153+t*(t*(1.781477937+t*(1.330274429*t-1.821255978))-.356563782))}function xlfNormalPDF1a(e,t,n){return Math.exp(-Math.pow(e-t,2)/(2*Math.pow(n,2)))/(n*Math.sqrt(2*Math.PI))}function xlfNormalPDF1b(e,t,n){return Math.exp(-.5*Math.pow((e-t)/n,2))/(n*Math.sqrt(2*Math.PI))}function xlfNormalSdistPDF(e){return Math.exp(-.5*e*e)/Math.sqrt(2*Math.PI)}function d1(e,t,n,a,r,s){return(Math.log(e/t)+(a-s+.5*r^2)*n)/(r*Math.sqrt(n))}function Nd1(e,t,n,a,r,s){return Math.exp(-(2^d1(e,t,n,a,r,s))/2)/Math.sqrt(2*Math.PI)}function d2(e,t,n,a,r,s){return d1(e,t,n,a,r,s)-r*Math.sqrt(n)}function Nd2(e,t,n,a,r,s){return xlfNormSDist(d2(e,t,n,a,r,s))}function CallPrice(e,t,n,a,r,s){return Math.exp(-s*n)*e*xlfNormSDist(d1(e,t,n,a,r,s))-t*Math.exp(-a*n)*xlfNormSDist(d1(e,t,n,a,r,s)-r*Math.sqrt(n))}function PutPrice(e,t,n,a,r,s){return t*Math.exp(-a*n)*xlfNormSDist(-d2(e,t,n,a,r,s))-Math.exp(-s*n)*e*xlfNormSDist(-d1(e,t,n,a,r,s))}function CallDelta(e,t,n,a,r,s){return xlfNormSDist(d1(e,t,n,a,r,s))}function PutDelta(e,t,n,a,r,s){return xlfNormSDist(d1(e,t,n,a,r,s))-1}function CallTheta(e,t,n,a,r,s){return-(e*r*Nd1(e,t,n,a,r,s)/(2*Math.sqrt(n))-a*t*Math.exp(-a*n)*Nd2(e,t,n,a,r,s))/365}function OptionGamma(e,t,n,a,r,s){return Nd1(e,t,n,a,r,s)/(e*(r*Math.sqrt(n)))}function OptionVega(e,t,n,a,r,s){return.01*e*Math.sqrt(n)*Nd1(e,t,n,a,r,s)}function PutTheta(e,t,n,a,r,s){return(-e*r*Nd1(e,t,n,a,r,s)/(2*Math.sqrt(n))+a*t*Math.exp(-a*n)*(1-Nd2(e,t,n,a,r,s)))/365}function CallRho(e,t,n,a,r,s){return.01*t*n*Math.exp(-a*n)*xlfNormSDist(d2(e,t,n,a,r,s))}function PutRho(e,t,n,a,r,s){return-.01*t*n*Math.exp(-a*n)*(1-xlfNormSDist(d2(e,t,n,a,r,s)))}function CallIV(e,t,n,a,r,s){let o=5,i=0;for(;o-i>1e-4;)CallPrice(e,t,n,a,(o+i)/2,s)>r?o=(o+i)/2:i=(o+i)/2;return(o+i)/2}function PutIV(e,t,n,a,r,s){let o=5,i=0;for(;o-i>1e-4;)PutPrice(e,t,n,a,(o+i)/2,s)>r?o=(o+i)/2:i=(o+i)/2;return(o+i)/2}__webpack_require__.d(__webpack_exports__,{Q:function(){return flattenJsonObj},y:function(){return flattenJsonArray}})},42275:function(e,t,n){n.d(t,{D7:function(){return c},vC:function(){return o}}),DataView.prototype.getString=function(e,t){for(var n="number"==typeof t?e+t:this.byteLength,a="",r=-1;e<this.byteLength&&e<n&&0!=(r=this.getUint8(e++));)a+=String.fromCharCode(r);return a},DataView.prototype.getInt64=function(e){var t=this.getUint32(e),n=this.getUint32(e+4),a=Math.pow(2,32)*t+n;return Number.isSafeInteger(a)?a:(console.warn(a,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),-1)};var a=DataView.prototype.getBigInt64;DataView.prototype.getBigInt64=function(e){return a.call(this,e).toString()};var r={NSE:1,NFO:2,CDS:3,MCX:4,BSE:6,BFO:7},s={1:100,2:100,3:1e7,4:100,6:100,7:100};function o(e){this.args=e,window.location.protocol,this.container=document.getElementById("divContainer"),this.uri="",this._socket=null,this._reconnectionTimeout=0,this._lastConnectedTimestamp=Date.now(),this._topics={},this.Gt=JSON.parse('{"DetailMarketDataMessage":{"mode":"marketdata","code":"1"},"CompactMarketDataMessage":{"mode":"compact_marketdata","code":"2"},"SnapquoteDataMessage":{"mode":"full_snapquote","code":"4"},"TbtSnapquoteDataMessage":{"mode":"tbt_full_snapquote","code":"14"},"SpreadMarketUpdate":{"mode":"spreaddata","code":"5"},"MktStatus":{"mode":"market_status","code":"9"},"ExchangeMessage":{"mode":"exchange_messages","code":"10"},"TbtUpdate":{"mode":"tbt_full_snapquote","code":"14"},"ClientAlerts":{"mode":"updates","code":"5002"},"AdminMessages":{"mode":"updates","code":"5002"},"OrderUpdate":{"mode":"updates","code":"5002"},"TradeUpdate":{"mode":"updates","code":"5002"},"PositionUpdate":{"mode":"updates","code":"5002"},"GreekData":{"mode":"greekdata","code":"15"}}'),this.shouldReopenSocket=!0,this.exchanges=[{name:"NSE",value:1},{name:"NFO",value:2},{name:"CDS",value:3},{name:"BSE",value:6}],this.instruments=[{name:"NIFTYBEES-EQ",value:10576,exchange:1},{name:"NIFTY 50",value:26e3,exchange:1},{name:"Nifty IT",value:26008,exchange:1},{name:"Nifty Bank",value:26009,exchange:1},{name:"Nifty Next 50",value:26013,exchange:1},{name:"Nifty Pharma",value:26023,exchange:1},{name:"Nifty PSU Bank",value:26025,exchange:1},{name:"NIFTY FIN SERVICE",value:26037,exchange:1},{name:"NIFTY MID SELECT",value:26074,exchange:1},{name:"SENSEX",value:1,exchange:6},{name:"BANKNIFTY24AUGFUT",value:35089,exchange:2},{name:"FINNIFTY24AUGFUT",value:35073,exchange:2},{name:"USDINR24AUGFUT",value:1237,exchange:3},{name:"MIDCPNIFTY24SEPFUT",value:38958,exchange:2},{name:"BANKNIFTY24AUG51200PE",value:48010,exchange:2}],this._sendHeartbeat=function(){var e=this;e.HearbeatIntervalID&&(clearInterval(e.HearbeatIntervalID),e.HearbeatIntervalID=void 0),e.HearbeatIntervalID=setInterval((function(){e._socket&&e._socket.readyState===WebSocket.OPEN&&e._socket.send('{"a":"h","v":[],"m":""}')}),9500)},this.subscribe=function(e,t,n,a,r){var s=this.getTopicObj(e,t,n,a,r),o=this.getTopicName(e,t,n);return this._topics[o]=s[o],this.isSocketOpen()&&this._socket.send(JSON.stringify(s[o].message)),o},this.getTopicName=function(e,t,n){return n.concat("/",e+"/"+t)},this.getTopicObj=function(e,t,n,a,r){var s=this.getMessageObj(e,t,n),o=this.getTopicName(e,t,n);return{[o]:{message:s,subscriptions:[{callback:r,subscriptionLocation:a}]}}},this.getMessageObj=function(e,t,n){const a="subscribe";switch(n){case"SpreadMarketUpdate":return{a:a,v:[[e,t]],m:"spreaddata"};case"DetailMarketDataMessage":return{a:a,v:[[e,t]],m:"marketdata"};case"CompactMarketDataMessage":return{a:a,v:[[e,t]],m:"compact_marketdata"};case"SnapquoteDataMessage":return{a:a,v:[[e,t]],m:"full_snapquote"};case"TbtSnapquoteDataMessage":return{a:a,v:[[e,t]],m:"tbt_full_snapquote"};case"OrderUpdate":case"TradeUpdate":return{a:a,v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"ExchangeMessage":return{a:a,v:[e],m:"exchange_messages"};case"PositionUpdate":return{a:a,v:[localStorage.getItem("login_id"),"web"],m:"position_updates"};case"GreekData":return{a:a,v:[[e,t]],m:"greekdata"};default:return{}}},this.unsubscribe=function(e){var t=this._topics[e].message;t&&""!=t&&(Object.assign(t,{a:"unsubscribe"}),t&&this.isSocketOpen()&&(this._socket.send(JSON.stringify(t)),delete this._topics[e]))},this.unsubscribeAll=function(){Object.keys(this._topics).forEach((e=>{this.unsubscribe(e)}))},this._sendHeartbeat.bind(this),this.windowOnBeforeUnload=function(){console.log("Unloading"),this.closeSocket(!1)},this.isSocketOpen=()=>this._socket&&this._socket.readyState===WebSocket.OPEN,this.closeSocket=function(e){return this.isSocketOpen()&&(this.shouldReopenSocket=e,this.unsubscribeAll(),this._socket.close(),this._socket=void 0,this.HearbeatIntervalID&&(clearInterval(this.HearbeatIntervalID),this.HearbeatIntervalID=void 0)),!0},this.writeToHtml=async function(e){e.msg&&(e.msg.timestamp=Date.now(),e.msg.topic=e?.topic,this.container&&e.msg&&await Excel.run((async t=>{let n=t.workbook.worksheets.getItem("Trades").tables.getItem("TradesTable"),a=n.getRange(),r=await async function(e,t,n){try{let a=n.find(t+"",{completeMatch:!0,matchCase:!1,searchDirection:Excel.SearchDirection.forward});return a=a.getOffsetRange(0,1),a.load(["address","rowIndex"]),await e.sync(),a}catch(e){console.error(e)}}(t,e.msg.instrumentToken,a.getColumn(2));if(null!=r){let a=n.rows.getItemAt(r.rowIndex-1).getRange().getOffsetRange(0,3).getResizedRange(0,-8);a.load(["address","rowCount","columnCount"]),await t.sync();let o=[];if(e.msg=i(e.msg,s[e.msg.exchange]),o.push(...Object.keys(e.msg)),o.length==a.columnCount){let e=[o];a.values=e}await t.sync()}})))},this.connect=function(){var e=this;return new Promise(((t,n)=>{e._socket=new WebSocket(e.uri),e._socket.binaryType="arraybuffer",e._socket.onopen=function(){e._reconnectionTimeout=0,Object.values(e._topics).forEach((function(t){t.message&&e._socket.send(JSON.stringify(t.message))})),e._sendHeartbeat()},e._socket.onmessage=function(t){var n=t.data;try{var a=function(e){var t=new DataView(e),n={};switch(t.getInt8(0)){case 15:return n=function(e){return{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),underlyingToken:e.getInt32(6),exchangeTimestamp:e.getInt32(10),delta:e.getBigInt64(14),gamma:e.getBigInt64(22),vega:e.getBigInt64(30),rho:e.getBigInt64(38),theta:e.getBigInt64(46),iv:e.getBigInt64(54),ltt:e.getInt32(62),ltq:e.getInt32(66),ltp:e.getInt32(70),currentOpenInterest:e.getInt32(74),initialOpenInterest:e.getInt32(78)}}(t)||{},{topic:"GreekData/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 1:return n=function(e){return{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),lastTradedPrice:e.getInt32(6),lastTradedTime:e.getInt32(10),lastTradedQuantity:e.getInt32(14),volume:e.getInt32(18),bestBidPrice:e.getInt32(22),bestBidQuantity:e.getInt32(26),bestAskPrice:e.getInt32(30),bestAskQuantity:e.getInt32(34),totalBuyQuantity:e.getInt64(38),totalSellQuantity:e.getInt64(46),averageTradePrice:e.getInt32(54),exchangeTimestamp:e.getInt32(58),openPrice:e.getInt32(62),highPrice:e.getInt32(66),lowPrice:e.getInt32(70),closePrice:e.getInt32(74),yearlyHighPrice:e.getInt32(78),yearlyLowPrice:e.getInt32(82),lowDPR:e.getInt32(86),HighDPR:e.getInt32(90),currentOpenInterest:e.getInt32(94),initialOpenInterest:e.getInt32(98)}}(t)||{},{topic:"DetailMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 2:return n=function(e){return 42===e.byteLength?{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),ltp:e.getInt32(6),change:e.getInt32(10),ltt:e.getInt32(14),lowDpr:e.getInt32(18),highDpr:e.getInt32(22),currentOpenInterest:e.getInt32(26),initialOpenInterest:e.getInt32(30),bidPrice:e.getInt32(34),askPrice:e.getInt32(38)}:46===e.byteLength?{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),ltp:e.getInt32(6),change:e.getInt32(10),ltt:e.getInt32(14),lowDpr:e.getInt32(18),highDpr:e.getInt32(22),currentOpenInterest:e.getInt32(26),initialOpenInterest:e.getInt32(30),bidPrice:e.getInt32(34),askPrice:e.getInt32(38),ltq:e.getInt32(42)}:{exchange:0,instrumentToken:0,ltp:0,change:0,ltt:0,lowDpr:0,highDpr:0,currentOpenInterest:0,initialOpenInterest:0,bidPrice:0,askPrice:0,ltq:0}}(t)||{},{topic:"CompactMarketDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 4:return n=function(e){return{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),buyers:[e.getInt32(6),e.getInt32(10),e.getInt32(14),e.getInt32(18),e.getInt32(22)],bidPrices:[e.getInt32(26),e.getInt32(30),e.getInt32(34),e.getInt32(38),e.getInt32(42)],bidQtys:[e.getInt32(46),e.getInt32(50),e.getInt32(54),e.getInt32(58),e.getInt32(62)],sellers:[e.getInt32(66),e.getInt32(70),e.getInt32(74),e.getInt32(78),e.getInt32(82)],askPrices:[e.getInt32(86),e.getInt32(90),e.getInt32(94),e.getInt32(98),e.getInt32(102)],askQtys:[e.getInt32(106),e.getInt32(110),e.getInt32(114),e.getInt32(118),e.getInt32(122)],averageTradePrice:e.getInt32(126),open:e.getInt32(130),high:e.getInt32(134),low:e.getInt32(138),close:e.getInt32(142),totalBuyQty:e.getInt64(146),totalSellQty:e.getInt64(154),volume:e.getInt32(162)}}(t)||{},{topic:"SnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken),msg:n};case 5:return n=function(e){return{exchange:e.getInt8(1),instrumentToken1:e.getInt32(2),instrumentToken2:e.getInt32(6),exchangeTimestamp:e.getInt32(10),totalBuyers:e.getInt32(14),totalSellers:e.getInt32(18),buyers:[e.getInt32(22),e.getInt32(26),e.getInt32(30),e.getInt32(34),e.getInt32(38)],bidPrices:[e.getInt32(42),e.getInt32(46),e.getInt32(50),e.getInt32(54),e.getInt32(58)],bidQtys:[e.getInt32(62),e.getInt32(66),e.getInt32(70),e.getInt32(74),e.getInt32(78)],sellers:[e.getInt32(82),e.getInt32(86),e.getInt32(90),e.getInt32(94),e.getInt32(98)],askPrices:[e.getInt32(102),e.getInt32(106),e.getInt32(110),e.getInt32(114),e.getInt32(118)],askQtys:[e.getInt32(122),e.getInt32(126),e.getInt32(130),e.getInt32(134),e.getInt32(138)],volume:e.getInt32(142),totalTradeValue:e.getInt64(146),totalBuyQty:e.getInt64(154),totalSellQty:e.getInt64(162),open:e.getInt32(170),high:e.getInt32(174),low:e.getInt32(178),ltp:e.getInt32(182),lastTradedPrice:e.getInt32(182),ltt:e.getInt32(186),lowDpr:e.getInt32(190),highDpr:e.getInt32(194),closePrice:e.getInt32(198),close:e.getInt32(198),averageTradePrice:206===e.byteLength?e.getInt32(202):0}}(t)||{},{topic:"SpreadMarketUpdate/".concat(n.exchange,"/").concat(n.instrumentToken1,"-").concat(n.instrumentToken2),msg:n};case 9:return n=function(e){var t=e.getInt8(1),n=e.getInt16(2),a=e.getString(4,n),r=4+n,s=e.getInt16(r),o=r+2,i=o+s;return{exchange:t,marketType:a,message:e.getString(o,s),timestamp:e.getInt32(i)}}(t)||{},{topic:"MktStatus/".concat(n.exchange),msg:n};case 10:return n=function(e){var t=e.getInt8(1),n=e.getInt16(2),a=4+n;return{exchange:t,message:e.getString(4,n),timestamp:e.getInt32(a)}}(t)||{},{topic:"ExchangeMessage/".concat(n.exchange),msg:n};case 11:case 50:return{topic:"OrderUpdate"};case 12:case 51:return{topic:"TradeUpdate"};case 14:return n=function(e){return{exchange:e.getInt8(1),instrumentToken:e.getInt32(2),lastTradePrice:e.getInt32(14),lastTradeQuantity:e.getInt32(18),totalTradeQuantity:e.getInt64(22),buyers:[e.getInt32(30),e.getInt32(34),e.getInt32(38),e.getInt32(42),e.getInt32(46),e.getInt32(50),e.getInt32(54),e.getInt32(58),e.getInt32(62),e.getInt32(66),e.getInt32(70),e.getInt32(74),e.getInt32(78),e.getInt32(82),e.getInt32(86),e.getInt32(90),e.getInt32(94),e.getInt32(98),e.getInt32(102),e.getInt32(106)],bidPrices:[e.getInt32(110),e.getInt32(114),e.getInt32(118),e.getInt32(122),e.getInt32(126),e.getInt32(130),e.getInt32(134),e.getInt32(138),e.getInt32(142),e.getInt32(146),e.getInt32(150),e.getInt32(154),e.getInt32(158),e.getInt32(162),e.getInt32(166),e.getInt32(170),e.getInt32(174),e.getInt32(178),e.getInt32(182),e.getInt32(186)],bidQtys:[e.getInt32(190),e.getInt32(194),e.getInt32(198),e.getInt32(202),e.getInt32(206),e.getInt32(210),e.getInt32(214),e.getInt32(218),e.getInt32(222),e.getInt32(226),e.getInt32(230),e.getInt32(234),e.getInt32(238),e.getInt32(242),e.getInt32(246),e.getInt32(250),e.getInt32(254),e.getInt32(258),e.getInt32(262),e.getInt32(266)],sellers:[e.getInt32(270),e.getInt32(274),e.getInt32(278),e.getInt32(282),e.getInt32(286),e.getInt32(290),e.getInt32(294),e.getInt32(298),e.getInt32(302),e.getInt32(306),e.getInt32(310),e.getInt32(314),e.getInt32(318),e.getInt32(322),e.getInt32(326),e.getInt32(330),e.getInt32(334),e.getInt32(338),e.getInt32(342),e.getInt32(346)],askPrices:[e.getInt32(350),e.getInt32(354),e.getInt32(358),e.getInt32(362),e.getInt32(366),e.getInt32(370),e.getInt32(374),e.getInt32(378),e.getInt32(382),e.getInt32(386),e.getInt32(390),e.getInt32(394),e.getInt32(398),e.getInt32(402),e.getInt32(406),e.getInt32(410),e.getInt32(414),e.getInt32(418),e.getInt32(422),e.getInt32(426)],askQtys:[e.getInt32(430),e.getInt32(434),e.getInt32(438),e.getInt32(442),e.getInt32(446),e.getInt32(450),e.getInt32(454),e.getInt32(458),e.getInt32(462),e.getInt32(466),e.getInt32(470),e.getInt32(474),e.getInt32(478),e.getInt32(482),e.getInt32(486),e.getInt32(490),e.getInt32(494),e.getInt32(498),e.getInt32(502),e.getInt32(506)],averageTradePrice:e.getInt32(510),open:e.getInt32(514),high:e.getInt32(518),low:e.getInt32(522),close:e.getInt32(526),totalBuyQty:e.getInt64(530),totalSellQty:e.getInt64(538),volume:e.getInt32(546)}}(t)||{},{topic:"TbtSnapquoteDataMessage/".concat(n.exchange,"/").concat(n.instrumentToken)};case 58:return{topic:"PositionUpdate"};default:return{}}}(n);a.msg=i(a.msg,s[a.msg.exchange]);let t=a.topic;((e._topics[t]||{}).subscriptions||[]).forEach((function(e){return(0,e.callback)(a)}))}catch(e){console.log(e)}},e._socket.onclose=function(){e.shouldReopenSocket&&setTimeout((function(){return e.connect()}),1e3)},e._socket.onerror=function(t){console.log("Socket encountered error: ".concat(t.message,", closing socket")),e.isSocketOpen()&&e._socket.close()}}))},this.wsHandler=function(e){var t=this,n=e.messageType,a=e.subscriptionLocation,r=e.payload,s=["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate","DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData","MktStatus","ExchangeMessage"],o=function(e){var t=e.messageType,n=e.payload,a=void 0===n?{}:n;if(!(t in s))throw"".concat(t," not supported");if(["ClientAlerts","OrderUpdate","TradeUpdate","AdminMessage","PositionUpdate"].includes(t))return"".concat(t);if(["DetailMarketDataMessage","CompactMarketDataMessage","SnapquoteDataMessage","TbtSnapquoteDataMessage","SpreadMarketUpdate","TbtUpdate","GreekData"].includes(t)){var r=a.exchangeCode,o=a.instrumentToken;if(!r||!o)throw"missing exchangeCode: ".concat(r," or instrumentToken: ").concat(o);return"".concat(t,"/").concat(r,"/").concat(o)}if(["MktStatus","ExchangeMessage"].includes(t)){var i=a.exchangeCode;if(!i)throw"missing exchangeCode: ".concat(i);return"".concat(t,"/").concat(i)}throw"invalid messageType: ".concat(t)}({messageType:n,payload:r}),i=function(e){var t=e.actionType,n=e.payload,a=void 0===n?{}:n;switch(e.messageType){case"SpreadMarketUpdate":return{a:t,v:[[a.exchangeCode,a.instrumentToken]],m:"spreaddata"};case"DetailMarketDataMessage":return{a:t,v:[[a.exchangeCode,a.instrumentToken]],m:"marketdata"};case"CompactMarketDataMessage":return{a:t,v:[[a.exchangeCode,a.instrumentToken]],m:"compact_marketdata"};case"SnapquoteDataMessage":return{a:t,v:[[a.exchangeCode,a.instrumentToken]],m:"full_snapquote"};case"TbtSnapquoteDataMessage":return{a:t,v:[[a.exchangeCode,a.instrumentToken]],m:"tbt_full_snapquote"};case"OrderUpdate":return{a:t,v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"TradeUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"updates"};case"ExchangeMessage":return{a:t,v:[a.exchangeCode],m:"exchange_messages"};case"PositionUpdate":return{a:"subscribe",v:[localStorage.getItem("login_id"),"web"],m:"position_updates"};case"GreekData":return{a:"subscribe",v:[[a.exchangeCode,a.instrumentToken]],m:"greekdata"};default:return{}}}({messageType:n,payload:r,actionType:"subscribe"}),c=JSON.stringify(Object.assign(i,{a:"subscribe"})),u=JSON.stringify(Object.assign(i,{a:"unsubscribe"}));return{subscribe:function(e){return new Promise((function(r,s){t._topics[o]||(t._topics[o]={subscriptionObj:c,subscriptions:[]}),Boolean(t._topics[o].subscriptions.filter((function(e){return e.subscriptionLocation===a})).length)?s("".concat(n," already subscribed from ").concat(a)):(t._socket&&t._socket.readyState===WebSocket.OPEN?(t._topics[o].subscriptions.length&&t._socket.send(u),t._socket.send(c),r("subscribed")):s("socket not connect, ".concat(n," will be auto subscribed later")),t._topics[o].subscriptions.push({subscriptionLocation:a,callback:e}))}))},unsubscribe:function(){return new Promise((function(e,s){var i=(t._topics[o]||[]).subscriptions||[],c=i.filter((function(e){return e.subscriptionLocation!==a}));c.length===i.length?(function(e,t,n){for(var a,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(a=console).log.apply(a,["Octopus"].concat(s))}(n,a,r),s("subscription does not exists")):(t._topics[o].subscriptions=c,e("unsubscribed"),0===c.length&&t._socket&&t._socket.send(u))}))}}},this.initSocket=function(e,t){this.isSocketOpen()&&this.closeSocket(!1),this.args.token=e,this.uri="wss://".concat(this.args.host).concat(this.args.path,"?login_id=").concat(this.args.loginId,"&token=").concat(this.args.token,"&device=web"),t&&Object.assign(this._topics,t),this.connect()}}function i(e,t){return["ltp","best_bid_price","best_ask_price","atp","open","high","low","close","yearly_high","yearly_low","lowDpr","highDpr","bidPrice","askPrice","change","lastTradedPrice","bestBidPrice","bestAskPrice","averageTradePrice","openPrice","highPrice","lowPrice","closePrice","yearlyHighPrice","yearlyLowPrice","lowDPR","HighDPR"].forEach((n=>{n in e&&(e[n]=e[n]/t)})),["bid_prices","ask_prices"].forEach((n=>{if(n in e){let a=[];for(let r in e[n])a.push(parseInt(r)/t);e[n]=a}})),e}function c(e){let t=parseInt(r[e]);return isNaN(t)?1:t}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var __webpack_exports__={},_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72291),_sas__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42275),_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64844);function ticker(e,t,n,a,r,s){let o="sasObj",i=e=>{let t=[Object.values(e?.msg).map((e=>parseFloat(e+"")))];s.setResult(t)},c=(0,_sas__WEBPACK_IMPORTED_MODULE_0__.D7)(t),u=getTopicName(c,n,a);void 0===window[o]?window[o]=getOrInitialize(e,o,c,n,a,r,i):u=window[o].subscribe(c,n,a,r,i),s.onCanceled=()=>{window[o].unsubscribe(u)}}async function ImportJson(e,t,n,a,r="",s=""){var o=void 0;if(null==r||""==r)o=await GetArrayFromJson(e,t,n,a);else{o=[];for(var i=s.split(";"),c=0;c<i.length;c++)if(""!=i[c]){var u=await GetArrayFromJson(e+"&"+r+"="+i[c],t,n,a);u&&o.push(...u)}}return getEntities(o)}async function WebApiRequest(url,method,requestBody="",flattenArrayPath="",flattenObjPath="",authToken=void 0,confirmationMessage=""){var results=[],options={method:method};"post"!=method&&"put"!=method||""==requestBody||(options.body=requestBody,options.headers={Accept:"application/json, text/plain, *//*","Content-Type":"application/json"}),null!=authToken&&""!=authToken&&(options.headers=options.headers??{},options.headers.Authorization="Bearer "+authToken);let proceedForApiCall=!1;if(null==confirmationMessage||""==confirmationMessage||""!=confirmationMessage&&proceedForApiCall){var responseJson=await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(url,options);if(null!=responseJson&&(""!=flattenArrayPath&&flattenArrayPath.split(";").forEach((flattenArrayPathItem=>{var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.y)(eval("responseJson."+flattenArrayPathItem));temp.length>0&&results.push(...temp)})),""!=flattenObjPath)){var temp=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.Q)(eval("responseJson."+flattenObjPath));temp.length>0&&results.push(...temp)}}const entities=getEntities(results);return entities}function getEntities(e){if(e.length<=1)return[[_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.notAvailableError]];const t=e[0];return e.splice(1).map((e=>[makeEntity(t,e)]))}async function GetArrayFromJson(url,successField,successFieldValue,flattenArrayPath){var responseJson=await _URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.fetch(url),results=[];if(null!=responseJson){var successFieldEval=eval("responseJson."+successField);successFieldEval==successFieldValue&&flattenArrayPath.split(";").forEach(((flattenArrayPathItem,i)=>{var tempPath="responseJson."+flattenArrayPathItem,tempResults=(0,_gdrive_functions__WEBPACK_IMPORTED_MODULE_2__.y)(eval(tempPath));i>0&&(tempResults=tempResults.slice(1,-1)),results.push(...tempResults)}))}return results}function getTopicName(e,t,n){return n.concat("/",e+"/"+t)}function getOrInitialize(e,t,n,a,r,s,o){if(void 0===window[t]){let i=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_id",e),c=_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.getParameterByName("login_token",e);window[t]=new _sas__WEBPACK_IMPORTED_MODULE_0__.vC({host:"alpha.sasonline.in",path:"/ws/v1/feeds",loginId:i});let u=window[t].getTopicObj(n,a,r,s,o);window[t].initSocket(c,u),window.addEventListener?window.addEventListener("beforeunload",(e=>window[t].windowOnBeforeUnload(e))):window.onbeforeunload=e=>window[t].windowOnBeforeUnload(e)}return window[t]}async function productSearch(e,t){try{null===t&&(t=!1),console.log(`Searching for ${e}...`);const n=await searchProduct(e,t);return 0==n.length?[[_URLFetchApp__WEBPACK_IMPORTED_MODULE_1__.p.notAvailableError]]:n.map((e=>[makeProductEntity(e)]))}catch(e){console.error(e)}}function makeEntity(e,t){if(t.length>0){const n={type:Excel.CellValueType.entity,text:""+t[0],properties:{}};return e.forEach(((e,a)=>{try{n.properties[e]=getExcelValueObj(t[a])}catch(e){console.log(e)}})),n}}function getExcelValueObj(e){let t={};return"number"==typeof e||"bigint"==typeof e?(t.type=Excel.CellValueType.formattedNumber,t.basicValue=e,t.numberFormat="$* #,##0.00"):"boolean"==typeof e?(t.type=Excel.CellValueType.boolean,t.basicValue=e):"string"==typeof e||Array.isArray(e)?(t.type=Excel.CellValueType.string,t.basicValue=Array.isArray(e)?e.join(", "):e):(t.type=Excel.CellValueType.string,t.basicValue=""+e),t}function makeProductEntity(e){const t={type:"Entity",text:e.productName,properties:{"Product ID":{type:"String",basicValue:e.productID.toString()||""},"Product Name":{type:"String",basicValue:e.productName||""},"Quantity Per Unit":{type:"String",basicValue:e.quantityPerUnit||""},"Unit Price":{type:"FormattedNumber",basicValue:e.unitPrice,numberFormat:"$* #,##0.00"},Discontinued:{type:"Boolean",basicValue:e.discontinued||!1}},layouts:{card:{title:{property:"Product Name"},sections:[{layout:"List",properties:["Product ID"]},{layout:"List",title:"Quantity and price",collapsible:!0,collapsed:!1,properties:["Quantity Per Unit","Unit Price"]},{layout:"List",title:"Additional information",collapsed:!0,properties:["Discontinued"]}]}}};return e.productImage&&(t.properties.Image={type:"WebImage",address:e.productImage||""},t.layouts.card.mainImage={property:"Image"}),t}function searchProduct(e,t){const n=e.toUpperCase();return!0===t?products.filter((e=>e.productName.toUpperCase()===n)):products.filter((e=>e.productName.toUpperCase().indexOf(n)>=0))}const products=[{productID:1,productName:"Chai",supplierID:1,categoryID:1,quantityPerUnit:"10 boxes x 20 bags",unitPrice:18,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-Masala_Chai.JPG"},{productID:2,productName:"Chang",supplierID:1,categoryID:1,quantityPerUnit:"24 - 12 oz bottles",unitPrice:19,discontinued:!1,productImage:""},{productID:3,productName:"Aniseed Syrup",supplierID:1,categoryID:2,quantityPerUnit:"12 - 550 ml bottles",unitPrice:10,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Maltose_syrup.jpg/185px-Maltose_syrup.jpg"},{productID:4,productName:"Chef Anton's Cajun Seasoning",supplierID:2,categoryID:2,quantityPerUnit:"48 - 6 oz jars",unitPrice:22,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Kruidenmengeling-spice.jpg/193px-Kruidenmengeling-spice.jpg"},{productID:5,productName:"Chef Anton's Gumbo Mix",supplierID:2,categoryID:2,quantityPerUnit:"36 boxes",unitPrice:21.35,discontinued:!0,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/Okra_in_a_Bowl_%28Unsplash%29.jpg/180px-Okra_in_a_Bowl_%28Unsplash%29.jpg"},{productID:6,productName:"Grandma's Boysenberry Spread",supplierID:3,categoryID:2,quantityPerUnit:"12 - 8 oz jars",unitPrice:25,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Making_cranberry_sauce_-_in_the_jar.jpg/90px-Making_cranberry_sauce_-_in_the_jar.jpg"},{productID:7,productName:"Uncle Bob's Organic Dried Pears",supplierID:3,categoryID:7,quantityPerUnit:"12 - 1 lb pkgs.",unitPrice:30,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/DriedPears.JPG/120px-DriedPears.JPG"},{productID:8,productName:"Northwoods Cranberry Sauce",supplierID:3,categoryID:2,quantityPerUnit:"12 - 12 oz jars",unitPrice:40,discontinued:!1,productImage:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/Making_cranberry_sauce_-_stovetop.jpg/90px-Making_cranberry_sauce_-_stovetop.jpg"},{productID:9,productName:"Mishi Kobe Niku",supplierID:4,categoryID:6,quantityPerUnit:"18 - 500 g pkgs.",unitPrice:97,discontinued:!0,productImage:""},{productID:10,productName:"Ikura",supplierID:4,categoryID:8,quantityPerUnit:"12 - 200 ml jars",unitPrice:31,discontinued:!1,productImage:""}],categories=[{categoryID:1,categoryName:"Beverages",description:"Soft drinks, coffees, teas, beers, and ales"},{categoryID:2,categoryName:"Condiments",description:"Sweet and savory sauces, relishes, spreads, and seasonings"},{categoryID:3,categoryName:"Confections",description:"Desserts, candies, and sweet breads"},{categoryID:4,categoryName:"Dairy Products",description:"Cheeses"},{categoryID:5,categoryName:"Grains/Cereals",description:"Breads, crackers, pasta, and cereal"},{categoryID:6,categoryName:"Meat/Poultry",description:"Prepared meats"},{categoryID:7,categoryName:"Produce",description:"Dried fruit and bean curd"},{categoryID:8,categoryName:"Seafood",description:"Seaweed and fish"}],suppliers=[{supplierID:1,companyName:"Exotic Liquids",contactName:"Charlotte Cooper",contactTitle:"Purchasing Manager"},{supplierID:2,companyName:"New Orleans Cajun Delights",contactName:"Shelley Burke",contactTitle:"Order Administrator"},{supplierID:3,companyName:"Grandma Kelly's Homestead",contactName:"Regina Murphy",contactTitle:"Sales Representative"},{supplierID:4,companyName:"Tokyo Traders",contactName:"Yoshi Nagase",contactTitle:"Marketing Manager",address:"9-8 Sekimai Musashino-shi"},{supplierID:5,companyName:"Cooperativa de Quesos 'Las Cabras'",contactName:"Antonio del Valle Saavedra",contactTitle:"Export Administrator"},{supplierID:6,companyName:"Mayumi's",contactName:"Mayumi Ohno",contactTitle:"Marketing Representative"},{supplierID:7,companyName:"Pavlova, Ltd.",contactName:"Ian Devling",contactTitle:"Marketing Manager"},{supplierID:8,companyName:"Specialty Biscuits, Ltd.",contactName:"Peter Wilson",contactTitle:"Sales Representative"}];CustomFunctions.associate("TICKER",ticker),CustomFunctions.associate("IMPORTJSON",ImportJson),CustomFunctions.associate("WEBAPIREQUEST",WebApiRequest),CustomFunctions.associate("PRODUCTSEARCH",productSearch)})();
//# sourceMappingURL=functions.js.map